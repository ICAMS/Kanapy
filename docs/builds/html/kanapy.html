

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="./">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Code documentation &mdash; kanapy 6.5.3.post1 documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=03e43079" />
      <link rel="stylesheet" type="text/css" href="_static/css/theme.css?v=e59714d7" />

  
      <script src="_static/jquery.js?v=5d32c60e"></script>
      <script src="_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="_static/documentation_options.js?v=53ab5b41"></script>
      <script src="_static/doctools.js?v=9bcbadda"></script>
      <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Contributing" href="contributing.html" />
    <link rel="prev" title="Modeling" href="method.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html" class="icon icon-home">
            kanapy
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="readme.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="applications.html">Applications</a></li>
<li class="toctree-l1"><a class="reference internal" href="usage.html">Usage</a></li>
<li class="toctree-l1"><a class="reference internal" href="method.html">Modeling</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Code documentation</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#module-kanapy.core.api">Module API</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#kanapy.core.api.Microstructure"><code class="docutils literal notranslate"><span class="pre">Microstructure</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#kanapy.core.api.Microstructure.generate_grains"><code class="docutils literal notranslate"><span class="pre">Microstructure.generate_grains()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#kanapy.core.api.Microstructure.generate_orientations"><code class="docutils literal notranslate"><span class="pre">Microstructure.generate_orientations()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#kanapy.core.api.Microstructure.import_particles"><code class="docutils literal notranslate"><span class="pre">Microstructure.import_particles()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#kanapy.core.api.Microstructure.init_RVE"><code class="docutils literal notranslate"><span class="pre">Microstructure.init_RVE()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#kanapy.core.api.Microstructure.init_stats"><code class="docutils literal notranslate"><span class="pre">Microstructure.init_stats()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#kanapy.core.api.Microstructure.output_abq"><code class="docutils literal notranslate"><span class="pre">Microstructure.output_abq()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#kanapy.core.api.Microstructure.output_ang"><code class="docutils literal notranslate"><span class="pre">Microstructure.output_ang()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#kanapy.core.api.Microstructure.output_neper"><code class="docutils literal notranslate"><span class="pre">Microstructure.output_neper()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#kanapy.core.api.Microstructure.pack"><code class="docutils literal notranslate"><span class="pre">Microstructure.pack()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#kanapy.core.api.Microstructure.pckl"><code class="docutils literal notranslate"><span class="pre">Microstructure.pckl()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#kanapy.core.api.Microstructure.plot_ellipsoids"><code class="docutils literal notranslate"><span class="pre">Microstructure.plot_ellipsoids()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#kanapy.core.api.Microstructure.plot_grains"><code class="docutils literal notranslate"><span class="pre">Microstructure.plot_grains()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#kanapy.core.api.Microstructure.plot_particles"><code class="docutils literal notranslate"><span class="pre">Microstructure.plot_particles()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#kanapy.core.api.Microstructure.plot_slice"><code class="docutils literal notranslate"><span class="pre">Microstructure.plot_slice()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#kanapy.core.api.Microstructure.plot_stats"><code class="docutils literal notranslate"><span class="pre">Microstructure.plot_stats()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#kanapy.core.api.Microstructure.plot_stats_init"><code class="docutils literal notranslate"><span class="pre">Microstructure.plot_stats_init()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#kanapy.core.api.Microstructure.plot_voxels"><code class="docutils literal notranslate"><span class="pre">Microstructure.plot_voxels()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#kanapy.core.api.Microstructure.smoothen"><code class="docutils literal notranslate"><span class="pre">Microstructure.smoothen()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#kanapy.core.api.Microstructure.voxelize"><code class="docutils literal notranslate"><span class="pre">Microstructure.voxelize()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#kanapy.core.api.Microstructure.write_abq"><code class="docutils literal notranslate"><span class="pre">Microstructure.write_abq()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#kanapy.core.api.Microstructure.write_abq_ori"><code class="docutils literal notranslate"><span class="pre">Microstructure.write_abq_ori()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#kanapy.core.api.Microstructure.write_centers"><code class="docutils literal notranslate"><span class="pre">Microstructure.write_centers()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#kanapy.core.api.Microstructure.write_dataSchema"><code class="docutils literal notranslate"><span class="pre">Microstructure.write_dataSchema()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#kanapy.core.api.Microstructure.write_ori"><code class="docutils literal notranslate"><span class="pre">Microstructure.write_ori()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#kanapy.core.api.Microstructure.write_stl"><code class="docutils literal notranslate"><span class="pre">Microstructure.write_stl()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#kanapy.core.api.Microstructure.write_voxels"><code class="docutils literal notranslate"><span class="pre">Microstructure.write_voxels()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-kanapy.core.gui">Module GUI</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#kanapy.core.gui.add_label_and_entry"><code class="docutils literal notranslate"><span class="pre">add_label_and_entry()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#kanapy.core.gui.cuboid_rve"><code class="docutils literal notranslate"><span class="pre">cuboid_rve</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#kanapy.core.gui.cuboid_rve.close"><code class="docutils literal notranslate"><span class="pre">cuboid_rve.close()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#kanapy.core.gui.cuboid_rve.create_cubes_and_plot"><code class="docutils literal notranslate"><span class="pre">cuboid_rve.create_cubes_and_plot()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#kanapy.core.gui.cuboid_rve.create_orientation"><code class="docutils literal notranslate"><span class="pre">cuboid_rve.create_orientation()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#kanapy.core.gui.cuboid_rve.display_cuboid"><code class="docutils literal notranslate"><span class="pre">cuboid_rve.display_cuboid()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#kanapy.core.gui.cuboid_rve.export_abq"><code class="docutils literal notranslate"><span class="pre">cuboid_rve.export_abq()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#kanapy.core.gui.cuboid_rve.update_euler_var"><code class="docutils literal notranslate"><span class="pre">cuboid_rve.update_euler_var()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#kanapy.core.gui.cuboid_rve.update_kernel_var"><code class="docutils literal notranslate"><span class="pre">cuboid_rve.update_kernel_var()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#kanapy.core.gui.parse_entry"><code class="docutils literal notranslate"><span class="pre">parse_entry()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#kanapy.core.gui.particle_rve"><code class="docutils literal notranslate"><span class="pre">particle_rve</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#kanapy.core.gui.particle_rve.close"><code class="docutils literal notranslate"><span class="pre">particle_rve.close()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#kanapy.core.gui.particle_rve.create_and_plot_rve"><code class="docutils literal notranslate"><span class="pre">particle_rve.create_and_plot_rve()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#kanapy.core.gui.particle_rve.create_and_plot_stats"><code class="docutils literal notranslate"><span class="pre">particle_rve.create_and_plot_stats()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#kanapy.core.gui.particle_rve.create_orientation"><code class="docutils literal notranslate"><span class="pre">particle_rve.create_orientation()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#kanapy.core.gui.particle_rve.display_plot"><code class="docutils literal notranslate"><span class="pre">particle_rve.display_plot()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#kanapy.core.gui.particle_rve.export_abq"><code class="docutils literal notranslate"><span class="pre">particle_rve.export_abq()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#kanapy.core.gui.particle_rve.extract_microstructure_params"><code class="docutils literal notranslate"><span class="pre">particle_rve.extract_microstructure_params()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#kanapy.core.gui.particle_rve.import_ebsd"><code class="docutils literal notranslate"><span class="pre">particle_rve.import_ebsd()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#kanapy.core.gui.particle_rve.import_stats"><code class="docutils literal notranslate"><span class="pre">particle_rve.import_stats()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#kanapy.core.gui.particle_rve.readout_stats"><code class="docutils literal notranslate"><span class="pre">particle_rve.readout_stats()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#kanapy.core.gui.particle_rve.reset_act"><code class="docutils literal notranslate"><span class="pre">particle_rve.reset_act()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#kanapy.core.gui.particle_rve.update_euler_var"><code class="docutils literal notranslate"><span class="pre">particle_rve.update_euler_var()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#kanapy.core.gui.particle_rve.update_kernel_var"><code class="docutils literal notranslate"><span class="pre">particle_rve.update_kernel_var()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#kanapy.core.gui.particle_rve.write_stat_param"><code class="docutils literal notranslate"><span class="pre">particle_rve.write_stat_param()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#kanapy.core.gui.self_closing_message"><code class="docutils literal notranslate"><span class="pre">self_closing_message()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-kanapy.core.cli">Module CLI</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#kanapy.core.cli.chkVersion"><code class="docutils literal notranslate"><span class="pre">chkVersion()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#kanapy.core.cli.setPaths"><code class="docutils literal notranslate"><span class="pre">setPaths()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#kanapy.core.cli.start"><code class="docutils literal notranslate"><span class="pre">start()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-kanapy.core.initializations">Module initialization</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#kanapy.core.initializations.NodeSets"><code class="docutils literal notranslate"><span class="pre">NodeSets</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#kanapy.core.initializations.NodeSets.CreatePeriodicEdgeSets"><code class="docutils literal notranslate"><span class="pre">NodeSets.CreatePeriodicEdgeSets()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#kanapy.core.initializations.NodeSets.CreatePeriodicNodeSets"><code class="docutils literal notranslate"><span class="pre">NodeSets.CreatePeriodicNodeSets()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#kanapy.core.initializations.NodeSets.RemoveItemInList"><code class="docutils literal notranslate"><span class="pre">NodeSets.RemoveItemInList()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#kanapy.core.initializations.RVE_creator"><code class="docutils literal notranslate"><span class="pre">RVE_creator</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#kanapy.core.initializations.mesh_creator"><code class="docutils literal notranslate"><span class="pre">mesh_creator</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#kanapy.core.initializations.mesh_creator.create_voxels"><code class="docutils literal notranslate"><span class="pre">mesh_creator.create_voxels()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#kanapy.core.initializations.mesh_creator.get_ind"><code class="docutils literal notranslate"><span class="pre">mesh_creator.get_ind()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#kanapy.core.initializations.set_stats"><code class="docutils literal notranslate"><span class="pre">set_stats()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#kanapy.core.initializations.stat_names"><code class="docutils literal notranslate"><span class="pre">stat_names()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-kanapy.core.input_output">Module input_output</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#kanapy.core.input_output.export2abaqus"><code class="docutils literal notranslate"><span class="pre">export2abaqus()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#kanapy.core.input_output.import_stats"><code class="docutils literal notranslate"><span class="pre">import_stats()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#kanapy.core.input_output.import_voxels"><code class="docutils literal notranslate"><span class="pre">import_voxels()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#kanapy.core.input_output.pickle2microstructure"><code class="docutils literal notranslate"><span class="pre">pickle2microstructure()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#kanapy.core.input_output.read_dump"><code class="docutils literal notranslate"><span class="pre">read_dump()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#kanapy.core.input_output.writeAbaqusMat"><code class="docutils literal notranslate"><span class="pre">writeAbaqusMat()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#kanapy.core.input_output.write_dump"><code class="docutils literal notranslate"><span class="pre">write_dump()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#kanapy.core.input_output.write_stats"><code class="docutils literal notranslate"><span class="pre">write_stats()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-kanapy.core.packing">Module packing</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#kanapy.core.packing.calculateForce"><code class="docutils literal notranslate"><span class="pre">calculateForce()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#kanapy.core.packing.packingRoutine"><code class="docutils literal notranslate"><span class="pre">packingRoutine()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#kanapy.core.packing.particle_generator"><code class="docutils literal notranslate"><span class="pre">particle_generator()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#kanapy.core.packing.particle_grow"><code class="docutils literal notranslate"><span class="pre">particle_grow()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-kanapy.core.entities">Module entities</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#kanapy.core.entities.Cuboid"><code class="docutils literal notranslate"><span class="pre">Cuboid</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#kanapy.core.entities.Cuboid.intersect"><code class="docutils literal notranslate"><span class="pre">Cuboid.intersect()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#kanapy.core.entities.Ellipsoid"><code class="docutils literal notranslate"><span class="pre">Ellipsoid</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#kanapy.core.entities.Ellipsoid.Bbox"><code class="docutils literal notranslate"><span class="pre">Ellipsoid.Bbox()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#kanapy.core.entities.Ellipsoid.create_poly"><code class="docutils literal notranslate"><span class="pre">Ellipsoid.create_poly()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#kanapy.core.entities.Ellipsoid.get_coeffs"><code class="docutils literal notranslate"><span class="pre">Ellipsoid.get_coeffs()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#kanapy.core.entities.Ellipsoid.get_cub"><code class="docutils literal notranslate"><span class="pre">Ellipsoid.get_cub()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#kanapy.core.entities.Ellipsoid.get_pos"><code class="docutils literal notranslate"><span class="pre">Ellipsoid.get_pos()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#kanapy.core.entities.Ellipsoid.get_volume"><code class="docutils literal notranslate"><span class="pre">Ellipsoid.get_volume()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#kanapy.core.entities.Ellipsoid.gravity_effect"><code class="docutils literal notranslate"><span class="pre">Ellipsoid.gravity_effect()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#kanapy.core.entities.Ellipsoid.growth"><code class="docutils literal notranslate"><span class="pre">Ellipsoid.growth()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#kanapy.core.entities.Ellipsoid.move"><code class="docutils literal notranslate"><span class="pre">Ellipsoid.move()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#kanapy.core.entities.Ellipsoid.rotationMatrixGen"><code class="docutils literal notranslate"><span class="pre">Ellipsoid.rotationMatrixGen()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#kanapy.core.entities.Ellipsoid.set_cub"><code class="docutils literal notranslate"><span class="pre">Ellipsoid.set_cub()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#kanapy.core.entities.Ellipsoid.surfacePointsGen"><code class="docutils literal notranslate"><span class="pre">Ellipsoid.surfacePointsGen()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#kanapy.core.entities.Ellipsoid.sync_poly"><code class="docutils literal notranslate"><span class="pre">Ellipsoid.sync_poly()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#kanapy.core.entities.Ellipsoid.wallCollision"><code class="docutils literal notranslate"><span class="pre">Ellipsoid.wallCollision()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#kanapy.core.entities.Octree"><code class="docutils literal notranslate"><span class="pre">Octree</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#kanapy.core.entities.Octree.add_particle"><code class="docutils literal notranslate"><span class="pre">Octree.add_particle()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#kanapy.core.entities.Octree.collisionsTest"><code class="docutils literal notranslate"><span class="pre">Octree.collisionsTest()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#kanapy.core.entities.Octree.get_cub"><code class="docutils literal notranslate"><span class="pre">Octree.get_cub()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#kanapy.core.entities.Octree.make_neighborlist"><code class="docutils literal notranslate"><span class="pre">Octree.make_neighborlist()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#kanapy.core.entities.Octree.subdivide"><code class="docutils literal notranslate"><span class="pre">Octree.subdivide()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#kanapy.core.entities.Octree.subdivide_particles"><code class="docutils literal notranslate"><span class="pre">Octree.subdivide_particles()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#kanapy.core.entities.Octree.update"><code class="docutils literal notranslate"><span class="pre">Octree.update()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#kanapy.core.entities.Simulation_Box"><code class="docutils literal notranslate"><span class="pre">Simulation_Box</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#kanapy.core.entities.cub_oct_split"><code class="docutils literal notranslate"><span class="pre">cub_oct_split()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-kanapy.core.collisions">Module collisions</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#kanapy.core.collisions.collide_detect"><code class="docutils literal notranslate"><span class="pre">collide_detect()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#kanapy.core.collisions.collision_react"><code class="docutils literal notranslate"><span class="pre">collision_react()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#kanapy.core.collisions.collision_routine"><code class="docutils literal notranslate"><span class="pre">collision_routine()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-kanapy.core.voxelization">Module voxelization</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#kanapy.core.voxelization.assign_voxels_to_ellipsoid"><code class="docutils literal notranslate"><span class="pre">assign_voxels_to_ellipsoid()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#kanapy.core.voxelization.points_in_convexHull"><code class="docutils literal notranslate"><span class="pre">points_in_convexHull()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#kanapy.core.voxelization.reassign_shared_voxels"><code class="docutils literal notranslate"><span class="pre">reassign_shared_voxels()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#kanapy.core.voxelization.voxelizationRoutine"><code class="docutils literal notranslate"><span class="pre">voxelizationRoutine()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-kanapy.core.grains">Module grains</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#kanapy.core.grains.calc_polygons"><code class="docutils literal notranslate"><span class="pre">calc_polygons()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-kanapy.core.rve_stats">Module rve_stats</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#kanapy.core.rve_stats.arr2mat"><code class="docutils literal notranslate"><span class="pre">arr2mat()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#kanapy.core.rve_stats.bbox"><code class="docutils literal notranslate"><span class="pre">bbox()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#kanapy.core.rve_stats.calc_stats_dict"><code class="docutils literal notranslate"><span class="pre">calc_stats_dict()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#kanapy.core.rve_stats.con_fun"><code class="docutils literal notranslate"><span class="pre">con_fun()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#kanapy.core.rve_stats.find_rot_axis"><code class="docutils literal notranslate"><span class="pre">find_rot_axis()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#kanapy.core.rve_stats.get_diameter"><code class="docutils literal notranslate"><span class="pre">get_diameter()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#kanapy.core.rve_stats.get_grain_geom"><code class="docutils literal notranslate"><span class="pre">get_grain_geom()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#kanapy.core.rve_stats.get_ln_param"><code class="docutils literal notranslate"><span class="pre">get_ln_param()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#kanapy.core.rve_stats.get_stats_part"><code class="docutils literal notranslate"><span class="pre">get_stats_part()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#kanapy.core.rve_stats.get_stats_poly"><code class="docutils literal notranslate"><span class="pre">get_stats_poly()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#kanapy.core.rve_stats.get_stats_vox"><code class="docutils literal notranslate"><span class="pre">get_stats_vox()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#kanapy.core.rve_stats.project_pts"><code class="docutils literal notranslate"><span class="pre">project_pts()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#kanapy.core.rve_stats.pts_in_ellips"><code class="docutils literal notranslate"><span class="pre">pts_in_ellips()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-kanapy.texture">Module texture</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#kanapy.texture.DeLaValleePoussinKernel"><code class="docutils literal notranslate"><span class="pre">DeLaValleePoussinKernel</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#kanapy.texture.DeLaValleePoussinKernel.DK"><code class="docutils literal notranslate"><span class="pre">DeLaValleePoussinKernel.DK()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#kanapy.texture.DeLaValleePoussinKernel.DRK"><code class="docutils literal notranslate"><span class="pre">DeLaValleePoussinKernel.DRK()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#kanapy.texture.DeLaValleePoussinKernel.K"><code class="docutils literal notranslate"><span class="pre">DeLaValleePoussinKernel.K()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#kanapy.texture.DeLaValleePoussinKernel.RK"><code class="docutils literal notranslate"><span class="pre">DeLaValleePoussinKernel.RK()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#kanapy.texture.DeLaValleePoussinKernel.halfwidth"><code class="docutils literal notranslate"><span class="pre">DeLaValleePoussinKernel.halfwidth()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#kanapy.texture.EBSDmap"><code class="docutils literal notranslate"><span class="pre">EBSDmap</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#kanapy.texture.EBSDmap.calcORI"><code class="docutils literal notranslate"><span class="pre">EBSDmap.calcORI()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#kanapy.texture.EBSDmap.plot_ci_map"><code class="docutils literal notranslate"><span class="pre">EBSDmap.plot_ci_map()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#kanapy.texture.EBSDmap.plot_felsenszwalb"><code class="docutils literal notranslate"><span class="pre">EBSDmap.plot_felsenszwalb()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#kanapy.texture.EBSDmap.plot_grains"><code class="docutils literal notranslate"><span class="pre">EBSDmap.plot_grains()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#kanapy.texture.EBSDmap.plot_grains_marked"><code class="docutils literal notranslate"><span class="pre">EBSDmap.plot_grains_marked()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#kanapy.texture.EBSDmap.plot_graph"><code class="docutils literal notranslate"><span class="pre">EBSDmap.plot_graph()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#kanapy.texture.EBSDmap.plot_ipf_map"><code class="docutils literal notranslate"><span class="pre">EBSDmap.plot_ipf_map()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#kanapy.texture.EBSDmap.plot_mo_map"><code class="docutils literal notranslate"><span class="pre">EBSDmap.plot_mo_map()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#kanapy.texture.EBSDmap.plot_pf"><code class="docutils literal notranslate"><span class="pre">EBSDmap.plot_pf()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#kanapy.texture.EBSDmap.plot_pf_proj"><code class="docutils literal notranslate"><span class="pre">EBSDmap.plot_pf_proj()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#kanapy.texture.EBSDmap.plot_segmentation"><code class="docutils literal notranslate"><span class="pre">EBSDmap.plot_segmentation()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#kanapy.texture.EBSDmap.showIPF"><code class="docutils literal notranslate"><span class="pre">EBSDmap.showIPF()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#kanapy.texture.Kernel"><code class="docutils literal notranslate"><span class="pre">Kernel</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#kanapy.texture.Kernel.K"><code class="docutils literal notranslate"><span class="pre">Kernel.K()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#kanapy.texture.Kernel.K_orientations"><code class="docutils literal notranslate"><span class="pre">Kernel.K_orientations()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#kanapy.texture.Kernel.RK"><code class="docutils literal notranslate"><span class="pre">Kernel.RK()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#kanapy.texture.Kernel.RRK"><code class="docutils literal notranslate"><span class="pre">Kernel.RRK()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#kanapy.texture.Kernel.bandwidth"><code class="docutils literal notranslate"><span class="pre">Kernel.bandwidth</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#kanapy.texture.Kernel.calc_fourier"><code class="docutils literal notranslate"><span class="pre">Kernel.calc_fourier()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#kanapy.texture.Kernel.cutA"><code class="docutils literal notranslate"><span class="pre">Kernel.cutA()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#kanapy.texture.Kernel.halfwidth"><code class="docutils literal notranslate"><span class="pre">Kernel.halfwidth()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#kanapy.texture.Kernel.norm"><code class="docutils literal notranslate"><span class="pre">Kernel.norm()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#kanapy.texture.Kernel.plot_K"><code class="docutils literal notranslate"><span class="pre">Kernel.plot_K()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#kanapy.texture.ODF"><code class="docutils literal notranslate"><span class="pre">ODF</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#kanapy.texture.ODF.evaluate"><code class="docutils literal notranslate"><span class="pre">ODF.evaluate()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#kanapy.texture.build_graph_from_labeled_pixels"><code class="docutils literal notranslate"><span class="pre">build_graph_from_labeled_pixels()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#kanapy.texture.calc_error"><code class="docutils literal notranslate"><span class="pre">calc_error()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#kanapy.texture.calc_orientations"><code class="docutils literal notranslate"><span class="pre">calc_orientations()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#kanapy.texture.createOriset"><code class="docutils literal notranslate"><span class="pre">createOriset()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#kanapy.texture.createOrisetRandom"><code class="docutils literal notranslate"><span class="pre">createOrisetRandom()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#kanapy.texture.export_graph"><code class="docutils literal notranslate"><span class="pre">export_graph()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#kanapy.texture.find_largest_neighbor"><code class="docutils literal notranslate"><span class="pre">find_largest_neighbor()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#kanapy.texture.find_orientations_fast"><code class="docutils literal notranslate"><span class="pre">find_orientations_fast()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#kanapy.texture.find_sim_neighbor"><code class="docutils literal notranslate"><span class="pre">find_sim_neighbor()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#kanapy.texture.find_similar_regions"><code class="docutils literal notranslate"><span class="pre">find_similar_regions()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#kanapy.texture.get_distinct_colormap"><code class="docutils literal notranslate"><span class="pre">get_distinct_colormap()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#kanapy.texture.get_ipf_colors"><code class="docutils literal notranslate"><span class="pre">get_ipf_colors()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#kanapy.texture.merge_nodes"><code class="docutils literal notranslate"><span class="pre">merge_nodes()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#kanapy.texture.neighbors"><code class="docutils literal notranslate"><span class="pre">neighbors()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#kanapy.texture.odf_est"><code class="docutils literal notranslate"><span class="pre">odf_est()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#kanapy.texture.plot_pole_figure"><code class="docutils literal notranslate"><span class="pre">plot_pole_figure()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#kanapy.texture.plot_pole_figure_proj"><code class="docutils literal notranslate"><span class="pre">plot_pole_figure_proj()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#kanapy.texture.summarize_labels"><code class="docutils literal notranslate"><span class="pre">summarize_labels()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#kanapy.texture.texture_reconstruction"><code class="docutils literal notranslate"><span class="pre">texture_reconstruction()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#kanapy.texture.visualize_graph"><code class="docutils literal notranslate"><span class="pre">visualize_graph()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-kanapy.core.plotting">Module plotting</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#kanapy.core.plotting.plot_ellipsoids_3D"><code class="docutils literal notranslate"><span class="pre">plot_ellipsoids_3D()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#kanapy.core.plotting.plot_init_stats"><code class="docutils literal notranslate"><span class="pre">plot_init_stats()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#kanapy.core.plotting.plot_output_stats"><code class="docutils literal notranslate"><span class="pre">plot_output_stats()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#kanapy.core.plotting.plot_particles_3D"><code class="docutils literal notranslate"><span class="pre">plot_particles_3D()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#kanapy.core.plotting.plot_polygons_3D"><code class="docutils literal notranslate"><span class="pre">plot_polygons_3D()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#kanapy.core.plotting.plot_stats_dict"><code class="docutils literal notranslate"><span class="pre">plot_stats_dict()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#kanapy.core.plotting.plot_voxels_3D"><code class="docutils literal notranslate"><span class="pre">plot_voxels_3D()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-kanapy.core.smoothingGB">Module smoothing</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#kanapy.core.smoothingGB.Node"><code class="docutils literal notranslate"><span class="pre">Node</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#kanapy.core.smoothingGB.Node.compute_acc"><code class="docutils literal notranslate"><span class="pre">Node.compute_acc()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#kanapy.core.smoothingGB.Node.get_Oripos"><code class="docutils literal notranslate"><span class="pre">Node.get_Oripos()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#kanapy.core.smoothingGB.Node.get_pos"><code class="docutils literal notranslate"><span class="pre">Node.get_pos()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#kanapy.core.smoothingGB.Node.get_vel"><code class="docutils literal notranslate"><span class="pre">Node.get_vel()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#kanapy.core.smoothingGB.Node.update_pos"><code class="docutils literal notranslate"><span class="pre">Node.update_pos()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#kanapy.core.smoothingGB.Node.update_vel"><code class="docutils literal notranslate"><span class="pre">Node.update_vel()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#kanapy.core.smoothingGB.initalizeSystem"><code class="docutils literal notranslate"><span class="pre">initalizeSystem()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#kanapy.core.smoothingGB.readGrainFaces"><code class="docutils literal notranslate"><span class="pre">readGrainFaces()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#kanapy.core.smoothingGB.relaxSystem"><code class="docutils literal notranslate"><span class="pre">relaxSystem()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#kanapy.core.smoothingGB.smoothingRoutine"><code class="docutils literal notranslate"><span class="pre">smoothingRoutine()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="contributing.html">Contributing</a></li>
<li class="toctree-l1"><a class="reference internal" href="authors.html">Authors</a></li>
<li class="toctree-l1"><a class="reference internal" href="history.html">History</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">kanapy</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Code documentation</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/kanapy.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="code-documentation">
<h1>Code documentation<a class="headerlink" href="#code-documentation" title="Link to this heading"></a></h1>
<section id="module-kanapy.core.api">
<span id="module-api"></span><h2>Module API<a class="headerlink" href="#module-kanapy.core.api" title="Link to this heading"></a></h2>
<p>Module defining class Microstructure that contains the necessary
methods and attributes to analyze experimental microstructures in form
of EBSD maps to generate statistical descriptors for 3D microstructures, and 
to create synthetic RVE that fulfill the required statistical microstructure
descriptors.</p>
<p>The methods of the class Microstructure for an API that can be used to generate
Python workflows.</p>
<p>Authors: Alexander Hartmaier, Golsa Tolooei Eshlghi, Abhishek Biswas
Institution: ICAMS, Ruhr University Bochum</p>
<dl class="py class">
<dt class="sig sig-object py" id="kanapy.core.api.Microstructure">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">kanapy.core.api.</span></span><span class="sig-name descname"><span class="pre">Microstructure</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">descriptor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">file</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'Microstructure'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/kanapy/core/api.html#Microstructure"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kanapy.core.api.Microstructure" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Define a class for creating and managing synthetic microstructures</p>
<p>This class provides tools to define, generate, and analyze synthetic
microstructures composed of one or multiple phases. It integrates particle
packing, voxelization, and grain geometry generation for RVE (Representative
Volume Element) modeling.</p>
<section id="parameters">
<h3>Parameters<a class="headerlink" href="#parameters" title="Link to this heading"></a></h3>
<dl class="simple">
<dt>descriptor<span class="classifier">list of dict, optional</span></dt><dd><p>List of dictionaries describing the microstructure of each phase.
Dictionary keys typically include “Grains type”, “Equivalent diameter”,
“Aspect ratio”, “Tilt Angle”, “RVE”, and “Simulation”.</p>
</dd>
<dt>file<span class="classifier">str, optional</span></dt><dd><p>Path to a JSON or other input file to initialize the microstructure.</p>
</dd>
<dt>name<span class="classifier">str, default=’Microstructure’</span></dt><dd><p>Name of the microstructure</p>
</dd>
</dl>
</section>
<section id="attributes">
<h3>Attributes<a class="headerlink" href="#attributes" title="Link to this heading"></a></h3>
<dl class="simple">
<dt>name<span class="classifier">str</span></dt><dd><p>Name of the microstructure</p>
</dd>
<dt>nphases<span class="classifier">int or None</span></dt><dd><p>Number of phases in the microstructure</p>
</dd>
<dt>ngrains<span class="classifier">ndarray or None</span></dt><dd><p>Array of grain counts in each phase</p>
</dd>
<dt>nparticles<span class="classifier">list or None</span></dt><dd><p>List of the number of particles in each phase</p>
</dd>
<dt>descriptor<span class="classifier">list of dict or None</span></dt><dd><p>Descriptor used to define microstructure if provided</p>
</dd>
<dt>precipit<span class="classifier">float or None</span></dt><dd><p>Indicates the presence of precipitates, pores, or secondary particles
in a continuous matrix. If float, specifies their volume fraction</p>
</dd>
<dt>from_voxels<span class="classifier">bool</span></dt><dd><p>True if the microstructure is imported from a voxel file</p>
</dd>
<dt>particles<span class="classifier">list or None</span></dt><dd><p>List of particle objects containing geometric information</p>
</dd>
<dt>rve<span class="classifier">RVE_creator or None</span></dt><dd><p>Object containing RVE information including mesh dimensions,
particle count, periodicity, and phase volume fractions</p>
</dd>
<dt>simbox<span class="classifier">Simulation_Box or None</span></dt><dd><p>Object defining the geometric boundaries of the RVE simulation domain</p>
</dd>
<dt>mesh<span class="classifier">mesh_creator or None</span></dt><dd><p>Object storing voxelized mesh data including grain assignments,
voxel connectivity, and smoothed node coordinates</p>
</dd>
<dt>geometry<span class="classifier">dict or None</span></dt><dd><p>Dictionary of grain geometries. Keys may include “Vertices”, “Points”,
“Simplices”, “Facets”, “Grains”, “GBnodes”, “GBarea”, “GBfaces”</p>
</dd>
<dt>rve_stats<span class="classifier">list of dict or None</span></dt><dd><p>Statistical information for different RVE representations,
including particles, voxels, and polyhedral grains</p>
</dd>
<dt>rve_stats_labels<span class="classifier">list of str or None</span></dt><dd><p>Labels corresponding to the types of RVEs analyzed, e.g., “Particles”,
“Voxels”, “Grains”</p>
</dd>
<dt>vf_vox<span class="classifier">ndarray or None</span></dt><dd><p>Phase volume fractions obtained from voxelized structures</p>
</dd>
<dt>ialloy<span class="classifier">int or None</span></dt><dd><p>Alloy identifier used for material library mapping</p>
</dd>
</dl>
</section>
<section id="notes">
<h3>Notes<a class="headerlink" href="#notes" title="Link to this heading"></a></h3>
<ul class="simple">
<li><p>The class can initialize from either a statistical descriptor or a JSON data file</p></li>
<li><p>When only one phase is specified with a volume fraction &lt; 1.0,
a matrix phase is automatically added with a complementary fraction (1 - vf)</p></li>
<li><p>Kanapy is tested for up to two phases; using more may yield unpredictable results</p></li>
</ul>
<dl class="py method">
<dt class="sig sig-object py" id="kanapy.core.api.Microstructure.generate_grains">
<span class="sig-name descname"><span class="pre">generate_grains</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/kanapy/core/api.html#Microstructure.generate_grains"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kanapy.core.api.Microstructure.generate_grains" title="Link to this definition"></a></dt>
<dd><p>Calculate and store polyhedral grain geometry, including particle- and grain-diameter attributes,
for statistical comparison</p>
<section id="id1">
<h4>Notes<a class="headerlink" href="#id1" title="Link to this heading"></a></h4>
<ul class="simple">
<li><p>Requires <cite>self.mesh</cite> to be initialized by <cite>voxelize</cite>.</p></li>
<li><p>Updates <cite>self.geometry</cite> with polyhedral grain volumes and shared grain boundary (GB) areas.</p></li>
<li><p>If <cite>self.precipit</cite> is True, irregular grain 0 is temporarily removed from analysis.</p></li>
<li><p>Logs warnings if grains are not represented in the polyhedral geometry.</p></li>
<li><p>Prints volume fractions of each phase in the polyhedral geometry.</p></li>
</ul>
</section>
<section id="id2">
<h4>Parameters<a class="headerlink" href="#id2" title="Link to this heading"></a></h4>
<p>None</p>
</section>
<section id="returns">
<h4>Returns<a class="headerlink" href="#returns" title="Link to this heading"></a></h4>
<dl class="simple">
<dt>None</dt><dd><p>The calculated grain geometry is stored in <cite>self.geometry</cite>. Phase volume fractions
are printed to the console.</p>
</dd>
</dl>
</section>
<section id="raises">
<h4>Raises<a class="headerlink" href="#raises" title="Link to this heading"></a></h4>
<dl class="simple">
<dt>ValueError</dt><dd><ul class="simple">
<li><p>If <cite>self.mesh</cite> or <cite>self.mesh.grains</cite> is None (i.e., voxelized microstructure not available).</p></li>
</ul>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="kanapy.core.api.Microstructure.generate_orientations">
<span class="sig-name descname"><span class="pre">generate_orientations</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ang</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">omega</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Nbase</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hist</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shared_area</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">iphase</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/kanapy/core/api.html#Microstructure.generate_orientations"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kanapy.core.api.Microstructure.generate_orientations" title="Link to this definition"></a></dt>
<dd><p>Generate orientations for grains in a representative volume element (RVE)
to achieve a desired crystallographic texture</p>
<p>This method assigns grain orientations to achieve a specified texture. The
input can be an EBSDmap object or a string defining the type of orientation set
(random or unimodal). For unimodal textures, <cite>ang</cite> and <cite>omega</cite> must be specified.
Generated orientations are stored in <cite>self.mesh.grain_ori_dict</cite>, and
<cite>self.mesh.texture</cite> is updated accordingly.</p>
<section id="id3">
<h4>Parameters<a class="headerlink" href="#id3" title="Link to this heading"></a></h4>
<dl class="simple">
<dt>data<span class="classifier">EBSDmap or str</span></dt><dd><p>Input source for orientations. Can be an <cite>EBSDmap</cite> object or a string
specifying the type of orientation set:
- ‘random’ or ‘rnd’ : generate a random orientation set
- ‘unimodal’, ‘uni_mod’, or ‘uni_modal’ : generate a unimodal orientation set</p>
</dd>
<dt>ang<span class="classifier">float, optional</span></dt><dd><p>Orientation angle for unimodal texture (required if <cite>data</cite> is unimodal).</p>
</dd>
<dt>omega<span class="classifier">float, optional</span></dt><dd><p>Kernel halfwidth for unimodal texture (required if <cite>data</cite> is unimodal).</p>
</dd>
<dt>Nbase<span class="classifier">int, default=5000</span></dt><dd><p>Number of base orientations used in random or unimodal generation.</p>
</dd>
<dt>hist<span class="classifier">array_like, optional</span></dt><dd><p>Histogram for the grain orientations, used to weight orientations.</p>
</dd>
<dt>shared_area<span class="classifier">array_like or float, optional</span></dt><dd><p>Shared grain boundary area for weighted orientation generation.</p>
</dd>
<dt>iphase<span class="classifier">int, optional</span></dt><dd><p>Phase index for which orientations are generated. If None, all phases are processed.</p>
</dd>
<dt>verbose<span class="classifier">bool, default=False</span></dt><dd><p>If True, prints additional information during orientation generation.</p>
</dd>
</dl>
</section>
<section id="id4">
<h4>Returns<a class="headerlink" href="#id4" title="Link to this heading"></a></h4>
<dl class="simple">
<dt>None</dt><dd><p>The generated orientations are stored in <cite>self.mesh.grain_ori_dict</cite> and
<cite>self.mesh.texture</cite> is updated to reflect the type of generated texture.</p>
</dd>
</dl>
</section>
<section id="id5">
<h4>Raises<a class="headerlink" href="#id5" title="Link to this heading"></a></h4>
<dl class="simple">
<dt>ValueError</dt><dd><ul class="simple">
<li><p>If grain geometry is not defined (i.e., <cite>self.mesh.grains</cite> is None).</p></li>
<li><p>If <cite>data</cite> is unimodal but <cite>ang</cite> or <cite>omega</cite> are not provided.</p></li>
<li><p>If <cite>data</cite> is neither <cite>EBSDmap</cite> nor a recognized string option.</p></li>
<li><p>If histogram is provided but GB areas are not defined (and <cite>shared_area</cite> is None).</p></li>
</ul>
</dd>
</dl>
</section>
<section id="examples">
<h4>Examples<a class="headerlink" href="#examples" title="Link to this heading"></a></h4>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Generate random orientations for all grains</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rve</span><span class="o">.</span><span class="n">generate_orientations</span><span class="p">(</span><span class="s1">&#39;random&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Generate unimodal orientations with specified angle and halfwidth</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rve</span><span class="o">.</span><span class="n">generate_orientations</span><span class="p">(</span><span class="s1">&#39;unimodal&#39;</span><span class="p">,</span> <span class="n">ang</span><span class="o">=</span><span class="mf">30.0</span><span class="p">,</span> <span class="n">omega</span><span class="o">=</span><span class="mf">10.0</span><span class="p">)</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Generate orientations for a specific phase with histogram weighting</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rve</span><span class="o">.</span><span class="n">generate_orientations</span><span class="p">(</span><span class="s1">&#39;random&#39;</span><span class="p">,</span> <span class="n">hist</span><span class="o">=</span><span class="n">hist_array</span><span class="p">,</span> <span class="n">iphase</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Generate orientations using an EBSDmap object</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rve</span><span class="o">.</span><span class="n">generate_orientations</span><span class="p">(</span><span class="n">ebsd_map_obj</span><span class="p">)</span>
</pre></div>
</div>
</section>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="kanapy.core.api.Microstructure.import_particles">
<span class="sig-name descname"><span class="pre">import_particles</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">file</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">path</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'./'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/kanapy/core/api.html#Microstructure.import_particles"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kanapy.core.api.Microstructure.import_particles" title="Link to this definition"></a></dt>
<dd><p>Import particle data from a dump file</p>
<p>This function reads particle information from a specified dump file and
stores it in the microstructure object, updating the simulation box and
particle list.</p>
<section id="id6">
<h4>Parameters<a class="headerlink" href="#id6" title="Link to this heading"></a></h4>
<dl class="simple">
<dt>file<span class="classifier">str</span></dt><dd><p>Name of the input dump file containing particle data</p>
</dd>
<dt>path<span class="classifier">str, optional</span></dt><dd><p>Directory path where the dump file is located. Default is current directory ‘./’</p>
</dd>
</dl>
</section>
<section id="id7">
<h4>Returns<a class="headerlink" href="#id7" title="Link to this heading"></a></h4>
<dl class="simple">
<dt>None</dt><dd><p>Updates the object’s simbox and particles attributes</p>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="kanapy.core.api.Microstructure.init_RVE">
<span class="sig-name descname"><span class="pre">init_RVE</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">descriptor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nsteps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1000</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/kanapy/core/api.html#Microstructure.init_RVE"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kanapy.core.api.Microstructure.init_RVE" title="Link to this definition"></a></dt>
<dd><p>Initialize the Representative Volume Element (RVE) of the microstructure</p>
<p>This method creates the voxel- or particle-based RVE using the provided
phase descriptor(s). It sets up the mesh dimensions, particle distribution,
and simulation box geometry. The RVE object is constructed using the
<cite>RVE_creator</cite> class, and key attributes such as <cite>nparticles</cite> and <cite>simbox</cite>
are updated accordingly.</p>
<section id="id8">
<h4>Parameters<a class="headerlink" href="#id8" title="Link to this heading"></a></h4>
<dl class="simple">
<dt>descriptor<span class="classifier">list of dict, dict, or None, optional</span></dt><dd><p>Description of the microstructure phases. Each dictionary specifies
parameters such as grain type, equivalent diameter, aspect ratio,
and tilt angle. If <cite>None</cite>, the class attribute <cite>self.descriptor</cite> is used.</p>
</dd>
<dt>nsteps<span class="classifier">int, optional</span></dt><dd><p>Number of optimization or relaxation steps for RVE generation.
Default is 1000.</p>
</dd>
</dl>
</section>
<section id="id9">
<h4>Notes<a class="headerlink" href="#id9" title="Link to this heading"></a></h4>
<ul class="simple">
<li><p>Assumes that <cite>RVE_creator</cite> and <cite>Simulation_Box</cite> are available and correctly configured.</p></li>
<li><p>If <cite>self.precipit</cite> is defined, an additional ‘Matrix’ phase is automatically
added to preserve total volume fraction normalization.</p></li>
</ul>
</section>
<section id="attributes-updated">
<h4>Attributes Updated<a class="headerlink" href="#attributes-updated" title="Link to this heading"></a></h4>
<dl class="simple">
<dt>rve<span class="classifier">RVE_creator</span></dt><dd><p>The created RVE object containing voxel/particle information, size,
periodicity, and phase volume fractions.</p>
</dd>
<dt>nparticles<span class="classifier">list</span></dt><dd><p>Number of particles per phase after RVE generation.</p>
</dd>
<dt>simbox<span class="classifier">Simulation_Box</span></dt><dd><p>Object containing the geometric boundaries of the RVE domain.</p>
</dd>
<dt>precipit<span class="classifier">float or None</span></dt><dd><p>If not None, a ‘Matrix’ phase is appended to <cite>rve.phase_names</cite> and its
volume fraction is adjusted as (1.0 - precipit).</p>
</dd>
</dl>
</section>
<section id="id10">
<h4>Returns<a class="headerlink" href="#id10" title="Link to this heading"></a></h4>
<dl class="simple">
<dt>None</dt><dd><p>Updates class attributes with the initialized RVE and simulation box.</p>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="kanapy.core.api.Microstructure.init_stats">
<span class="sig-name descname"><span class="pre">init_stats</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">descriptor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gs_data</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ar_data</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">porous</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_files</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/kanapy/core/api.html#Microstructure.init_stats"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kanapy.core.api.Microstructure.init_stats" title="Link to this definition"></a></dt>
<dd><p>Legacy function that redirects to plot_stats_init</p>
<p>This function is deprecated and serves as a wrapper for <cite>plot_stats_init</cite>.
A warning is logged advising users to use <cite>plot_stats_init</cite> directly.</p>
<section id="id11">
<h4>Parameters<a class="headerlink" href="#id11" title="Link to this heading"></a></h4>
<dl class="simple">
<dt>descriptor<span class="classifier">Any, optional</span></dt><dd><p>Descriptor data passed to <cite>plot_stats_init</cite>. Default is None.</p>
</dd>
<dt>gs_data<span class="classifier">Any, optional</span></dt><dd><p>Grain size data passed to <cite>plot_stats_init</cite>. Default is None.</p>
</dd>
<dt>ar_data<span class="classifier">Any, optional</span></dt><dd><p>Aspect ratio data passed to <cite>plot_stats_init</cite>. Default is None.</p>
</dd>
<dt>porous<span class="classifier">bool, optional</span></dt><dd><p>Deprecated parameter, ignored. Default is False.</p>
</dd>
<dt>save_files<span class="classifier">bool, optional</span></dt><dd><p>Whether to save generated statistics files. Default is False.</p>
</dd>
</dl>
</section>
<section id="id12">
<h4>Returns<a class="headerlink" href="#id12" title="Link to this heading"></a></h4>
<dl class="simple">
<dt>None</dt><dd><p>Calls <cite>plot_stats_init</cite> and does not return any value</p>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="kanapy.core.api.Microstructure.output_abq">
<span class="sig-name descname"><span class="pre">output_abq</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">nodes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">voxel_dict</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grain_dict</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">faces</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dual_phase</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">thermal</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">units</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/kanapy/core/api.html#Microstructure.output_abq"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kanapy.core.api.Microstructure.output_abq" title="Link to this definition"></a></dt>
<dd><p>Legacy function that redirects to write_abq</p>
<p>This function is deprecated and serves as a wrapper for <cite>write_abq</cite>.
Warnings are logged advising users to use <cite>write_abq</cite> directly. The <cite>faces</cite>
parameter is determined automatically if provided.</p>
<section id="id13">
<h4>Parameters<a class="headerlink" href="#id13" title="Link to this heading"></a></h4>
<dl class="simple">
<dt>nodes<span class="classifier">array-like, optional</span></dt><dd><p>Nodal coordinates to include in the output. Default is None.</p>
</dd>
<dt>name<span class="classifier">str, optional</span></dt><dd><p>File name for the Abaqus input file. Default is None.</p>
</dd>
<dt>voxel_dict<span class="classifier">dict, optional</span></dt><dd><p>Voxel connectivity information. Default is None.</p>
</dd>
<dt>grain_dict<span class="classifier">dict, optional</span></dt><dd><p>Grain-to-voxel mapping. Default is None.</p>
</dd>
<dt>faces<span class="classifier">Any, optional</span></dt><dd><p>Deprecated parameter, automatically determined. Default is None.</p>
</dd>
<dt>dual_phase<span class="classifier">bool, optional</span></dt><dd><p>Whether to include dual-phase data. Default is False.</p>
</dd>
<dt>thermal<span class="classifier">bool, optional</span></dt><dd><p>Whether to include thermal data. Default is False.</p>
</dd>
<dt>units<span class="classifier">dict, optional</span></dt><dd><p>Dictionary of units for the Abaqus model. Default is None.</p>
</dd>
</dl>
</section>
<section id="id14">
<h4>Returns<a class="headerlink" href="#id14" title="Link to this heading"></a></h4>
<dl class="simple">
<dt>None</dt><dd><p>Calls <cite>write_abq</cite> and does not return any value</p>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="kanapy.core.api.Microstructure.output_ang">
<span class="sig-name descname"><span class="pre">output_ang</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ori</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cut</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'xy'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pos</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fname</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">matname</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'XXXX'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_files</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dual_phase</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_plot</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/kanapy/core/api.html#Microstructure.output_ang"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kanapy.core.api.Microstructure.output_ang" title="Link to this definition"></a></dt>
<dd><p>Convert microstructure orientations into a .ang file, optionally plotting a slice</p>
<p>This function generates a .ang file mimicking an EBSD map. If polygonalized
microstructure is available, it will be used; otherwise, or if <cite>data=’voxels’</cite>,
the voxelized microstructure will be exported. If no orientations are provided,
each grain receives a random Euler angle. The function can also plot a 2D slice
of the orientation map along a specified cutting plane.</p>
<section id="id15">
<h4>Parameters<a class="headerlink" href="#id15" title="Link to this heading"></a></h4>
<dl class="simple">
<dt>ori<span class="classifier">array-like of shape (self.Ngr, 3), optional</span></dt><dd><p>Euler angles of grains. If None, random angles are generated.</p>
</dd>
<dt>cut<span class="classifier">{‘xy’, ‘xz’, ‘yz’}, optional</span></dt><dd><p>Plane along which to take a slice. Default is ‘xy’.</p>
</dd>
<dt>data<span class="classifier">{‘voxels’, ‘poly’}, optional</span></dt><dd><p>Basis for generating the ANG file. Default is None, automatically selected.</p>
</dd>
<dt>plot<span class="classifier">bool, optional</span></dt><dd><p>Whether to display a plot of the slice. Default is True.</p>
</dd>
<dt>cs<span class="classifier">str, optional</span></dt><dd><p>Crystal symmetry. Default is None.</p>
</dd>
<dt>pos<span class="classifier">float or str, optional</span></dt><dd><p>Slice position as a numerical value or one of ‘top’, ‘bottom’, ‘left’, ‘right’.
Default is None (uses top/right edge).</p>
</dd>
<dt>fname<span class="classifier">str, optional</span></dt><dd><p>Filename for the output ANG file. Default is generated automatically.</p>
</dd>
<dt>matname<span class="classifier">str, optional</span></dt><dd><p>Material name to write in the ANG file. Default is ‘XXXX’.</p>
</dd>
<dt>save_files<span class="classifier">bool, optional</span></dt><dd><p>Whether to save the ANG file. Default is True.</p>
</dd>
<dt>dual_phase<span class="classifier">bool, optional</span></dt><dd><p>Whether to output dual-phase information. Default is False.</p>
</dd>
<dt>save_plot<span class="classifier">bool, optional</span></dt><dd><p>Whether to save the plot as a PDF. Default is False.</p>
</dd>
</dl>
</section>
<section id="id16">
<h4>Returns<a class="headerlink" href="#id16" title="Link to this heading"></a></h4>
<dl class="simple">
<dt>fname<span class="classifier">str</span></dt><dd><p>Name of the generated ANG file.</p>
</dd>
</dl>
</section>
<section id="id17">
<h4>Raises<a class="headerlink" href="#id17" title="Link to this heading"></a></h4>
<dl class="simple">
<dt>ValueError</dt><dd><ul class="simple">
<li><p>If <cite>pos</cite> is not a float or one of ‘top’, ‘bottom’, ‘left’, ‘right’.</p></li>
<li><p>If <cite>cut</cite> is not ‘xy’, ‘xz’, or ‘yz’.</p></li>
<li><p>If neither polygonal nor voxel microstructure is available.</p></li>
</ul>
</dd>
</dl>
</section>
<section id="id18">
<h4>Notes<a class="headerlink" href="#id18" title="Link to this heading"></a></h4>
<ul class="simple">
<li><p>Uses Delaunay triangulation to determine which grain each pixel belongs to
when exporting polygons.</p></li>
<li><p>Slice plotting uses a colormap (default ‘prism’) and includes optional
dual-phase coloring.</p></li>
</ul>
</section>
<section id="id19">
<h4>Examples<a class="headerlink" href="#id19" title="Link to this heading"></a></h4>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Export an XY slice with default settings</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fname</span> <span class="o">=</span> <span class="n">rve</span><span class="o">.</span><span class="n">output_ang</span><span class="p">(</span><span class="n">cut</span><span class="o">=</span><span class="s1">&#39;xy&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Export a slice using voxel data and a specific Euler angles array</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fname</span> <span class="o">=</span> <span class="n">rve</span><span class="o">.</span><span class="n">output_ang</span><span class="p">(</span><span class="n">ori</span><span class="o">=</span><span class="n">euler_array</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="s1">&#39;voxels&#39;</span><span class="p">,</span> <span class="n">cut</span><span class="o">=</span><span class="s1">&#39;xz&#39;</span><span class="p">,</span> <span class="n">pos</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Plot and save the slice as PDF</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fname</span> <span class="o">=</span> <span class="n">rve</span><span class="o">.</span><span class="n">output_ang</span><span class="p">(</span><span class="n">save_plot</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</section>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="kanapy.core.api.Microstructure.output_neper">
<span class="sig-name descname"><span class="pre">output_neper</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/kanapy/core/api.html#Microstructure.output_neper"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kanapy.core.api.Microstructure.output_neper" title="Link to this definition"></a></dt>
<dd><p>Write particle position and weight files for Neper tessellation</p>
<p>This function generates two text files required for tessellation in Neper:
- <cite>sphere_positions.txt</cite> containing the x, y, z coordinates of each particle
- <cite>sphere_weights.txt</cite> containing the weight (radius) of each particle</p>
<p>The files are written in the current working directory. Each particle in
<cite>self.particles</cite> is included in the output.</p>
<section id="id20">
<h4>Raises<a class="headerlink" href="#id20" title="Link to this heading"></a></h4>
<dl class="simple">
<dt>ValueError</dt><dd><p>If <cite>self.particles</cite> is None, indicating that particles have not been packed yet.</p>
</dd>
</dl>
</section>
<section id="id21">
<h4>Notes<a class="headerlink" href="#id21" title="Link to this heading"></a></h4>
<ul class="simple">
<li><p>Requires that particles are initialized via the <cite>pack()</cite> method.</p></li>
<li><p>The particle dictionary is built internally but not returned.</p></li>
</ul>
</section>
<section id="id22">
<h4>Examples<a class="headerlink" href="#id22" title="Link to this heading"></a></h4>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Write Neper input files for current particles</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rve</span><span class="o">.</span><span class="n">output_neper</span><span class="p">()</span>
</pre></div>
</div>
</section>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="kanapy.core.api.Microstructure.pack">
<span class="sig-name descname"><span class="pre">pack</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">particle_data</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">k_rep</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">k_att</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fill_factor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">poly</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_files</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/kanapy/core/api.html#Microstructure.pack"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kanapy.core.api.Microstructure.pack" title="Link to this definition"></a></dt>
<dd><p>Pack particles into the simulation box according to the RVE settings.</p>
<section id="id23">
<h4>Parameters<a class="headerlink" href="#id23" title="Link to this heading"></a></h4>
<dl class="simple">
<dt>particle_data<span class="classifier">array-like or None, optional</span></dt><dd><p>Particle information. If None, uses self.rve.particle_data.</p>
</dd>
<dt>k_rep<span class="classifier">float, optional</span></dt><dd><p>Repulsion coefficient between particles. Default is 0.0.</p>
</dd>
<dt>k_att<span class="classifier">float, optional</span></dt><dd><p>Attraction coefficient between particles. Default is 0.0.</p>
</dd>
<dt>fill_factor<span class="classifier">float or None, optional</span></dt><dd><p>Fraction of simulation box to fill. Defaults to 1.0 if self.precipit is set.</p>
</dd>
<dt>poly<span class="classifier">optional</span></dt><dd><p>Additional packing options for polyhedral particles.</p>
</dd>
<dt>save_files<span class="classifier">bool, optional</span></dt><dd><p>If True, saves packed particle data to files.</p>
</dd>
<dt>verbose<span class="classifier">bool, optional</span></dt><dd><p>If True, prints progress and warnings during packing.</p>
</dd>
</dl>
</section>
<section id="id24">
<h4>Returns<a class="headerlink" href="#id24" title="Link to this heading"></a></h4>
<dl class="simple">
<dt>particles<span class="classifier">list</span></dt><dd><p>List of packed particle objects with positions and geometrical information.</p>
</dd>
<dt>simbox<span class="classifier">Simulation_Box</span></dt><dd><p>Updated simulation box reflecting particle packing.</p>
</dd>
</dl>
</section>
<section id="id25">
<h4>Raises<a class="headerlink" href="#id25" title="Link to this heading"></a></h4>
<dl class="simple">
<dt>ValueError</dt><dd><p>If no particle data is available.</p>
</dd>
<dt>AttributeError</dt><dd><p>If RVE or simulation box is not initialized before packing.</p>
</dd>
</dl>
</section>
<section id="id26">
<h4>Notes<a class="headerlink" href="#id26" title="Link to this heading"></a></h4>
<p>If self.precipit &gt; 0.65, particle overlaps may occur.
Requires self.rve and self.simbox to be initialized before calling.</p>
</section>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="kanapy.core.api.Microstructure.pckl">
<span class="sig-name descname"><span class="pre">pckl</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">file</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">path</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'./'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/kanapy/core/api.html#Microstructure.pckl"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kanapy.core.api.Microstructure.pckl" title="Link to this definition"></a></dt>
<dd><p>Write the microstructure into a pickle file</p>
<p>This function serializes the microstructure object using pickle, allowing
complex structures to be stored and later reloaded.</p>
<section id="id27">
<h4>Parameters<a class="headerlink" href="#id27" title="Link to this heading"></a></h4>
<dl class="simple">
<dt>file<span class="classifier">str, optional</span></dt><dd><p>File name for the pickled microstructure. If None, the filename defaults
to the microstructure name plus ‘.pckl’.</p>
</dd>
<dt>path<span class="classifier">str, optional</span></dt><dd><p>Directory path to save the pickle file. Default is current directory ‘./’.</p>
</dd>
</dl>
</section>
<section id="id28">
<h4>Returns<a class="headerlink" href="#id28" title="Link to this heading"></a></h4>
<p>None</p>
</section>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="kanapy.core.api.Microstructure.plot_ellipsoids">
<span class="sig-name descname"><span class="pre">plot_ellipsoids</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cmap</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'prism'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dual_phase</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">phases</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/kanapy/core/api.html#Microstructure.plot_ellipsoids"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kanapy.core.api.Microstructure.plot_ellipsoids" title="Link to this definition"></a></dt>
<dd><p>Generate a 3D plot of particles in the RVE</p>
<p>This function visualizes ellipsoidal particles in the Representative Volume Element (RVE).
Particles can be colored according to phase, and a custom colormap can be used.
Note that <cite>dual_phase</cite> is deprecated; use <cite>phases</cite> instead.</p>
<section id="id29">
<h4>Parameters<a class="headerlink" href="#id29" title="Link to this heading"></a></h4>
<dl class="simple">
<dt>cmap<span class="classifier">str, optional</span></dt><dd><p>Colormap used for plotting particles. Default is ‘prism’.</p>
</dd>
<dt>dual_phase<span class="classifier">bool or None, optional</span></dt><dd><p>Deprecated parameter for indicating dual-phase visualization.
Use <cite>phases</cite> instead. Default is None.</p>
</dd>
<dt>phases<span class="classifier">bool, optional</span></dt><dd><p>If True, color particles according to their phase. Default is False.</p>
</dd>
</dl>
</section>
<section id="id30">
<h4>Notes<a class="headerlink" href="#id30" title="Link to this heading"></a></h4>
<ul class="simple">
<li><p>Requires <cite>self.particles</cite> to be initialized by <cite>pack</cite>.</p></li>
<li><p>Automatically calculates aspect ratios of the RVE for proper 3D plotting.</p></li>
<li><p>Prints a warning if <cite>dual_phase</cite> is used and maps it to <cite>phases</cite>.</p></li>
</ul>
</section>
<section id="id31">
<h4>Returns<a class="headerlink" href="#id31" title="Link to this heading"></a></h4>
<dl class="simple">
<dt>None</dt><dd><p>Displays a 3D plot of ellipsoidal particles using <cite>plot_ellipsoids_3D</cite>.</p>
</dd>
</dl>
</section>
<section id="id32">
<h4>Raises<a class="headerlink" href="#id32" title="Link to this heading"></a></h4>
<dl class="simple">
<dt>ValueError</dt><dd><ul class="simple">
<li><p>If <cite>self.particles</cite> is None.</p></li>
</ul>
</dd>
</dl>
</section>
<section id="id33">
<h4>Examples<a class="headerlink" href="#id33" title="Link to this heading"></a></h4>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Simple 3D plot with default colormap</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rve</span><span class="o">.</span><span class="n">plot_ellipsoids</span><span class="p">()</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Color particles according to phase</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rve</span><span class="o">.</span><span class="n">plot_ellipsoids</span><span class="p">(</span><span class="n">phases</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Use a custom colormap</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rve</span><span class="o">.</span><span class="n">plot_ellipsoids</span><span class="p">(</span><span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;viridis&#39;</span><span class="p">)</span>
</pre></div>
</div>
</section>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="kanapy.core.api.Microstructure.plot_grains">
<span class="sig-name descname"><span class="pre">plot_grains</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">geometry</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cmap</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'prism'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.4</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ec</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dual_phase</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">phases</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/kanapy/core/api.html#Microstructure.plot_grains"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kanapy.core.api.Microstructure.plot_grains" title="Link to this definition"></a></dt>
<dd><p>Plot the polygonalized microstructure of the RVE in 3D.</p>
<p>This function visualizes the polygonal (polyhedral) grain geometry of the
microstructure, typically after <cite>generate_grains()</cite> has been executed.
Users can customize the colormap, transparency, and edge color. It also
supports coloring grains by phase.</p>
<section id="id34">
<h4>Parameters<a class="headerlink" href="#id34" title="Link to this heading"></a></h4>
<dl class="simple">
<dt>geometry<span class="classifier">dict or None, optional</span></dt><dd><p>Dictionary containing the polygonal grain geometries. If None, uses
<cite>self.geometry</cite>.</p>
</dd>
<dt>cmap<span class="classifier">str, optional</span></dt><dd><p>Matplotlib colormap name for rendering grain colors. Default is ‘prism’.</p>
</dd>
<dt>alpha<span class="classifier">float, optional</span></dt><dd><p>Transparency level of the grain surfaces (0 = fully transparent,
1 = fully opaque). Default is 0.4.</p>
</dd>
<dt>ec<span class="classifier">list or None, optional</span></dt><dd><p>Edge color specified as an RGBA list, e.g. <cite>[0.5, 0.5, 0.5, 0.1]</cite>.
Default is <cite>[0.5, 0.5, 0.5, 0.1]</cite>.</p>
</dd>
<dt>dual_phase<span class="classifier">bool or None, optional</span></dt><dd><p>Deprecated parameter for dual-phase coloring. Use <cite>phases</cite> instead.
Default is None.</p>
</dd>
<dt>phases<span class="classifier">bool, optional</span></dt><dd><p>If True, color grains by phase rather than by grain ID. Default is False.</p>
</dd>
</dl>
</section>
<section id="id35">
<h4>Notes<a class="headerlink" href="#id35" title="Link to this heading"></a></h4>
<ul class="simple">
<li><p>Requires polygonal grain data generated by <cite>generate_grains()</cite>.</p></li>
<li><p>Automatically computes the aspect ratio of the RVE for correct 3D scaling.</p></li>
<li><p>Visualization is handled by <cite>plot_polygons_3D()</cite>.</p></li>
<li><p>The parameter <cite>dual_phase</cite> is deprecated; prefer using <cite>phases</cite> instead.</p></li>
</ul>
</section>
<section id="id36">
<h4>Returns<a class="headerlink" href="#id36" title="Link to this heading"></a></h4>
<dl class="simple">
<dt>None</dt><dd><p>Displays a 3D plot of polygonal grains.</p>
</dd>
</dl>
</section>
<section id="id37">
<h4>Raises<a class="headerlink" href="#id37" title="Link to this heading"></a></h4>
<dl class="simple">
<dt>ValueError</dt><dd><p>If no polygonal geometry is available (i.e., <cite>self.geometry</cite> is None).</p>
</dd>
</dl>
</section>
<section id="id38">
<h4>Examples<a class="headerlink" href="#id38" title="Link to this heading"></a></h4>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Simple 3D plot of polygonal grains with default settings</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rve</span><span class="o">.</span><span class="n">plot_grains</span><span class="p">()</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Color grains by phase</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rve</span><span class="o">.</span><span class="n">plot_grains</span><span class="p">(</span><span class="n">phases</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Use a custom colormap and set transparency</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rve</span><span class="o">.</span><span class="n">plot_grains</span><span class="p">(</span><span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;viridis&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.6</span><span class="p">)</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Specify edge color</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rve</span><span class="o">.</span><span class="n">plot_grains</span><span class="p">(</span><span class="n">ec</span><span class="o">=</span><span class="p">[</span><span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">])</span>
</pre></div>
</div>
</section>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="kanapy.core.api.Microstructure.plot_particles">
<span class="sig-name descname"><span class="pre">plot_particles</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cmap</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'prism'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dual_phase</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">phases</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot_hull</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/kanapy/core/api.html#Microstructure.plot_particles"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kanapy.core.api.Microstructure.plot_particles" title="Link to this definition"></a></dt>
<dd><p>Generate a 3D plot of particles in the RVE.</p>
<p>This function visualizes particles in the Representative Volume Element (RVE) in 3D.
Particles can be colored according to phase, plotted with their convex hulls, and
displayed using a custom colormap.</p>
<section id="id39">
<h4>Parameters<a class="headerlink" href="#id39" title="Link to this heading"></a></h4>
<dl class="simple">
<dt>cmap<span class="classifier">str, optional</span></dt><dd><p>Colormap used for plotting particles. Default is ‘prism’.</p>
</dd>
<dt>dual_phase<span class="classifier">bool or None, optional</span></dt><dd><p>Deprecated parameter for indicating dual-phase visualization.
Use <cite>phases</cite> instead. Default is None.</p>
</dd>
<dt>phases<span class="classifier">bool, optional</span></dt><dd><p>If True, color particles according to their phase. Default is False.</p>
</dd>
<dt>plot_hull<span class="classifier">bool, optional</span></dt><dd><p>If True, plot the convex hull (inner polygon) of each particle. Default is True.</p>
</dd>
</dl>
</section>
<section id="id40">
<h4>Notes<a class="headerlink" href="#id40" title="Link to this heading"></a></h4>
<ul class="simple">
<li><p>Requires <cite>self.particles</cite> to be initialized by <cite>pack</cite>.</p></li>
<li><p>Automatically calculates aspect ratios of the RVE for proper 3D plotting.</p></li>
<li><p>Prints a warning if <cite>dual_phase</cite> is used and maps it to <cite>phases</cite>.</p></li>
</ul>
</section>
<section id="id41">
<h4>Returns<a class="headerlink" href="#id41" title="Link to this heading"></a></h4>
<dl class="simple">
<dt>None</dt><dd><p>Displays a 3D plot of particles using <cite>plot_particles_3D</cite>.</p>
</dd>
</dl>
</section>
<section id="id42">
<h4>Raises<a class="headerlink" href="#id42" title="Link to this heading"></a></h4>
<dl class="simple">
<dt>ValueError</dt><dd><ul class="simple">
<li><p>If <cite>self.particles</cite> is None.</p></li>
<li><p>If particles do not have inner polygons.</p></li>
</ul>
</dd>
</dl>
</section>
<section id="id43">
<h4>Examples<a class="headerlink" href="#id43" title="Link to this heading"></a></h4>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Simple 3D plot with default colormap and convex hulls</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rve</span><span class="o">.</span><span class="n">plot_particles</span><span class="p">()</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Color particles according to phase</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rve</span><span class="o">.</span><span class="n">plot_particles</span><span class="p">(</span><span class="n">phases</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Plot particles without convex hulls and use a custom colormap</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rve</span><span class="o">.</span><span class="n">plot_particles</span><span class="p">(</span><span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;viridis&#39;</span><span class="p">,</span> <span class="n">plot_hull</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</section>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="kanapy.core.api.Microstructure.plot_slice">
<span class="sig-name descname"><span class="pre">plot_slice</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cut</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'xy'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pos</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fname</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dual_phase</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_files</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/kanapy/core/api.html#Microstructure.plot_slice"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kanapy.core.api.Microstructure.plot_slice" title="Link to this definition"></a></dt>
<dd><p>Plot a 2D slice through the microstructure.</p>
<p>The function visualizes a cross-section of the microstructure. If a polygonalized
microstructure is available, it will be used as the plotting basis; otherwise,
or if <cite>data=’voxels’</cite>, the voxelized microstructure will be plotted. This method
internally calls <cite>output_ang</cite> with plotting enabled and file writing disabled.</p>
<section id="id44">
<h4>Parameters<a class="headerlink" href="#id44" title="Link to this heading"></a></h4>
<dl class="simple">
<dt>cut<span class="classifier">str, optional</span></dt><dd><p>The cutting plane of the slice. Options are ‘xy’, ‘xz’, or ‘yz’.
Default is ‘xy’.</p>
</dd>
<dt>data<span class="classifier">str, optional</span></dt><dd><p>Data basis for plotting. Options are ‘voxels’ or ‘poly’. Default is None.</p>
</dd>
<dt>pos<span class="classifier">str or float, optional</span></dt><dd><p>Position of the slice, either as an absolute value or as one of
‘top’, ‘bottom’, ‘left’, ‘right’. Default is None.</p>
</dd>
<dt>fname<span class="classifier">str, optional</span></dt><dd><p>Filename to save the figure as a PDF. Default is None.</p>
</dd>
<dt>dual_phase<span class="classifier">bool, optional</span></dt><dd><p>If True, enable dual-phase visualization. Default is False.</p>
</dd>
<dt>save_files<span class="classifier">bool, optional</span></dt><dd><p>If True, the figure will be saved to disk. Default is False.</p>
</dd>
</dl>
</section>
<section id="id45">
<h4>Returns<a class="headerlink" href="#id45" title="Link to this heading"></a></h4>
<p>None</p>
</section>
<section id="id46">
<h4>Examples<a class="headerlink" href="#id46" title="Link to this heading"></a></h4>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">micro</span><span class="o">.</span><span class="n">plot_slice</span><span class="p">(</span><span class="n">cut</span><span class="o">=</span><span class="s1">&#39;xz&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="s1">&#39;poly&#39;</span><span class="p">,</span> <span class="n">pos</span><span class="o">=</span><span class="s1">&#39;top&#39;</span><span class="p">,</span> <span class="n">save_files</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</section>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="kanapy.core.api.Microstructure.plot_stats">
<span class="sig-name descname"><span class="pre">plot_stats</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gs_data</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gs_param</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ar_data</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ar_param</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dual_phase</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">phases</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_files</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show_all</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">silent</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">enhanced_plot</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/kanapy/core/api.html#Microstructure.plot_stats"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kanapy.core.api.Microstructure.plot_stats" title="Link to this definition"></a></dt>
<dd><p>Plot particle, voxel, and grain diameter statistics for comparison</p>
<p>This method analyzes the microstructure at different representation levels
(particles, voxels, and polyhedral grains) and plots corresponding statistical
distributions. It can optionally handle multiphase materials, save plots,
and display detailed information about geometric parameters.</p>
<section id="id47">
<h4>Parameters<a class="headerlink" href="#id47" title="Link to this heading"></a></h4>
<dl class="simple">
<dt>data<span class="classifier">str or None, optional</span></dt><dd><p>Specifies which type of data to analyze and plot:
- ‘p’ : particles
- ‘v’ : voxels
- ‘g’ : grains
If None, all available data types are analyzed.</p>
</dd>
<dt>gs_data<span class="classifier">list or array-like, optional</span></dt><dd><p>Grain size data for comparison with simulation results.</p>
</dd>
<dt>gs_param<span class="classifier">list or array-like, optional</span></dt><dd><p>Parameters for fitting grain size distributions.</p>
</dd>
<dt>ar_data<span class="classifier">list or array-like, optional</span></dt><dd><p>Aspect ratio data for comparison with simulation results.</p>
</dd>
<dt>ar_param<span class="classifier">list or array-like, optional</span></dt><dd><p>Parameters for fitting aspect ratio distributions.</p>
</dd>
<dt>dual_phase<span class="classifier">bool or None, optional</span></dt><dd><p>Deprecated. Use <cite>phases</cite> instead.</p>
</dd>
<dt>phases<span class="classifier">bool, optional</span></dt><dd><p>If True, perform separate statistical analysis for each phase.</p>
</dd>
<dt>save_files<span class="classifier">bool, optional</span></dt><dd><p>If True, save generated plots and statistical results to files.</p>
</dd>
<dt>show_all<span class="classifier">bool, optional</span></dt><dd><p>If True, display all generated plots interactively.</p>
</dd>
<dt>verbose<span class="classifier">bool, optional</span></dt><dd><p>If True, print detailed numerical results during analysis.</p>
</dd>
<dt>silent<span class="classifier">bool, optional</span></dt><dd><p>If True, suppresses console output and returns figures directly.</p>
</dd>
<dt>enhanced_plot<span class="classifier">bool, optional</span></dt><dd><p>If True, use enhanced plot styling (automatically enabled when <cite>silent=True</cite>).</p>
</dd>
</dl>
</section>
<section id="id48">
<h4>Returns<a class="headerlink" href="#id48" title="Link to this heading"></a></h4>
<dl class="simple">
<dt>flist<span class="classifier">list of matplotlib.figure.Figure or None</span></dt><dd><p>List of generated figure objects if <cite>silent=True</cite>, otherwise None.</p>
</dd>
</dl>
</section>
<section id="id49">
<h4>Raises<a class="headerlink" href="#id49" title="Link to this heading"></a></h4>
<dl class="simple">
<dt>None</dt><dd><p>This function does not raise exceptions if data is missing. Instead, it logs an
error message and returns immediately.</p>
</dd>
</dl>
</section>
<section id="id50">
<h4>Notes<a class="headerlink" href="#id50" title="Link to this heading"></a></h4>
<ul class="simple">
<li><p>Computes and compares geometric parameters such as principal axis lengths
(a, b, c), aspect ratios, rotation axes, and equivalent diameters.</p></li>
<li><p>Results are stored in <cite>self.rve_stats</cite> and labeled in <cite>self.rve_stats_labels</cite>.</p></li>
<li><p>For multiphase structures, statistics are calculated per phase.</p></li>
<li><p><cite>dual_phase</cite> is deprecated; prefer using <cite>phases</cite>.</p></li>
</ul>
</section>
<section id="id51">
<h4>Examples<a class="headerlink" href="#id51" title="Link to this heading"></a></h4>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Plot all statistics with default settings</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rve</span><span class="o">.</span><span class="n">plot_stats</span><span class="p">()</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Plot only particle statistics and show all plots interactively</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rve</span><span class="o">.</span><span class="n">plot_stats</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="s1">&#39;p&#39;</span><span class="p">,</span> <span class="n">show_all</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Perform multiphase statistical analysis and save figures</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rve</span><span class="o">.</span><span class="n">plot_stats</span><span class="p">(</span><span class="n">phases</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">save_files</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Suppress console output and get figure objects</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">figs</span> <span class="o">=</span> <span class="n">rve</span><span class="o">.</span><span class="n">plot_stats</span><span class="p">(</span><span class="n">silent</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</section>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="kanapy.core.api.Microstructure.plot_stats_init">
<span class="sig-name descname"><span class="pre">plot_stats_init</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">descriptor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gs_data</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ar_data</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">porous</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">get_res</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show_res</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_files</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">silent</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_descriptors</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/kanapy/core/api.html#Microstructure.plot_stats_init"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kanapy.core.api.Microstructure.plot_stats_init" title="Link to this definition"></a></dt>
<dd><p>Plot initial statistical microstructure descriptors of RVE and optionally return computed descriptors</p>
<p>This method analyzes the initial microstructure defined by input descriptors
(or the class attribute <cite>self.descriptor</cite>) and plots the distributions of
equivalent diameters and aspect ratios. For elongated grains, it prints a
summary of input and output statistics. Optionally, statistical descriptors
can be returned for further processing.</p>
<section id="id52">
<h4>Parameters<a class="headerlink" href="#id52" title="Link to this heading"></a></h4>
<dl class="simple">
<dt>descriptor<span class="classifier">list of dict, dict, or None, optional</span></dt><dd><p>Microstructure phase descriptor(s). If None, uses <cite>self.descriptor</cite>.</p>
</dd>
<dt>gs_data<span class="classifier">list or array-like, optional</span></dt><dd><p>Grain size data for comparison with initial statistics.</p>
</dd>
<dt>ar_data<span class="classifier">list or array-like, optional</span></dt><dd><p>Aspect ratio data for comparison with initial statistics.</p>
</dd>
<dt>porous<span class="classifier">bool, optional</span></dt><dd><p>If True, only the first phase is considered (e.g., for porous structures).</p>
</dd>
<dt>get_res<span class="classifier">bool, optional</span></dt><dd><p>If True, computes statistical descriptors from the voxelized structure.</p>
</dd>
<dt>show_res<span class="classifier">bool, optional</span></dt><dd><p>If True, prints detailed statistical results to the console.</p>
</dd>
<dt>save_files<span class="classifier">bool, optional</span></dt><dd><p>If True, saves generated plots to files.</p>
</dd>
<dt>silent<span class="classifier">bool, optional</span></dt><dd><p>If True, suppresses console output and returns figures directly.</p>
</dd>
<dt>return_descriptors<span class="classifier">bool, optional</span></dt><dd><p>If True, returns computed statistical descriptors along with figures.</p>
</dd>
</dl>
</section>
<section id="id53">
<h4>Returns<a class="headerlink" href="#id53" title="Link to this heading"></a></h4>
<dl class="simple">
<dt>flist<span class="classifier">list of matplotlib.figure.Figure</span></dt><dd><p>List of generated figure objects.</p>
</dd>
<dt>descs<span class="classifier">list of dict</span></dt><dd><p>Optional list of computed statistical descriptors if <cite>return_descriptors=True</cite>.</p>
</dd>
</dl>
</section>
<section id="id54">
<h4>Notes<a class="headerlink" href="#id54" title="Link to this heading"></a></h4>
<ul class="simple">
<li><p>Requires voxelized microstructure (<cite>self.mesh</cite>) for computing descriptors.</p></li>
<li><p>Computes statistics for equivalent diameter, aspect ratio, principal axes,
and rotation axes when applicable.</p></li>
<li><p>Can handle multiphase or single-phase microstructures.</p></li>
</ul>
</section>
<section id="id55">
<h4>Examples<a class="headerlink" href="#id55" title="Link to this heading"></a></h4>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Plot initial statistics with default settings</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rve</span><span class="o">.</span><span class="n">plot_stats_init</span><span class="p">()</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Plot only the first phase (porous) and save figures</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rve</span><span class="o">.</span><span class="n">plot_stats_init</span><span class="p">(</span><span class="n">porous</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">save_files</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Compute descriptors and get figures and descriptor objects</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">figs</span><span class="p">,</span> <span class="n">descs</span> <span class="o">=</span> <span class="n">rve</span><span class="o">.</span><span class="n">plot_stats_init</span><span class="p">(</span><span class="n">get_res</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">return_descriptors</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Suppress console output and return figure objects</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">figs</span> <span class="o">=</span> <span class="n">rve</span><span class="o">.</span><span class="n">plot_stats_init</span><span class="p">(</span><span class="n">silent</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</section>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="kanapy.core.api.Microstructure.plot_voxels">
<span class="sig-name descname"><span class="pre">plot_voxels</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sliced</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dual_phase</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">phases</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cmap</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'prism'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ori</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">color_key</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">silent</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/kanapy/core/api.html#Microstructure.plot_voxels"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kanapy.core.api.Microstructure.plot_voxels" title="Link to this definition"></a></dt>
<dd><p>Generate a 3D visualization of the voxelized RVE structure</p>
<p>This function visualizes the voxel-based microstructure of the RVE. It supports
coloring by phase, grain ID, or crystallographic orientation, and can optionally
render a sliced view of the 3D voxel mesh.</p>
<section id="id56">
<h4>Parameters<a class="headerlink" href="#id56" title="Link to this heading"></a></h4>
<dl class="simple">
<dt>sliced<span class="classifier">bool, optional</span></dt><dd><p>If True, generates a sliced view of the voxel mesh to visualize the internal structure.
Default is False.</p>
</dd>
<dt>dual_phase<span class="classifier">bool or None, optional</span></dt><dd><p>Deprecated parameter for dual-phase visualization. Use <cite>phases</cite> instead.
Default is None.</p>
</dd>
<dt>phases<span class="classifier">bool, optional</span></dt><dd><p>If True, color voxels by phase instead of grain ID. Default is False.</p>
</dd>
<dt>cmap<span class="classifier">str, optional</span></dt><dd><p>Name of the matplotlib colormap used for rendering. Default is ‘prism’.</p>
</dd>
<dt>ori<span class="classifier">array-like, bool, or None, optional</span></dt><dd><p>Array of grain orientations, or True to use <cite>self.mesh.grain_ori_dict</cite> for coloring
via inverse pole figure (IPF) mapping. Default is None.</p>
</dd>
<dt>color_key<span class="classifier">int, optional</span></dt><dd><p>Selects the color mapping for orientations:
- 0: iphHSVKey
- 1: BungeColorKey
- 2: ipfHKLKey
Default is 0.</p>
</dd>
<dt>silent<span class="classifier">bool, optional</span></dt><dd><p>If True, suppresses figure display and returns the matplotlib figure object instead.
Default is False.</p>
</dd>
</dl>
</section>
<section id="id57">
<h4>Returns<a class="headerlink" href="#id57" title="Link to this heading"></a></h4>
<dl class="simple">
<dt>fig<span class="classifier">matplotlib.figure.Figure or None</span></dt><dd><p>Returns the figure object if <cite>silent=True</cite>. Otherwise, displays the 3D plot and returns None.</p>
</dd>
</dl>
</section>
<section id="id58">
<h4>Raises<a class="headerlink" href="#id58" title="Link to this heading"></a></h4>
<dl class="simple">
<dt>ValueError</dt><dd><p>If <cite>self.mesh.grains</cite> is None, indicating that voxelization has not been performed.</p>
</dd>
</dl>
</section>
<section id="id59">
<h4>Notes<a class="headerlink" href="#id59" title="Link to this heading"></a></h4>
<ul class="simple">
<li><p>Requires that the voxel mesh (<cite>self.mesh</cite>) has been generated by <cite>voxelize()</cite>.</p></li>
<li><p>If <cite>ori</cite> is provided, orientation-based coloring is applied using <cite>get_ipf_colors()</cite>.</p></li>
<li><p>Prints a warning if <cite>dual_phase</cite> is used, since it is deprecated and replaced by <cite>phases</cite>.</p></li>
<li><p>Automatically computes aspect ratios of the RVE to ensure accurate 3D visualization.</p></li>
</ul>
</section>
<section id="id60">
<h4>Examples<a class="headerlink" href="#id60" title="Link to this heading"></a></h4>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Simple 3D plot of voxelized RVE</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rve</span><span class="o">.</span><span class="n">plot_voxels</span><span class="p">()</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Plot a sliced view of the voxel mesh</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rve</span><span class="o">.</span><span class="n">plot_voxels</span><span class="p">(</span><span class="n">sliced</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Color voxels by phase and use a custom colormap</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rve</span><span class="o">.</span><span class="n">plot_voxels</span><span class="p">(</span><span class="n">phases</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;viridis&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Use orientation-based coloring via IPF mapping</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rve</span><span class="o">.</span><span class="n">plot_voxels</span><span class="p">(</span><span class="n">ori</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">color_key</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Suppress figure display and get the matplotlib Figure object</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fig</span> <span class="o">=</span> <span class="n">rve</span><span class="o">.</span><span class="n">plot_voxels</span><span class="p">(</span><span class="n">silent</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</section>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="kanapy.core.api.Microstructure.smoothen">
<span class="sig-name descname"><span class="pre">smoothen</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">nodes_v</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">voxel_dict</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grain_dict</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/kanapy/core/api.html#Microstructure.smoothen"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kanapy.core.api.Microstructure.smoothen" title="Link to this definition"></a></dt>
<dd><p>Generate smoothed grain boundaries from a voxelated mesh.</p>
<section id="id61">
<h4>Parameters<a class="headerlink" href="#id61" title="Link to this heading"></a></h4>
<dl class="simple">
<dt>nodes_v<span class="classifier">array-like or None, optional</span></dt><dd><p>Mesh node coordinates. If None, uses <cite>self.mesh.nodes</cite>.</p>
</dd>
<dt>voxel_dict<span class="classifier">dict or None, optional</span></dt><dd><p>Dictionary of voxels in the mesh. If None, uses <cite>self.mesh.voxel_dict</cite>.</p>
</dd>
<dt>grain_dict<span class="classifier">dict or None, optional</span></dt><dd><p>Dictionary mapping grains to their voxels. If None, uses <cite>self.mesh.grain_dict</cite>.</p>
</dd>
</dl>
</section>
<section id="id62">
<h4>Returns<a class="headerlink" href="#id62" title="Link to this heading"></a></h4>
<dl class="simple">
<dt>None</dt><dd><p>The smoothed nodes are stored in <cite>self.mesh.nodes_smooth</cite>. Grain boundary
faces are optionally stored in <cite>self.geometry[‘GBfaces’]</cite>.</p>
</dd>
</dl>
</section>
<section id="id63">
<h4>Raises<a class="headerlink" href="#id63" title="Link to this heading"></a></h4>
<dl class="simple">
<dt>ValueError</dt><dd><p>If <cite>nodes_v</cite> is None and <cite>self.mesh.nodes</cite> is not available.</p>
</dd>
<dt>AttributeError</dt><dd><p>If <cite>self.mesh</cite> is not initialized before calling <cite>smoothen()</cite>.</p>
</dd>
</dl>
</section>
<section id="id64">
<h4>Notes<a class="headerlink" href="#id64" title="Link to this heading"></a></h4>
<ul class="simple">
<li><p>Requires <cite>self.mesh</cite> to be initialized by <cite>voxelize()</cite>.</p></li>
<li><p>Updates <cite>self.mesh.nodes_smooth</cite> with smoothed node coordinates.</p></li>
<li><p>Adds ‘GBfaces’ entry to <cite>self.geometry</cite> if it exists.</p></li>
</ul>
</section>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="kanapy.core.api.Microstructure.voxelize">
<span class="sig-name descname"><span class="pre">voxelize</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">particles</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/kanapy/core/api.html#Microstructure.voxelize"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kanapy.core.api.Microstructure.voxelize" title="Link to this definition"></a></dt>
<dd><p>Generate the RVE by assigning voxels to grains.</p>
<section id="id65">
<h4>Parameters<a class="headerlink" href="#id65" title="Link to this heading"></a></h4>
<dl class="simple">
<dt>particles<span class="classifier">list or None, optional</span></dt><dd><p>List of particle objects to voxelize. If None, uses <cite>self.particles</cite>.</p>
</dd>
<dt>dim<span class="classifier">tuple of int, optional</span></dt><dd><p>3-tuple specifying the number of voxels in each spatial direction.
If None, uses <cite>self.rve.dim</cite>.</p>
</dd>
</dl>
</section>
<section id="id66">
<h4>Returns<a class="headerlink" href="#id66" title="Link to this heading"></a></h4>
<dl class="simple">
<dt>None</dt><dd><p>The voxelized mesh is stored in <cite>self.mesh</cite>. Phase voxel fractions are
stored in <cite>self.vf_vox</cite> and printed to the console.</p>
</dd>
</dl>
</section>
<section id="id67">
<h4>Raises<a class="headerlink" href="#id67" title="Link to this heading"></a></h4>
<dl class="simple">
<dt>ValueError</dt><dd><ul class="simple">
<li><p>If <cite>particles</cite> is None and <cite>self.particles</cite> is not available.</p></li>
<li><p>If <cite>dim</cite> is not a 3-tuple when specified.</p></li>
</ul>
</dd>
<dt>AttributeError</dt><dd><p>If <cite>self.rve</cite> or <cite>self.simbox</cite> is not initialized before voxelization.</p>
</dd>
</dl>
</section>
<section id="id68">
<h4>Notes<a class="headerlink" href="#id68" title="Link to this heading"></a></h4>
<ul class="simple">
<li><p>Requires <cite>self.particles</cite> to be initialized by <cite>pack()</cite>.</p></li>
<li><p>Updates <cite>self.mesh</cite>, <cite>self.ngrains</cite>, <cite>self.Ngr</cite>, and <cite>self.vf_vox</cite>.</p></li>
<li><p>Logs warnings if phase volume fractions do not sum to 1.</p></li>
<li><p>Removes polyhedral grain geometries (<cite>self.geometry</cite>) after re-meshing to avoid inconsistencies.</p></li>
</ul>
</section>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="kanapy.core.api.Microstructure.write_abq">
<span class="sig-name descname"><span class="pre">write_abq</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">nodes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">file</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">path</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'./'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">voxel_dict</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grain_dict</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dual_phase</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">thermal</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">units</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ialloy</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nsdv</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">200</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">crystal_plasticity</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">phase_props</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="keyword-only-separator o"><abbr title="Keyword-only parameters separator (PEP 3102)"><span class="pre">*</span></abbr></span></em>, <em class="sig-param"><span class="n"><span class="pre">boundary_conditions</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/kanapy/core/api.html#Microstructure.write_abq"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kanapy.core.api.Microstructure.write_abq" title="Link to this definition"></a></dt>
<dd><p>Write the Abaqus input deck (.inp) for the generated RVE</p>
<p>This method generates an Abaqus input file for the current RVE. It supports
voxelized or smoothened meshes, dual-phase materials, crystal plasticity,
thermal analysis, custom material properties, and optional boundary conditions.
Material definitions and mesh data are automatically handled based on provided
arguments or class attributes.</p>
<section id="id69">
<h4>Parameters<a class="headerlink" href="#id69" title="Link to this heading"></a></h4>
<dl class="simple">
<dt>nodes<span class="classifier">str or array-like, optional</span></dt><dd><p>Defines the mesh to write:
- ‘voxels’, ‘v’ : use voxelized mesh
- ‘smooth’, ‘s’ : use smoothened mesh
- array-like : explicit nodal coordinates
Default is None, automatically selecting available mesh.</p>
</dd>
<dt>file<span class="classifier">str, optional</span></dt><dd><p>Filename for the Abaqus input deck. Default is auto-generated.</p>
</dd>
<dt>path<span class="classifier">str, optional</span></dt><dd><p>Directory path to save the input deck. Default is ‘./’.</p>
</dd>
<dt>voxel_dict<span class="classifier">dict, optional</span></dt><dd><p>Dictionary with voxel information. Default is <cite>self.mesh.voxel_dict</cite>.</p>
</dd>
<dt>grain_dict<span class="classifier">dict, optional</span></dt><dd><p>Dictionary mapping grain IDs to nodes. Default is <cite>self.mesh.grain_dict</cite>.</p>
</dd>
<dt>dual_phase<span class="classifier">bool, optional</span></dt><dd><p>If True, generate input for dual-phase materials. Default is False.</p>
</dd>
<dt>thermal<span class="classifier">bool, optional</span></dt><dd><p>If True, include thermal material definitions. Default is False.</p>
</dd>
<dt>units<span class="classifier">str, optional</span></dt><dd><p>Units for the model, ‘mm’ or ‘um’. Default is <cite>self.rve.units</cite>.</p>
</dd>
<dt>ialloy<span class="classifier">list or object, optional</span></dt><dd><p>Material definitions for each phase. Default is <cite>self.rve.ialloy</cite>.</p>
</dd>
<dt>nsdv<span class="classifier">int, optional</span></dt><dd><p>Number of state variables per integration point for crystal plasticity. Default is 200.</p>
</dd>
<dt>crystal_plasticity<span class="classifier">bool, optional</span></dt><dd><p>If True, enable crystal plasticity material definitions. Default is False.</p>
</dd>
<dt>phase_props<span class="classifier">dict, optional</span></dt><dd><p>Additional phase-specific material properties.</p>
</dd>
<dt>boundary_conditions<span class="classifier">dict, optional</span></dt><dd><p>Dictionary specifying boundary conditions to write. Default is None.</p>
</dd>
</dl>
</section>
<section id="id70">
<h4>Returns<a class="headerlink" href="#id70" title="Link to this heading"></a></h4>
<dl class="simple">
<dt>file<span class="classifier">str</span></dt><dd><p>Full path to the generated Abaqus input file.</p>
</dd>
</dl>
</section>
<section id="id71">
<h4>Raises<a class="headerlink" href="#id71" title="Link to this heading"></a></h4>
<dl class="simple">
<dt>ValueError</dt><dd><ul class="simple">
<li><p>If no voxelized or smoothened mesh is available when required.</p></li>
<li><p>If invalid <cite>nodes</cite> argument is provided.</p></li>
<li><p>If units are not ‘mm’ or ‘um’.</p></li>
<li><p>If the list <cite>ialloy</cite> is longer than the number of phases in the RVE.</p></li>
<li><p>If periodic boundary conditions are requested but the RVE is non-periodic.</p></li>
</ul>
</dd>
</dl>
</section>
<section id="id72">
<h4>Notes<a class="headerlink" href="#id72" title="Link to this heading"></a></h4>
<ul class="simple">
<li><p>Automatically selects voxel or smoothened mesh if <cite>nodes</cite> is None.</p></li>
<li><p>Handles dual-phase structures and crystal plasticity input.</p></li>
<li><p>Writes additional material files if orientations are available and <cite>ialloy</cite> is provided.</p></li>
<li><p>Visualization or mesh generation must be performed before calling this function.</p></li>
</ul>
</section>
<section id="id73">
<h4>Examples<a class="headerlink" href="#id73" title="Link to this heading"></a></h4>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Write voxelized RVE input deck with default settings</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">abq_file</span> <span class="o">=</span> <span class="n">rve</span><span class="o">.</span><span class="n">write_abq</span><span class="p">(</span><span class="n">nodes</span><span class="o">=</span><span class="s1">&#39;voxels&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Write smoothened RVE deck for dual-phase material</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">abq_file</span> <span class="o">=</span> <span class="n">rve</span><span class="o">.</span><span class="n">write_abq</span><span class="p">(</span><span class="n">nodes</span><span class="o">=</span><span class="s1">&#39;smooth&#39;</span><span class="p">,</span> <span class="n">dual_phase</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">ialloy</span><span class="o">=</span><span class="n">alloy_list</span><span class="p">)</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Include boundary conditions</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bc</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;ux&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">],</span> <span class="s1">&#39;uy&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">]}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">abq_file</span> <span class="o">=</span> <span class="n">rve</span><span class="o">.</span><span class="n">write_abq</span><span class="p">(</span><span class="n">nodes</span><span class="o">=</span><span class="s1">&#39;voxels&#39;</span><span class="p">,</span> <span class="n">boundary_conditions</span><span class="o">=</span><span class="n">bc</span><span class="p">)</span>
</pre></div>
</div>
</section>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="kanapy.core.api.Microstructure.write_abq_ori">
<span class="sig-name descname"><span class="pre">write_abq_ori</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ialloy</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ori</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">file</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">path</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'./'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nsdv</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">200</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/kanapy/core/api.html#Microstructure.write_abq_ori"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kanapy.core.api.Microstructure.write_abq_ori" title="Link to this definition"></a></dt>
<dd><p>Write Abaqus material input file using grain orientations for crystal plasticity</p>
<p>This function generates an Abaqus <cite>.inp</cite> file containing material definitions
for crystal plasticity, using the provided grain orientations and material IDs.
If <cite>ialloy</cite> or <cite>ori</cite> are not specified, the method uses the RVE’s default values.</p>
<section id="id74">
<h4>Parameters<a class="headerlink" href="#id74" title="Link to this heading"></a></h4>
<dl class="simple">
<dt>ialloy<span class="classifier">list or object, optional</span></dt><dd><p>Material identifiers for each phase. Default is <cite>self.rve.ialloy</cite>.</p>
</dd>
<dt>ori<span class="classifier">dict or array-like, optional</span></dt><dd><p>Dictionary or array of grain orientations. Default is <cite>self.mesh.grain_ori_dict</cite>.</p>
</dd>
<dt>file<span class="classifier">str, optional</span></dt><dd><p>Name of the output Abaqus material file. Default is auto-generated based on RVE name.</p>
</dd>
<dt>path<span class="classifier">str, optional</span></dt><dd><p>Directory path where the file will be saved. Default is ‘./’.</p>
</dd>
<dt>nsdv<span class="classifier">int, optional</span></dt><dd><p>Number of state variables per integration point for crystal plasticity. Default is 200.</p>
</dd>
</dl>
</section>
<section id="id75">
<h4>Returns<a class="headerlink" href="#id75" title="Link to this heading"></a></h4>
<dl class="simple">
<dt>file<span class="classifier">str</span></dt><dd><p>Full path to the generated Abaqus material input file.</p>
</dd>
</dl>
</section>
<section id="id76">
<h4>Raises<a class="headerlink" href="#id76" title="Link to this heading"></a></h4>
<dl class="simple">
<dt>ValueError</dt><dd><ul class="simple">
<li><p>If <cite>ialloy</cite> is not provided and <cite>self.rve.ialloy</cite> is None.</p></li>
<li><p>If <cite>ori</cite> is not provided and <cite>self.mesh.grain_ori_dict</cite> is None.</p></li>
</ul>
</dd>
</dl>
</section>
<section id="id77">
<h4>Notes<a class="headerlink" href="#id77" title="Link to this heading"></a></h4>
<ul class="simple">
<li><p>Calls <cite>writeAbaqusMat</cite> internally to generate the material definitions.</p></li>
<li><p>Assumes the RVE and grain orientations have been initialized prior to calling.</p></li>
</ul>
</section>
<section id="id78">
<h4>Examples<a class="headerlink" href="#id78" title="Link to this heading"></a></h4>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Write material file using default RVE orientations and material numbers</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">abq_file</span> <span class="o">=</span> <span class="n">rve</span><span class="o">.</span><span class="n">write_abq_ori</span><span class="p">()</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Specify custom material IDs and orientations</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">abq_file</span> <span class="o">=</span> <span class="n">rve</span><span class="o">.</span><span class="n">write_abq_ori</span><span class="p">(</span><span class="n">ialloy</span><span class="o">=</span><span class="n">alloy_list</span><span class="p">,</span> <span class="n">ori</span><span class="o">=</span><span class="n">ori_dict</span><span class="p">,</span> <span class="n">file</span><span class="o">=</span><span class="s1">&#39;custom_mat.inp&#39;</span><span class="p">)</span>
</pre></div>
</div>
</section>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="kanapy.core.api.Microstructure.write_centers">
<span class="sig-name descname"><span class="pre">write_centers</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">file</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">path</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'./'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grains</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/kanapy/core/api.html#Microstructure.write_centers"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kanapy.core.api.Microstructure.write_centers" title="Link to this definition"></a></dt>
<dd><p>Write the center positions of grains to a CSV file</p>
<section id="id79">
<h4>Parameters<a class="headerlink" href="#id79" title="Link to this heading"></a></h4>
<dl class="simple">
<dt>file<span class="classifier">str, optional</span></dt><dd><p>Filename for the CSV file. Default is auto-generated based on <cite>self.name</cite>.</p>
</dd>
<dt>path<span class="classifier">str, optional</span></dt><dd><p>Directory path to save the CSV file. Default is ‘./’.</p>
</dd>
<dt>grains<span class="classifier">dict, optional</span></dt><dd><p>Dictionary of grain data. Default is <cite>self.geometry[‘Grains’]</cite>.</p>
</dd>
</dl>
</section>
<section id="id80">
<h4>Returns<a class="headerlink" href="#id80" title="Link to this heading"></a></h4>
<p>None</p>
</section>
<section id="id81">
<h4>Notes<a class="headerlink" href="#id81" title="Link to this heading"></a></h4>
<ul class="simple">
<li><p>Each line in the CSV file corresponds to a grain center in the format: x, y, z.</p></li>
<li><p>Polyhedral grains without simplices are skipped.</p></li>
</ul>
</section>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="kanapy.core.api.Microstructure.write_dataSchema">
<span class="sig-name descname"><span class="pre">write_dataSchema</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">user_metadata</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">boundary_condition</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">phases</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">interactive</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">structured</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ialloy</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">length_unit</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'µm'</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">dict</span></span></span><a class="reference internal" href="_modules/kanapy/core/api.html#Microstructure.write_dataSchema"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kanapy.core.api.Microstructure.write_dataSchema" title="Link to this definition"></a></dt>
<dd><p>Generate a JSON-compatible data schema containing user, system, and job-specific elements</p>
<p>This function builds a comprehensive data dictionary for a microstructure simulation,
including metadata, boundary conditions, phase information, voxel and grain data.
It supports interactive prompts for missing information, structured/unstructured meshes,
and unit scaling.</p>
<section id="id82">
<h4>Parameters<a class="headerlink" href="#id82" title="Link to this heading"></a></h4>
<dl class="simple">
<dt>user_metadata<span class="classifier">dict, optional</span></dt><dd><p>Prefilled metadata fields; required if interactive=False. Default is None.</p>
</dd>
<dt>boundary_condition<span class="classifier">dict, optional</span></dt><dd><p>Dictionary specifying mechanical or thermal boundary conditions. Default is None.</p>
</dd>
<dt>phases<span class="classifier">dict or list of dicts, optional</span></dt><dd><p>Phase-specific information; if None, default material library and ialloy are used.</p>
</dd>
<dt>interactive<span class="classifier">bool, optional</span></dt><dd><p>If True, prompt user for missing information. Default is True.</p>
</dd>
<dt>structured<span class="classifier">bool, optional</span></dt><dd><p>Whether the mesh is structured. Default is True.</p>
</dd>
<dt>ialloy<span class="classifier">int, optional</span></dt><dd><p>Alloy index for selecting material properties from the built-in library. Default is 1.</p>
</dd>
<dt>length_unit<span class="classifier">str, optional</span></dt><dd><p>Unit for length scaling; either ‘µm’ or ‘mm’. Default is ‘µm’.</p>
</dd>
</dl>
</section>
<section id="id83">
<h4>Returns<a class="headerlink" href="#id83" title="Link to this heading"></a></h4>
<dl class="simple">
<dt>dict</dt><dd><p>A nested dictionary containing the complete data schema for the simulation.</p>
</dd>
</dl>
</section>
<section id="id84">
<h4>Raises<a class="headerlink" href="#id84" title="Link to this heading"></a></h4>
<dl class="simple">
<dt>ValueError</dt><dd><p>If interactive=False and required metadata fields or boundary conditions are missing,
or if length_unit is invalid</p>
</dd>
<dt>TypeError</dt><dd><p>If <cite>phases</cite> is not a dict or a list of dicts when provided</p>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="kanapy.core.api.Microstructure.write_ori">
<span class="sig-name descname"><span class="pre">write_ori</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">angles</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">file</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">path</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'./'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/kanapy/core/api.html#Microstructure.write_ori"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kanapy.core.api.Microstructure.write_ori" title="Link to this definition"></a></dt>
<dd><p>Write grain orientations (Euler angles) to a CSV file</p>
<p>This method exports the orientations of grains in the microstructure. If no angles
are provided, the method uses the stored grain orientations from the mesh. The CSV
file contains one row per grain with three values representing the Euler angles
(phi1, Phi, phi2).</p>
<section id="id85">
<h4>Parameters<a class="headerlink" href="#id85" title="Link to this heading"></a></h4>
<dl class="simple">
<dt>angles<span class="classifier">array-like of shape (N, 3), optional</span></dt><dd><p>Euler angles for each grain. If None, the stored orientations are used.</p>
</dd>
<dt>file<span class="classifier">str, optional</span></dt><dd><p>Name of the output CSV file. If None, a default name based on the microstructure
name and number of grains is used.</p>
</dd>
<dt>path<span class="classifier">str, optional</span></dt><dd><p>Directory path where the CSV file will be saved. Default is ‘./’.</p>
</dd>
</dl>
</section>
<section id="id86">
<h4>Returns<a class="headerlink" href="#id86" title="Link to this heading"></a></h4>
<dl class="simple">
<dt>str</dt><dd><p>Full path to the generated CSV file.</p>
</dd>
</dl>
</section>
<section id="id87">
<h4>Raises<a class="headerlink" href="#id87" title="Link to this heading"></a></h4>
<dl class="simple">
<dt>ValueError</dt><dd><p>If <cite>angles</cite> is None and no grain orientations are stored in <cite>self.mesh.grain_ori_dict</cite>.</p>
</dd>
</dl>
</section>
<section id="id88">
<h4>Notes<a class="headerlink" href="#id88" title="Link to this heading"></a></h4>
<ul class="simple">
<li><p>Each row in the CSV corresponds to one grain.</p></li>
<li><p>Values are written in the order: phi1, Phi, phi2 (in radians).</p></li>
</ul>
</section>
<section id="id89">
<h4>Examples<a class="headerlink" href="#id89" title="Link to this heading"></a></h4>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Export stored orientations to default file</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rve</span><span class="o">.</span><span class="n">write_ori</span><span class="p">()</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Export provided orientations to a specific file</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rve</span><span class="o">.</span><span class="n">write_ori</span><span class="p">(</span><span class="n">angles</span><span class="o">=</span><span class="n">my_angles</span><span class="p">,</span> <span class="n">file</span><span class="o">=</span><span class="s1">&#39;grain_orientations.csv&#39;</span><span class="p">,</span> <span class="n">path</span><span class="o">=</span><span class="s1">&#39;./data&#39;</span><span class="p">)</span>
</pre></div>
</div>
</section>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="kanapy.core.api.Microstructure.write_stl">
<span class="sig-name descname"><span class="pre">write_stl</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'grains'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">file</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">path</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'./'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">phases</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">phase_num</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/kanapy/core/api.html#Microstructure.write_stl"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kanapy.core.api.Microstructure.write_stl" title="Link to this definition"></a></dt>
<dd><p>Export grains or particles as STL files representing convex polyhedra</p>
<p>This function writes STL files with triangular facets for grains or particles.
Each facet is written in standard STL ASCII format:</p>
<p><a href="#id90"><span class="problematic" id="id91">``</span></a>`
solid name</p>
<blockquote>
<div><dl>
<dt>facet normal n1 n2 n3</dt><dd><dl class="simple">
<dt>outer loop</dt><dd><p>vertex p1x p1y p1z
vertex p2x p2y p2z
vertex p3x p3y p3z</p>
</dd>
</dl>
<p>endloop</p>
</dd>
</dl>
<p>endfacet</p>
</div></blockquote>
<p>endsolid name
<a href="#id92"><span class="problematic" id="id93">``</span></a><a href="#id94"><span class="problematic" id="id95">`</span></a></p>
<section id="id96">
<h4>Parameters<a class="headerlink" href="#id96" title="Link to this heading"></a></h4>
<dl class="simple">
<dt>data<span class="classifier">{‘grains’, ‘particles’}, optional</span></dt><dd><p>Determines whether to export grains or particles. Default is ‘grains’.</p>
</dd>
<dt>file<span class="classifier">str, optional</span></dt><dd><p>Filename for the STL file. Default is generated from <cite>self.name</cite>.</p>
</dd>
<dt>path<span class="classifier">str, optional</span></dt><dd><p>Directory to save the STL file. Default is ‘./’.</p>
</dd>
<dt>phases<span class="classifier">bool, optional</span></dt><dd><p>If True, export only grains of a specific phase. Default is False.</p>
</dd>
<dt>phase_num<span class="classifier">int, optional</span></dt><dd><p>Phase number to export if <cite>phases=True</cite>. Required in that case.</p>
</dd>
</dl>
</section>
<section id="id97">
<h4>Returns<a class="headerlink" href="#id97" title="Link to this heading"></a></h4>
<p>None</p>
</section>
<section id="id98">
<h4>Raises<a class="headerlink" href="#id98" title="Link to this heading"></a></h4>
<dl class="simple">
<dt>ValueError</dt><dd><ul class="simple">
<li><p>If <cite>phases=True</cite> but <cite>phase_num</cite> is not provided.</p></li>
</ul>
</dd>
</dl>
</section>
<section id="id99">
<h4>Notes<a class="headerlink" href="#id99" title="Link to this heading"></a></h4>
<ul class="simple">
<li><p>Facet normals are automatically computed using cross products of vertices.</p></li>
<li><p>Acute or irregular facets trigger warnings.</p></li>
<li><p>For particle export, each particle must have a valid inner polyhedron.</p></li>
</ul>
</section>
<section id="id100">
<h4>Examples<a class="headerlink" href="#id100" title="Link to this heading"></a></h4>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Export all grains to STL</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rve</span><span class="o">.</span><span class="n">write_stl</span><span class="p">()</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Export particles to STL</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rve</span><span class="o">.</span><span class="n">write_stl</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="s1">&#39;particles&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Export only phase 1 grains</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rve</span><span class="o">.</span><span class="n">write_stl</span><span class="p">(</span><span class="n">phases</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">phase_num</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</section>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="kanapy.core.api.Microstructure.write_voxels">
<span class="sig-name descname"><span class="pre">write_voxels</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">angles</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">script_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">file</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">path</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'./'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mesh</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">source</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">system</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/kanapy/core/api.html#Microstructure.write_voxels"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kanapy.core.api.Microstructure.write_voxels" title="Link to this definition"></a></dt>
<dd><p>Write voxel structure of the microstructure to a JSON file</p>
<p>This function exports the voxel-based representation of the microstructure,
including grain numbers, optional orientations, and mesh data. Metadata such
as owner, system information, and script name are included.</p>
<section id="id101">
<h4>Parameters<a class="headerlink" href="#id101" title="Link to this heading"></a></h4>
<dl class="simple">
<dt>angles<span class="classifier">np.ndarray, optional</span></dt><dd><p>Array of Euler angles for grain orientations. If None, stored orientations
are used if available. Default is None.</p>
</dd>
<dt>script_name<span class="classifier">str, optional</span></dt><dd><p>Name of the script used to generate the microstructure. Default is the
current script file.</p>
</dd>
<dt>file<span class="classifier">str, optional</span></dt><dd><p>Name of the output JSON file. Default is based on microstructure name and
number of grains.</p>
</dd>
<dt>path<span class="classifier">str, optional</span></dt><dd><p>Directory path to save the JSON file. Default is current directory ‘./’.</p>
</dd>
<dt>mesh<span class="classifier">bool, optional</span></dt><dd><p>Whether to include mesh nodes and voxel connectivity in the output. Default
is True.</p>
</dd>
<dt>source<span class="classifier">Any, optional</span></dt><dd><p>Optional input or source information to include in the JSON metadata.</p>
</dd>
<dt>system<span class="classifier">bool, optional</span></dt><dd><p>Whether to include system information in the JSON metadata. Default is False.</p>
</dd>
</dl>
</section>
<section id="id102">
<h4>Returns<a class="headerlink" href="#id102" title="Link to this heading"></a></h4>
<dl class="simple">
<dt>None</dt><dd><p>The function writes a JSON file and does not return any value.</p>
</dd>
</dl>
</section>
</dd></dl>

</section>
</dd></dl>

</section>
<section id="module-kanapy.core.gui">
<span id="module-gui"></span><h2>Module GUI<a class="headerlink" href="#module-kanapy.core.gui" title="Link to this heading"></a></h2>
<p>A Graphical User Interface for create_rve.py, cuboid_grains.py and cpnvert_ang2rve.py
Created on May 2024
last Update Oct 2024
&#64;author: Ronak Shoghi, Alexander Hartmaier</p>
<dl class="py function">
<dt class="sig sig-object py" id="kanapy.core.gui.add_label_and_entry">
<span class="sig-prename descclassname"><span class="pre">kanapy.core.gui.</span></span><span class="sig-name descname"><span class="pre">add_label_and_entry</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">frame</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">row</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">label_text</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">entry_var</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">entry_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'entry'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bold</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">options</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">col</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/kanapy/core/gui.html#add_label_and_entry"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kanapy.core.gui.add_label_and_entry" title="Link to this definition"></a></dt>
<dd><p>Add a label and an input widget (entry, checkbox, or combobox) to a given frame</p>
<section id="id103">
<h3>Parameters<a class="headerlink" href="#id103" title="Link to this heading"></a></h3>
<dl class="simple">
<dt>frame<span class="classifier">tkinter.Frame</span></dt><dd><p>Parent frame where the widgets will be added</p>
</dd>
<dt>row<span class="classifier">int</span></dt><dd><p>Row index in the frame grid layout</p>
</dd>
<dt>label_text<span class="classifier">str or None</span></dt><dd><p>Text for the label; if None, no label is created</p>
</dd>
<dt>entry_var<span class="classifier">tkinter variable</span></dt><dd><p>Variable bound to the input widget (e.g., StringVar, BooleanVar)</p>
</dd>
<dt>entry_type<span class="classifier">str, optional</span></dt><dd><p>Type of input widget: “entry”, “checkbox”, or “combobox” (default is “entry”)</p>
</dd>
<dt>bold<span class="classifier">bool, optional</span></dt><dd><p>Whether to display the label text in bold (default is False)</p>
</dd>
<dt>options<span class="classifier">list, optional</span></dt><dd><p>List of selectable options when entry_type is “combobox”</p>
</dd>
<dt>col<span class="classifier">int, optional</span></dt><dd><p>Column index for placing the label and entry in the grid (default is 0)</p>
</dd>
</dl>
</section>
<section id="id104">
<h3>Returns<a class="headerlink" href="#id104" title="Link to this heading"></a></h3>
<dl class="simple">
<dt>None</dt><dd><p>The function adds widgets directly to the frame</p>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="kanapy.core.gui.cuboid_rve">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">kanapy.core.gui.</span></span><span class="sig-name descname"><span class="pre">cuboid_rve</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">app</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">notebook</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/kanapy/core/gui.html#cuboid_rve"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kanapy.core.gui.cuboid_rve" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Class for managing RVEs with cuboid grains and associated GUI controls</p>
<section id="id105">
<h3>Parameters<a class="headerlink" href="#id105" title="Link to this heading"></a></h3>
<dl class="simple">
<dt>app: tk.Tk or tk.Frame</dt><dd><p>Reference to the main Tkinter application instance</p>
</dd>
<dt>notebook: ttk.Notebook</dt><dd><p>Reference to the parent notebook widget for GUI tab placement</p>
</dd>
</dl>
</section>
<section id="id106">
<h3>Attributes<a class="headerlink" href="#id106" title="Link to this heading"></a></h3>
<dl class="simple">
<dt>app: tk.Tk or tk.Frame</dt><dd><p>Reference to the main Tkinter application instance</p>
</dd>
<dt>canvas: tk.Canvas</dt><dd><p>Canvas for displaying the cuboid RVE</p>
</dd>
<dt>ms: object</dt><dd><p>Placeholder for the microstructure object</p>
</dd>
<dt>texture_var2: tk.StringVar</dt><dd><p>Selected texture type (default “random”)</p>
</dd>
<dt>matname_var2: tk.StringVar</dt><dd><p>Material name (default “Simulanium”)</p>
</dd>
<dt>ialloy: tk.IntVar</dt><dd><p>Number of alloys (default 2)</p>
</dd>
<dt>ngr_var: tk.StringVar</dt><dd><p>Number of grains in each direction (default “5, 5, 5”)</p>
</dd>
<dt>nv_gr_var: tk.StringVar</dt><dd><p>Number of voxels per grain in each direction (default “3, 3, 3”)</p>
</dd>
<dt>size_var2: tk.StringVar</dt><dd><p>RVE size in each direction (default “45, 45, 45”)</p>
</dd>
<dt>kernel_var2: tk.StringVar</dt><dd><p>Kernel parameter for unimodal textures (default “-” or “7.5”)</p>
</dd>
<dt>euler_var2: tk.StringVar</dt><dd><p>Euler angles for unimodal textures (default “-” or “0.0, 45.0, 0.0”)</p>
</dd>
</dl>
</section>
<section id="id107">
<h3>Notes<a class="headerlink" href="#id107" title="Link to this heading"></a></h3>
<p>The class handles creation, visualization, and parameter management for cuboid RVEs.
GUI variable traces are used to automatically update dependent parameters such as
kernel and Euler angle values based on the selected texture type.</p>
<dl class="py method">
<dt class="sig sig-object py" id="kanapy.core.gui.cuboid_rve.close">
<span class="sig-name descname"><span class="pre">close</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/kanapy/core/gui.html#cuboid_rve.close"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kanapy.core.gui.cuboid_rve.close" title="Link to this definition"></a></dt>
<dd><p>Quit and destroy the cuboid_rve GUI main window</p>
<section id="id108">
<h4>Notes<a class="headerlink" href="#id108" title="Link to this heading"></a></h4>
<p>This method terminates the Tkinter application and closes the main window</p>
</section>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="kanapy.core.gui.cuboid_rve.create_cubes_and_plot">
<span class="sig-name descname"><span class="pre">create_cubes_and_plot</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/kanapy/core/gui.html#cuboid_rve.create_cubes_and_plot"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kanapy.core.gui.cuboid_rve.create_cubes_and_plot" title="Link to this definition"></a></dt>
<dd><p>Create a microstructure object with cuboid grains and plot the RVE</p>
<section id="id109">
<h4>Notes<a class="headerlink" href="#id109" title="Link to this heading"></a></h4>
<p>Parses GUI parameters for number of grains, voxels per grain, and RVE size
Initializes a Microstructure object and sets up the voxel mesh
Assigns each cuboid grain an index and populates grain dictionaries
Calls <cite>plot_voxels</cite> to generate the RVE figure and displays it on the GUI
Returns nothing; updates the GUI canvas with the plotted RVE</p>
</section>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="kanapy.core.gui.cuboid_rve.create_orientation">
<span class="sig-name descname"><span class="pre">create_orientation</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/kanapy/core/gui.html#cuboid_rve.create_orientation"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kanapy.core.gui.cuboid_rve.create_orientation" title="Link to this definition"></a></dt>
<dd><p>Create grain orientations for the cuboid RVE based on texture descriptors</p>
<section id="id110">
<h4>Notes<a class="headerlink" href="#id110" title="Link to this heading"></a></h4>
<p>Supports ‘unimodal’ textures with user-specified kernel and Euler angles
Automatically generates the cuboid RVE if <cite>ms</cite> or <cite>ms.mesh</cite> is not initialized
Calls <cite>generate_orientations</cite> to assign orientations to the microstructure
Writes voxel data to a JSON file and plots the voxelized RVE with orientations
Displays messages indicating progress and processing time</p>
</section>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="kanapy.core.gui.cuboid_rve.display_cuboid">
<span class="sig-name descname"><span class="pre">display_cuboid</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fig</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/kanapy/core/gui.html#cuboid_rve.display_cuboid"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kanapy.core.gui.cuboid_rve.display_cuboid" title="Link to this definition"></a></dt>
<dd><p>Display the cuboid RVE figure on the GUI canvas</p>
<section id="id111">
<h4>Parameters<a class="headerlink" href="#id111" title="Link to this heading"></a></h4>
<dl class="simple">
<dt>fig<span class="classifier">matplotlib.figure.Figure</span></dt><dd><p>The figure object representing the cuboid RVE to display</p>
</dd>
</dl>
</section>
<section id="id112">
<h4>Notes<a class="headerlink" href="#id112" title="Link to this heading"></a></h4>
<p>Destroys any existing canvas before displaying the new figure
Updates the Tkinter window geometry to fit the figure</p>
</section>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="kanapy.core.gui.cuboid_rve.export_abq">
<span class="sig-name descname"><span class="pre">export_abq</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/kanapy/core/gui.html#cuboid_rve.export_abq"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kanapy.core.gui.cuboid_rve.export_abq" title="Link to this definition"></a></dt>
<dd><p>Export the cuboid RVE mesh to an Abaqus input file</p>
<section id="id113">
<h4>Notes<a class="headerlink" href="#id113" title="Link to this heading"></a></h4>
<p>Automatically generates the cuboid RVE without orientations if <cite>ms</cite> is not initialized
Calls <cite>write_abq</cite> to export the mesh in millimeter units
Displays a progress message if RVE generation is required</p>
</section>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="kanapy.core.gui.cuboid_rve.update_euler_var">
<span class="sig-name descname"><span class="pre">update_euler_var</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/kanapy/core/gui.html#cuboid_rve.update_euler_var"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kanapy.core.gui.cuboid_rve.update_euler_var" title="Link to this definition"></a></dt>
<dd><p>Update the Euler angles variable based on the current texture selection</p>
<section id="id114">
<h4>Parameters<a class="headerlink" href="#id114" title="Link to this heading"></a></h4>
<dl class="simple">
<dt><a href="#id115"><span class="problematic" id="id116">*</span></a>args<span class="classifier">tuple</span></dt><dd><p>Optional arguments passed by the tkinter trace callback, not used directly</p>
</dd>
</dl>
</section>
<section id="id117">
<h4>Notes<a class="headerlink" href="#id117" title="Link to this heading"></a></h4>
<p>Sets <cite>euler_var2</cite> to “0.0, 45.0, 0.0” if <cite>texture_var2</cite> is ‘unimodal’, otherwise sets it to “-”</p>
</section>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="kanapy.core.gui.cuboid_rve.update_kernel_var">
<span class="sig-name descname"><span class="pre">update_kernel_var</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/kanapy/core/gui.html#cuboid_rve.update_kernel_var"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kanapy.core.gui.cuboid_rve.update_kernel_var" title="Link to this definition"></a></dt>
<dd><p>Update the kernel parameter variable based on the current texture selection</p>
<section id="id118">
<h4>Parameters<a class="headerlink" href="#id118" title="Link to this heading"></a></h4>
<dl class="simple">
<dt><a href="#id119"><span class="problematic" id="id120">*</span></a>args<span class="classifier">tuple</span></dt><dd><p>Optional arguments passed by the tkinter trace callback, not used directly</p>
</dd>
</dl>
</section>
<section id="id121">
<h4>Notes<a class="headerlink" href="#id121" title="Link to this heading"></a></h4>
<p>Sets <cite>kernel_var2</cite> to “7.5” if <cite>texture_var2</cite> is ‘unimodal’, otherwise sets it to “-”</p>
</section>
</dd></dl>

</section>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="kanapy.core.gui.parse_entry">
<span class="sig-prename descclassname"><span class="pre">kanapy.core.gui.</span></span><span class="sig-name descname"><span class="pre">parse_entry</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">entry</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/kanapy/core/gui.html#parse_entry"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kanapy.core.gui.parse_entry" title="Link to this definition"></a></dt>
<dd><p>Convert a comma-separated string into a list of integers</p>
<section id="id122">
<h3>Parameters<a class="headerlink" href="#id122" title="Link to this heading"></a></h3>
<dl class="simple">
<dt>entry<span class="classifier">str</span></dt><dd><p>String of comma-separated integer values</p>
</dd>
</dl>
</section>
<section id="id123">
<h3>Returns<a class="headerlink" href="#id123" title="Link to this heading"></a></h3>
<dl class="simple">
<dt>list of int</dt><dd><p>List of integers parsed from the input string</p>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="kanapy.core.gui.particle_rve">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">kanapy.core.gui.</span></span><span class="sig-name descname"><span class="pre">particle_rve</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">app</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">notebook</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/kanapy/core/gui.html#particle_rve"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kanapy.core.gui.particle_rve" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Class for generating Representative Volume Elements (RVEs) based on particle simulations
first tab</p>
<p>This class defines the GUI logic and default parameters for building RVEs using
particle-based microstructure simulations. It manages various parameters such as
particle size distribution, aspect ratio, texture settings, and periodic boundary conditions.</p>
<section id="id124">
<h3>Parameters<a class="headerlink" href="#id124" title="Link to this heading"></a></h3>
<dl class="simple">
<dt>app<span class="classifier">tkinter.Tk or tkinter.Frame</span></dt><dd><p>Reference to the main Tkinter application instance.</p>
</dd>
<dt>notebook<span class="classifier">ttk.Notebook</span></dt><dd><p>The notebook widget in which this tab (RVE setup) is placed.</p>
</dd>
</dl>
</section>
<section id="id125">
<h3>Attributes<a class="headerlink" href="#id125" title="Link to this heading"></a></h3>
<dl class="simple">
<dt>app<span class="classifier">tkinter.Tk or tkinter.Frame</span></dt><dd><p>Main application reference.</p>
</dd>
<dt>ms<span class="classifier">object or None</span></dt><dd><p>Placeholder for microstructure data.</p>
</dd>
<dt>ms_stats<span class="classifier">object or None</span></dt><dd><p>Placeholder for microstructure statistical data.</p>
</dd>
<dt>ebsd<span class="classifier">object or None</span></dt><dd><p>Placeholder for EBSD data (if used).</p>
</dd>
<dt>stats_canvas1<span class="classifier">tkinter.Canvas or None</span></dt><dd><p>Canvas for displaying statistical plots.</p>
</dd>
<dt>rve_canvas1<span class="classifier">tkinter.Canvas or None</span></dt><dd><p>Canvas for displaying the RVE visualization.</p>
</dd>
<dt>texture_var1<span class="classifier">tk.StringVar</span></dt><dd><p>Texture type, default “random”.</p>
</dd>
<dt>matname_var1<span class="classifier">tk.StringVar</span></dt><dd><p>Material name, default “Simulanium”.</p>
</dd>
<dt>nphases<span class="classifier">tk.IntVar</span></dt><dd><p>Number of material phases, default 1.</p>
</dd>
<dt>ialloy<span class="classifier">tk.IntVar</span></dt><dd><p>Alloy type indicator, default 2.</p>
</dd>
<dt>nvox_var1<span class="classifier">tk.IntVar</span></dt><dd><p>Number of voxels per dimension in the RVE, default 30.</p>
</dd>
<dt>size_var1<span class="classifier">tk.IntVar</span></dt><dd><p>Physical size of the RVE, default 30.</p>
</dd>
<dt>periodic_var1<span class="classifier">tk.BooleanVar</span></dt><dd><p>Whether to apply periodic boundary conditions, default True.</p>
</dd>
<dt>volume_fraction<span class="classifier">tk.DoubleVar</span></dt><dd><p>Target total volume fraction, default 1.0.</p>
</dd>
<dt>vf_act<span class="classifier">tk.DoubleVar</span></dt><dd><p>Actual volume fraction, initialized to 0.0.</p>
</dd>
<dt>eq_diameter_sig<span class="classifier">tk.DoubleVar</span></dt><dd><p>Standard deviation of equivalent diameter distribution.</p>
</dd>
<dt>eq_diameter_scale<span class="classifier">tk.DoubleVar</span></dt><dd><p>Scale parameter for equivalent diameter distribution.</p>
</dd>
<dt>eq_diameter_loc<span class="classifier">tk.DoubleVar</span></dt><dd><p>Location parameter for equivalent diameter distribution.</p>
</dd>
<dt>eq_diameter_min<span class="classifier">tk.DoubleVar</span></dt><dd><p>Minimum equivalent diameter.</p>
</dd>
<dt>eq_diameter_max<span class="classifier">tk.DoubleVar</span></dt><dd><p>Maximum equivalent diameter.</p>
</dd>
<dt>eqd_act_sig<span class="classifier">tk.DoubleVar</span></dt><dd><p>Active (fitted or adjusted) standard deviation for equivalent diameter.</p>
</dd>
<dt>eqd_act_scale<span class="classifier">tk.DoubleVar</span></dt><dd><p>Active scale for equivalent diameter.</p>
</dd>
<dt>eqd_act_loc<span class="classifier">tk.DoubleVar</span></dt><dd><p>Active location for equivalent diameter.</p>
</dd>
<dt>aspect_ratio_sig<span class="classifier">tk.DoubleVar</span></dt><dd><p>Standard deviation for aspect ratio distribution.</p>
</dd>
<dt>aspect_ratio_scale<span class="classifier">tk.DoubleVar</span></dt><dd><p>Scale parameter for aspect ratio distribution.</p>
</dd>
<dt>aspect_ratio_loc<span class="classifier">tk.DoubleVar</span></dt><dd><p>Location parameter for aspect ratio distribution.</p>
</dd>
<dt>aspect_ratio_min<span class="classifier">tk.DoubleVar</span></dt><dd><p>Minimum aspect ratio.</p>
</dd>
<dt>aspect_ratio_max<span class="classifier">tk.DoubleVar</span></dt><dd><p>Maximum aspect ratio.</p>
</dd>
<dt>ar_act_sig<span class="classifier">tk.DoubleVar</span></dt><dd><p>Active standard deviation for aspect ratio.</p>
</dd>
<dt>ar_act_scale<span class="classifier">tk.DoubleVar</span></dt><dd><p>Active scale for aspect ratio.</p>
</dd>
<dt>ar_act_loc<span class="classifier">tk.DoubleVar</span></dt><dd><p>Active location for aspect ratio.</p>
</dd>
<dt>tilt_angle_kappa<span class="classifier">tk.DoubleVar</span></dt><dd><p>Concentration parameter for tilt angle distribution.</p>
</dd>
<dt>tilt_angle_loc<span class="classifier">tk.DoubleVar</span></dt><dd><p>Mean (location) of tilt angle distribution in radians.</p>
</dd>
<dt>tilt_angle_min<span class="classifier">tk.DoubleVar</span></dt><dd><p>Minimum tilt angle (0.0).</p>
</dd>
<dt>tilt_angle_max<span class="classifier">tk.DoubleVar</span></dt><dd><p>Maximum tilt angle (π).</p>
</dd>
<dt>kernel_var1<span class="classifier">tk.StringVar</span></dt><dd><p>Orientation kernel width; depends on texture setting.</p>
</dd>
<dt>euler_var1<span class="classifier">tk.StringVar</span></dt><dd><p>Euler angles defining the texture orientation; depends on texture setting.</p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="kanapy.core.gui.particle_rve.close">
<span class="sig-name descname"><span class="pre">close</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/kanapy/core/gui.html#particle_rve.close"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kanapy.core.gui.particle_rve.close" title="Link to this definition"></a></dt>
<dd><p>Quit and destroy the particle_rve GUI main window</p>
<section id="id126">
<h4>Notes<a class="headerlink" href="#id126" title="Link to this heading"></a></h4>
<p>This method quits the Tkinter application and destroys the main window</p>
</section>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="kanapy.core.gui.particle_rve.create_and_plot_rve">
<span class="sig-name descname"><span class="pre">create_and_plot_rve</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/kanapy/core/gui.html#particle_rve.create_and_plot_rve"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kanapy.core.gui.particle_rve.create_and_plot_rve" title="Link to this definition"></a></dt>
<dd><p>Create the RVE from current statistics and plot it along with associated statistics</p>
<section id="id127">
<h4>Notes<a class="headerlink" href="#id127" title="Link to this heading"></a></h4>
<p>Will overwrite existing <cite>ms_stats</cite> and <cite>ms</cite> objects
Displays a progress message and measures processing time
Initializes <cite>self.ms</cite> with the selected material and voxelizes the RVE
Plots the voxelized RVE using <cite>plot_voxels</cite> and displays it on the GUI
Updates activity-related variables based on voxelized statistics
Also plots statistics figures returned from <cite>plot_stats_init</cite></p>
</section>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="kanapy.core.gui.particle_rve.create_and_plot_stats">
<span class="sig-name descname"><span class="pre">create_and_plot_stats</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/kanapy/core/gui.html#particle_rve.create_and_plot_stats"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kanapy.core.gui.particle_rve.create_and_plot_stats" title="Link to this definition"></a></dt>
<dd><p>Plot statistics of the current microstructure descriptors and initialize a new Microstructure object</p>
<section id="id128">
<h4>Notes<a class="headerlink" href="#id128" title="Link to this heading"></a></h4>
<p>Will erase the global microstructure object <cite>self.ms</cite> if it exists
Reads current statistics using <cite>readout_stats</cite>
Initializes <cite>self.ms</cite> with the selected material and texture
Plots statistics using <cite>plot_stats_init</cite> and displays each figure on the GUI
Resets activity-related variables after plotting</p>
</section>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="kanapy.core.gui.particle_rve.create_orientation">
<span class="sig-name descname"><span class="pre">create_orientation</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/kanapy/core/gui.html#particle_rve.create_orientation"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kanapy.core.gui.particle_rve.create_orientation" title="Link to this definition"></a></dt>
<dd><p>Generate grain orientations based on the selected texture and assign them to the RVE</p>
<section id="id129">
<h4>Notes<a class="headerlink" href="#id129" title="Link to this heading"></a></h4>
<p>Supports ‘unimodal’ textures with user-specified kernel and Euler angles, or ‘EBSD-ODF’ textures
Automatically generates the RVE if <cite>ms_stats</cite> or <cite>ms</cite> objects are not initialized
Calls <cite>generate_orientations</cite> to assign orientations to the microstructure
Writes voxel data to a JSON file and plots the voxelized RVE with orientations
Displays messages indicating progress and processing time</p>
</section>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="kanapy.core.gui.particle_rve.display_plot">
<span class="sig-name descname"><span class="pre">display_plot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fig</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot_type</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/kanapy/core/gui.html#particle_rve.display_plot"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kanapy.core.gui.particle_rve.display_plot" title="Link to this definition"></a></dt>
<dd><p>Show a statistics graph or RVE plot on the GUI canvas</p>
<section id="id130">
<h4>Parameters<a class="headerlink" href="#id130" title="Link to this heading"></a></h4>
<dl class="simple">
<dt>fig<span class="classifier">matplotlib.figure.Figure</span></dt><dd><p>The figure object to be displayed</p>
</dd>
<dt>plot_type<span class="classifier">str</span></dt><dd><p>Type of plot to display, either ‘stats’ for statistics graph or ‘rve’ for RVE plot</p>
</dd>
</dl>
</section>
<section id="id131">
<h4>Notes<a class="headerlink" href="#id131" title="Link to this heading"></a></h4>
<p>Existing canvas for the specified plot type will be destroyed before displaying the new figure
The GUI window size is updated to fit the new plot</p>
</section>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="kanapy.core.gui.particle_rve.export_abq">
<span class="sig-name descname"><span class="pre">export_abq</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/kanapy/core/gui.html#particle_rve.export_abq"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kanapy.core.gui.particle_rve.export_abq" title="Link to this definition"></a></dt>
<dd><p>Export the RVE mesh to an Abaqus input file</p>
<section id="id132">
<h4>Notes<a class="headerlink" href="#id132" title="Link to this heading"></a></h4>
<p>If <cite>ms_stats</cite>, <cite>ms</cite>, or <cite>ms.mesh</cite> is not initialized, the RVE is first generated without orientations
Checks if the material is dual-phase based on volume fraction
Calls <cite>write_abq</cite> to export the mesh in millimeter units
Displays a progress message if RVE generation is required</p>
</section>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="kanapy.core.gui.particle_rve.extract_microstructure_params">
<span class="sig-name descname"><span class="pre">extract_microstructure_params</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/kanapy/core/gui.html#particle_rve.extract_microstructure_params"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kanapy.core.gui.particle_rve.extract_microstructure_params" title="Link to this definition"></a></dt>
<dd><p>Extract microstructure parameters from the EBSD data and update GUI variables</p>
<section id="id133">
<h4>Notes<a class="headerlink" href="#id133" title="Link to this heading"></a></h4>
<p>If <cite>self.ebsd</cite> is None, the method does nothing
Extracts grain size, aspect ratio, and orientation parameters from the first EBSD dataset
Updates GUI variables for material name, volume fraction, equivalent diameter, aspect ratio,
tilt angle, and texture type
Computed min and max cutoff values are based on statistical scaling of the extracted parameters</p>
</section>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="kanapy.core.gui.particle_rve.import_ebsd">
<span class="sig-name descname"><span class="pre">import_ebsd</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/kanapy/core/gui.html#particle_rve.import_ebsd"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kanapy.core.gui.particle_rve.import_ebsd" title="Link to this definition"></a></dt>
<dd><p>Import an EBSD map and extract microstructure parameters</p>
<section id="id134">
<h4>Notes<a class="headerlink" href="#id134" title="Link to this heading"></a></h4>
<p>Opens a file dialog to select an EBSD map with extensions ‘.ctf’ or ‘.ang’
Displays messages indicating progress and success or failure
Calls <cite>extract_microstructure_params</cite> and <cite>reset_act</cite> after successful import</p>
</section>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="kanapy.core.gui.particle_rve.import_stats">
<span class="sig-name descname"><span class="pre">import_stats</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/kanapy/core/gui.html#particle_rve.import_stats"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kanapy.core.gui.particle_rve.import_stats" title="Link to this definition"></a></dt>
<dd><p>Import statistical data from a JSON file and update GUI variables</p>
<section id="id135">
<h4>Notes<a class="headerlink" href="#id135" title="Link to this heading"></a></h4>
<p>Opens a file dialog to select a statistics file with ‘.json’ extension
Updates GUI variables for material name, RVE size, voxel counts, periodicity, volume fraction,
equivalent diameter, aspect ratio, and tilt angle based on imported data
Calls <cite>reset_act</cite> and clears <cite>ebsd</cite> after successful import
Displays a message indicating success or failure</p>
</section>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="kanapy.core.gui.particle_rve.readout_stats">
<span class="sig-name descname"><span class="pre">readout_stats</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/kanapy/core/gui.html#particle_rve.readout_stats"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kanapy.core.gui.particle_rve.readout_stats" title="Link to this definition"></a></dt>
<dd><p>Collect and return the current microstructure and RVE statistics</p>
<section id="id136">
<h4>Returns<a class="headerlink" href="#id136" title="Link to this heading"></a></h4>
<dl class="simple">
<dt>dict</dt><dd><p>A dictionary containing:
- ‘Grain type’: Type of grain
- ‘Equivalent diameter’: Distribution parameters (sig, scale, loc, cutoff_min, cutoff_max)
- ‘Aspect ratio’: Distribution parameters (sig, scale, loc, cutoff_min, cutoff_max)
- ‘Tilt angle’: Orientation parameters (kappa, loc, cutoff_min, cutoff_max)
- ‘RVE’: RVE size and voxel counts
- ‘Simulation’: Simulation settings including periodicity and output units
- ‘Phase’: Material phase information including name, number, and volume fraction</p>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="kanapy.core.gui.particle_rve.reset_act">
<span class="sig-name descname"><span class="pre">reset_act</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/kanapy/core/gui.html#particle_rve.reset_act"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kanapy.core.gui.particle_rve.reset_act" title="Link to this definition"></a></dt>
<dd><p>Reset all activity-related variables to zero</p>
<section id="id137">
<h4>Notes<a class="headerlink" href="#id137" title="Link to this heading"></a></h4>
<p>Sets <cite>vf_act</cite>, <cite>eqd_act_sig</cite>, <cite>eqd_act_scale</cite>, <cite>ar_act_sig</cite>, and <cite>ar_act_scale</cite> to 0.0</p>
</section>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="kanapy.core.gui.particle_rve.update_euler_var">
<span class="sig-name descname"><span class="pre">update_euler_var</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/kanapy/core/gui.html#particle_rve.update_euler_var"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kanapy.core.gui.particle_rve.update_euler_var" title="Link to this definition"></a></dt>
<dd><p>Update the Euler angles variable based on the current texture selection</p>
<section id="id138">
<h4>Parameters<a class="headerlink" href="#id138" title="Link to this heading"></a></h4>
<dl class="simple">
<dt><a href="#id139"><span class="problematic" id="id140">*</span></a>args<span class="classifier">tuple</span></dt><dd><p>Optional arguments passed by the tkinter trace callback, not used directly</p>
</dd>
</dl>
</section>
<section id="id141">
<h4>Notes<a class="headerlink" href="#id141" title="Link to this heading"></a></h4>
<p>If <cite>self.texture_var1</cite> is ‘unimodal’, <cite>self.euler_var1</cite> is set to “0.0, 45.0, 0.0”
Otherwise, <cite>self.euler_var1</cite> is set to “-”</p>
</section>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="kanapy.core.gui.particle_rve.update_kernel_var">
<span class="sig-name descname"><span class="pre">update_kernel_var</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/kanapy/core/gui.html#particle_rve.update_kernel_var"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kanapy.core.gui.particle_rve.update_kernel_var" title="Link to this definition"></a></dt>
<dd><p>Update the kernel variable based on the current texture selection</p>
<section id="id142">
<h4>Parameters<a class="headerlink" href="#id142" title="Link to this heading"></a></h4>
<dl class="simple">
<dt><a href="#id143"><span class="problematic" id="id144">*</span></a>args<span class="classifier">tuple</span></dt><dd><p>Optional arguments passed by the tkinter trace callback, not used directly</p>
</dd>
</dl>
</section>
<section id="id145">
<h4>Notes<a class="headerlink" href="#id145" title="Link to this heading"></a></h4>
<p>If <cite>self.texture_var1</cite> is ‘unimodal’, <cite>self.kernel_var1</cite> is set to “7.5”
Otherwise, <cite>self.kernel_var1</cite> is set to “-”</p>
</section>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="kanapy.core.gui.particle_rve.write_stat_param">
<span class="sig-name descname"><span class="pre">write_stat_param</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/kanapy/core/gui.html#particle_rve.write_stat_param"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kanapy.core.gui.particle_rve.write_stat_param" title="Link to this definition"></a></dt>
<dd><p>Save the current microstructure statistics to a file</p>
<section id="id146">
<h4>Notes<a class="headerlink" href="#id146" title="Link to this heading"></a></h4>
<p>If <cite>self.ms_stats</cite> is None, a message is shown indicating no stats are available
Opens a file dialog to select the save location
Calls <cite>write_stats</cite> to write the statistics to the selected file</p>
</section>
</dd></dl>

</section>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="kanapy.core.gui.self_closing_message">
<span class="sig-prename descclassname"><span class="pre">kanapy.core.gui.</span></span><span class="sig-name descname"><span class="pre">self_closing_message</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">message</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">duration</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">4000</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/kanapy/core/gui.html#self_closing_message"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kanapy.core.gui.self_closing_message" title="Link to this definition"></a></dt>
<dd><p>Display a temporary popup message box that closes automatically after a given duration</p>
<section id="id147">
<h3>Parameters<a class="headerlink" href="#id147" title="Link to this heading"></a></h3>
<dl class="simple">
<dt>message<span class="classifier">str</span></dt><dd><p>The message text to display in the popup window</p>
</dd>
<dt>duration<span class="classifier">int, optional</span></dt><dd><p>Time in milliseconds before the message box closes automatically (default is 4000)</p>
</dd>
</dl>
</section>
<section id="id148">
<h3>Returns<a class="headerlink" href="#id148" title="Link to this heading"></a></h3>
<dl class="simple">
<dt>None</dt><dd><p>The function creates and destroys a popup window; no value is returned</p>
</dd>
</dl>
</section>
</dd></dl>

</section>
<section id="module-kanapy.core.cli">
<span id="module-cli"></span><h2>Module CLI<a class="headerlink" href="#module-kanapy.core.cli" title="Link to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="kanapy.core.cli.chkVersion">
<span class="sig-prename descclassname"><span class="pre">kanapy.core.cli.</span></span><span class="sig-name descname"><span class="pre">chkVersion</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">matlab</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/kanapy/core/cli.html#chkVersion"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kanapy.core.cli.chkVersion" title="Link to this definition"></a></dt>
<dd><p>Read the installed MATLAB version from a version string</p>
<p>Parses the given MATLAB version string to extract the release year
(e.g., ‘R2023a’ → 2023). If the version cannot be determined, returns None.</p>
<section id="id149">
<h3>Parameters<a class="headerlink" href="#id149" title="Link to this heading"></a></h3>
<dl class="simple">
<dt>matlab<span class="classifier">str</span></dt><dd><p>String containing MATLAB version information</p>
</dd>
</dl>
</section>
<section id="id150">
<h3>Returns<a class="headerlink" href="#id150" title="Link to this heading"></a></h3>
<dl class="simple">
<dt>int or None</dt><dd><p>MATLAB release year if successfully parsed, otherwise None</p>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="kanapy.core.cli.setPaths">
<span class="sig-prename descclassname"><span class="pre">kanapy.core.cli.</span></span><span class="sig-name descname"><span class="pre">setPaths</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/kanapy/core/cli.html#setPaths"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kanapy.core.cli.setPaths" title="Link to this definition"></a></dt>
<dd><p>Start the MATLAB engine and initialize the MTEX environment</p>
<p>Checks if the MATLAB engine for Python is installed and installs it if missing.
Then initializes the MATLAB engine and MTEX toolbox for use with Kanapy.</p>
<section id="id151">
<h3>Raises<a class="headerlink" href="#id151" title="Link to this heading"></a></h3>
<dl class="simple">
<dt>ModuleNotFoundError</dt><dd><p>If <cite>kanapy-mtex</cite> or MATLAB are not installed,
or if the MATLAB engine installation fails</p>
</dd>
</dl>
</section>
<section id="id152">
<h3>Notes<a class="headerlink" href="#id152" title="Link to this heading"></a></h3>
<ul class="simple">
<li><p>Requires MATLAB 2025a or later</p></li>
<li><p>Automatically installs the <cite>matlabengine</cite> package if not found</p></li>
<li><p>Configures Kanapy for texture analysis by running <cite>init_engine.py</cite></p></li>
</ul>
</section>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="kanapy.core.cli.start">
<span class="sig-prename descclassname"><span class="pre">kanapy.core.cli.</span></span><span class="sig-name descname"><span class="pre">start</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/kanapy/core/cli.html#start"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kanapy.core.cli.start" title="Link to this definition"></a></dt>
<dd></dd></dl>

</section>
<section id="module-kanapy.core.initializations">
<span id="module-initialization"></span><h2>Module initialization<a class="headerlink" href="#module-kanapy.core.initializations" title="Link to this heading"></a></h2>
<p>Classes for RVE and mesh initialization</p>
<p>Authors: Mahesh Prassad, Abhishek Biswas, Alexander Hartmaier
Ruhr University Bochum, Germany</p>
<p>March 2024</p>
<dl class="py class">
<dt class="sig sig-object py" id="kanapy.core.initializations.NodeSets">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">kanapy.core.initializations.</span></span><span class="sig-name descname"><span class="pre">NodeSets</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">nodes</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/kanapy/core/initializations.html#NodeSets"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kanapy.core.initializations.NodeSets" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Identify nodes on faces of a cuboidal mesh and store them in face-specific sets</p>
<section id="id153">
<h3>Parameters<a class="headerlink" href="#id153" title="Link to this heading"></a></h3>
<dl class="simple">
<dt>nodes<span class="classifier">ndarray</span></dt><dd><p>Array of nodal coordinates of shape (n_nodes, 3)</p>
</dd>
</dl>
</section>
<section id="id154">
<h3>Attributes<a class="headerlink" href="#id154" title="Link to this heading"></a></h3>
<dl class="simple">
<dt>F0yz, F0yz_full<span class="classifier">list of int</span></dt><dd><p>Nodes on left face</p>
</dd>
<dt>F1yz, F1yz_full<span class="classifier">list of int</span></dt><dd><p>Nodes on right face</p>
</dd>
<dt>Fx0z, Fx0z_full<span class="classifier">list of int</span></dt><dd><p>Nodes on bottom face</p>
</dd>
<dt>Fx1z, Fx1z_full<span class="classifier">list of int</span></dt><dd><p>Nodes on top face</p>
</dd>
<dt>Fxy0, Fxy0_full<span class="classifier">list of int</span></dt><dd><p>Nodes on rear face</p>
</dd>
<dt>Fxy1, Fxy1_full<span class="classifier">list of int</span></dt><dd><p>Nodes on front face</p>
</dd>
<dt>surfSet<span class="classifier">list of int</span></dt><dd><p>All nodes on any face</p>
</dd>
</dl>
</section>
<section id="id155">
<h3>Notes<a class="headerlink" href="#id155" title="Link to this heading"></a></h3>
<ul class="simple">
<li><p>Uses np.isclose to identify nodes lying on the boundaries</p></li>
<li><p>Each <a href="#id156"><span class="problematic" id="id157">*</span></a>_full list keeps a copy of the original face node indices</p></li>
<li><p>surfSet includes all nodes belonging to any face</p></li>
</ul>
<dl class="py method">
<dt class="sig sig-object py" id="kanapy.core.initializations.NodeSets.CreatePeriodicEdgeSets">
<span class="sig-name descname"><span class="pre">CreatePeriodicEdgeSets</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Nodes</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sortCoord</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">NodeSet</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/kanapy/core/initializations.html#NodeSets.CreatePeriodicEdgeSets"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kanapy.core.initializations.NodeSets.CreatePeriodicEdgeSets" title="Link to this definition"></a></dt>
<dd><p>Create a sorted list of nodes along an edge to facilitate periodic boundary conditions</p>
<section id="id158">
<h4>Parameters<a class="headerlink" href="#id158" title="Link to this heading"></a></h4>
<dl class="simple">
<dt>Nodes<span class="classifier">list of int</span></dt><dd><p>List of all node indices in the mesh</p>
</dd>
<dt>sortCoord<span class="classifier">list or ndarray</span></dt><dd><p>Coordinates of nodes along the sorting direction</p>
</dd>
<dt>NodeSet<span class="classifier">list of int</span></dt><dd><p>Node indices on the edge to be sorted</p>
</dd>
</dl>
</section>
<section id="id159">
<h4>Returns<a class="headerlink" href="#id159" title="Link to this heading"></a></h4>
<dl class="simple">
<dt>sortedList<span class="classifier">list of int</span></dt><dd><p>Node indices sorted according to sortCoord</p>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="kanapy.core.initializations.NodeSets.CreatePeriodicNodeSets">
<span class="sig-name descname"><span class="pre">CreatePeriodicNodeSets</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Nodes</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sortCoord1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sortCoord2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">NodeSet</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/kanapy/core/initializations.html#NodeSets.CreatePeriodicNodeSets"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kanapy.core.initializations.NodeSets.CreatePeriodicNodeSets" title="Link to this definition"></a></dt>
<dd><p>Create a sorted list of nodes for a surface to facilitate periodic boundary conditions</p>
<section id="id160">
<h4>Parameters<a class="headerlink" href="#id160" title="Link to this heading"></a></h4>
<dl class="simple">
<dt>Nodes<span class="classifier">list of int</span></dt><dd><p>List of all node indices in the mesh</p>
</dd>
<dt>sortCoord1<span class="classifier">list or ndarray</span></dt><dd><p>Coordinates of nodes along the first sorting direction</p>
</dd>
<dt>sortCoord2<span class="classifier">list or ndarray</span></dt><dd><p>Coordinates of nodes along the second sorting direction</p>
</dd>
<dt>NodeSet<span class="classifier">list of int</span></dt><dd><p>Node indices on a surface to be sorted</p>
</dd>
</dl>
</section>
<section id="id161">
<h4>Returns<a class="headerlink" href="#id161" title="Link to this heading"></a></h4>
<dl class="simple">
<dt>sortedList<span class="classifier">list of int</span></dt><dd><p>Node indices sorted according to sortCoord1 and sortCoord2</p>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="kanapy.core.initializations.NodeSets.RemoveItemInList">
<span class="sig-name descname"><span class="pre">RemoveItemInList</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">NodeList</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ReplaceNodeList</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/kanapy/core/initializations.html#NodeSets.RemoveItemInList"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kanapy.core.initializations.NodeSets.RemoveItemInList" title="Link to this definition"></a></dt>
<dd><p>Remove a set of nodes from a list of nodes</p>
<section id="id162">
<h4>Parameters<a class="headerlink" href="#id162" title="Link to this heading"></a></h4>
<dl class="simple">
<dt>NodeList<span class="classifier">list of int</span></dt><dd><p>Original list of node indices</p>
</dd>
<dt>ReplaceNodeList<span class="classifier">list of int</span></dt><dd><p>Node indices to be removed from NodeList</p>
</dd>
</dl>
</section>
<section id="id163">
<h4>Returns<a class="headerlink" href="#id163" title="Link to this heading"></a></h4>
<dl class="simple">
<dt>NodeList<span class="classifier">list of int</span></dt><dd><p>Updated list after removing the specified nodes</p>
</dd>
</dl>
</section>
</dd></dl>

</section>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="kanapy.core.initializations.RVE_creator">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">kanapy.core.initializations.</span></span><span class="sig-name descname"><span class="pre">RVE_creator</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">stats_dicts</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nsteps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">from_voxels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">poly</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/kanapy/core/initializations.html#RVE_creator"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kanapy.core.initializations.RVE_creator" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Creates an RVE based on user-defined statistics</p>
<p>Generates ellipsoid size distribution (Log-normal) based on user-defined statistics.
Particle, RVE and simulation data are written as JSON files in a folder in the current working
directory for later access.</p>
<section id="id164">
<h3>Parameters<a class="headerlink" href="#id164" title="Link to this heading"></a></h3>
<dl class="simple">
<dt>stats_dicts<span class="classifier">list of dict</span></dt><dd><p>List of dictionaries containing microstructure descriptors for each phase</p>
</dd>
<dt>nsteps<span class="classifier">int, optional</span></dt><dd><p>Maximum number of steps for packing simulation (default is 1000)</p>
</dd>
<dt>from_voxels<span class="classifier">bool, optional</span></dt><dd><p>If True, RVE is created from voxel input (default is False)</p>
</dd>
<dt>poly<span class="classifier">object, optional</span></dt><dd><p>Optional polygon object for particle generation</p>
</dd>
</dl>
</section>
<section id="id165">
<h3>Attributes<a class="headerlink" href="#id165" title="Link to this heading"></a></h3>
<dl class="simple">
<dt>packing_steps<span class="classifier">int</span></dt><dd><p>Max number of steps for packing simulation</p>
</dd>
<dt>size<span class="classifier">tuple of float</span></dt><dd><p>Side lengths of the RVE along Cartesian axes</p>
</dd>
<dt>dim<span class="classifier">tuple of int</span></dt><dd><p>Number of voxels along Cartesian axes</p>
</dd>
<dt>periodic<span class="classifier">bool</span></dt><dd><p>Whether the RVE is periodic</p>
</dd>
<dt>units<span class="classifier">str</span></dt><dd><p>Units of RVE dimensions, either “mm” or “um”</p>
</dd>
<dt>nparticles<span class="classifier">list of int</span></dt><dd><p>Number of particles for each phase</p>
</dd>
<dt>particle_data<span class="classifier">list of dict</span></dt><dd><p>Statistical particle data for each phase</p>
</dd>
<dt>phase_names<span class="classifier">list of str</span></dt><dd><p>Names of phases</p>
</dd>
<dt>phase_vf<span class="classifier">list of float</span></dt><dd><p>Volume fractions of each phase</p>
</dd>
<dt>ialloy<span class="classifier">list of int</span></dt><dd><p>Alloy numbers for ICAMS CP-UMAT</p>
</dd>
</dl>
</section>
<section id="id166">
<h3>Notes<a class="headerlink" href="#id166" title="Link to this heading"></a></h3>
<ol class="arabic simple">
<li><p>Input parameters provided by the user in the input file are:
- Standard deviation for ellipsoid equivalent diameter (Log-normal or Normal distribution)
- Mean value of ellipsoid equivalent diameter (Log-normal or Normal distribution)
- Minimum and Maximum cut-offs for ellipsoid equivalent diameters
- Mean value for aspect ratio
- Mean value for ellipsoid tilt angles (Normal distribution)
- Side dimension of the RVE
- Discretization along the RVE sides</p></li>
<li><p>Data written in output files include:
- Ellipsoid attributes: Major, Minor, Equivalent diameters and tilt angle
- RVE attributes: size, number of voxels, voxel resolution
- Simulation attributes: periodicity and output unit scale (mm or μm) for ABAQUS .inp file</p></li>
</ol>
</section>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="kanapy.core.initializations.mesh_creator">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">kanapy.core.initializations.</span></span><span class="sig-name descname"><span class="pre">mesh_creator</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dim</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/kanapy/core/initializations.html#mesh_creator"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kanapy.core.initializations.mesh_creator" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Create a mesh object for voxel-based microstructure representation</p>
<section id="id167">
<h3>Parameters<a class="headerlink" href="#id167" title="Link to this heading"></a></h3>
<dl class="simple">
<dt>dim<span class="classifier">tuple of int</span></dt><dd><p>3-tuple representing the number of voxels along each Cartesian direction</p>
</dd>
</dl>
</section>
<section id="id168">
<h3>Attributes<a class="headerlink" href="#id168" title="Link to this heading"></a></h3>
<dl class="simple">
<dt>dim<span class="classifier">tuple of int</span></dt><dd><p>Dimension tuple: number of voxels in each Cartesian direction</p>
</dd>
<dt>nvox<span class="classifier">int</span></dt><dd><p>Total number of voxels</p>
</dd>
<dt>phases<span class="classifier">ndarray</span></dt><dd><p>Field data storing phase numbers for each voxel</p>
</dd>
<dt>grains<span class="classifier">ndarray</span></dt><dd><p>Field data storing grain numbers for each voxel</p>
</dd>
<dt>voxel_dict<span class="classifier">dict</span></dt><dd><p>Dictionary mapping voxel number to associated nodes</p>
</dd>
<dt>grain_dict<span class="classifier">dict</span></dt><dd><p>Dictionary mapping grain number to associated voxels</p>
</dd>
<dt>grain_phase_dict<span class="classifier">dict</span></dt><dd><p>Dictionary storing phase per grain</p>
</dd>
<dt>grain_ori_dict<span class="classifier">dict</span></dt><dd><p>Dictionary storing orientation per grain</p>
</dd>
<dt>vox_center_dict<span class="classifier">dict</span></dt><dd><p>Dictionary storing center coordinates of each voxel</p>
</dd>
<dt>nodes<span class="classifier">ndarray</span></dt><dd><p>Array of nodal positions</p>
</dd>
<dt>nodes_smooth<span class="classifier">ndarray</span></dt><dd><p>Array of nodal positions after smoothing grain boundaries</p>
</dd>
<dt>prec_vf_voxels<span class="classifier">float</span></dt><dd><p>Actual volume fraction of precipitates in voxelated structure</p>
</dd>
</dl>
</section>
<section id="id169">
<h3>Notes<a class="headerlink" href="#id169" title="Link to this heading"></a></h3>
<ul class="simple">
<li><p>Raises ValueError if dim is not a 3-tuple</p></li>
<li><p>Initializes data structures to store mesh, grains, phases, and nodes</p></li>
<li><p>voxel_dict is initialized as defaultdict(list) to store node lists per voxel</p></li>
</ul>
<dl class="py method">
<dt class="sig sig-object py" id="kanapy.core.initializations.mesh_creator.create_voxels">
<span class="sig-name descname"><span class="pre">create_voxels</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sim_box</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/kanapy/core/initializations.html#mesh_creator.create_voxels"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kanapy.core.initializations.mesh_creator.create_voxels" title="Link to this definition"></a></dt>
<dd><p>Generate voxels and nodes inside the defined RVE (simulation box)</p>
<section id="id170">
<h4>Parameters<a class="headerlink" href="#id170" title="Link to this heading"></a></h4>
<dl class="simple">
<dt>sim_box<span class="classifier">entities.Cuboid</span></dt><dd><p>Simulation box object representing the RVE dimensions</p>
</dd>
</dl>
</section>
<section id="id171">
<h4>Returns<a class="headerlink" href="#id171" title="Link to this heading"></a></h4>
<dl>
<dt>None</dt><dd><p>Populates the mesh_creator object with:
- nodes : ndarray</p>
<blockquote>
<div><p>Array of nodal coordinates</p>
</div></blockquote>
<ul class="simple">
<li><dl class="simple">
<dt>voxel_dict<span class="classifier">dict</span></dt><dd><p>Dictionary mapping voxel ID to list of node IDs</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>vox_center_dict<span class="classifier">dict</span></dt><dd><p>Dictionary mapping voxel ID to center coordinates</p>
</dd>
</dl>
</li>
</ul>
</dd>
</dl>
</section>
<section id="id172">
<h4>Notes<a class="headerlink" href="#id172" title="Link to this heading"></a></h4>
<ul class="simple">
<li><p>Nodes are generated along Cartesian axes with spacing defined by dim</p></li>
<li><p>Voxel centers are computed as midpoint of voxel corners</p></li>
<li><p>8-node hexahedral (C3D8) element connectivity is maintained</p></li>
<li><p>Duplicate nodes are avoided using verticesDict</p></li>
</ul>
</section>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="kanapy.core.initializations.mesh_creator.get_ind">
<span class="sig-name descname"><span class="pre">get_ind</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">addr</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/kanapy/core/initializations.html#mesh_creator.get_ind"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kanapy.core.initializations.mesh_creator.get_ind" title="Link to this definition"></a></dt>
<dd><p>Convert a voxel address to a flat array index</p>
<section id="id173">
<h4>Parameters<a class="headerlink" href="#id173" title="Link to this heading"></a></h4>
<dl class="simple">
<dt>addr<span class="classifier">int or tuple of int</span></dt><dd><p>Address of the voxel. Can be a single integer index or a 3-tuple (i, j, k)
representing voxel coordinates along each Cartesian axis</p>
</dd>
</dl>
</section>
<section id="id174">
<h4>Returns<a class="headerlink" href="#id174" title="Link to this heading"></a></h4>
<dl class="simple">
<dt>ind<span class="classifier">int or None</span></dt><dd><p>Flattened array index corresponding to the voxel address.
Returns None if addr is None, returns addr unchanged if addr is an empty list</p>
</dd>
</dl>
</section>
<section id="id175">
<h4>Notes<a class="headerlink" href="#id175" title="Link to this heading"></a></h4>
<ul class="simple">
<li><p>Assumes row-major ordering: index = i*dim[1]*dim[2] + j*dim[1] + k</p></li>
<li><p>Raises ValueError if addr is not a single integer or a 3-tuple</p></li>
</ul>
</section>
</dd></dl>

</section>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="kanapy.core.initializations.set_stats">
<span class="sig-prename descclassname"><span class="pre">kanapy.core.initializations.</span></span><span class="sig-name descname"><span class="pre">set_stats</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">grains</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ar</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">omega</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">deq_min</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">deq_max</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">asp_min</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">asp_max</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">omega_min</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">omega_max</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">voxels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">60</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gtype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'Elongated'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rveunit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'um'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">periodicity</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">VF</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">phasename</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">phasenum</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_file</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/kanapy/core/initializations.html#set_stats"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kanapy.core.initializations.set_stats" title="Link to this definition"></a></dt>
<dd><p>Create a dictionary containing statistical grain and RVE information</p>
<section id="id176">
<h3>Parameters<a class="headerlink" href="#id176" title="Link to this heading"></a></h3>
<dl class="simple">
<dt>grains<span class="classifier">list of float</span></dt><dd><p>Parameters [sigma, loc, scale] of lognormal distribution for equivalent diameter</p>
</dd>
<dt>ar<span class="classifier">list of float, optional</span></dt><dd><p>Parameters [sigma, loc, scale] of lognormal distribution for aspect ratio (required for Elongated grains)</p>
</dd>
<dt>omega<span class="classifier">list of float, optional</span></dt><dd><p>Parameters [kappa, loc] of von Mises distribution for tilt angle (required for Elongated grains)</p>
</dd>
<dt>deq_min, deq_max<span class="classifier">float, optional</span></dt><dd><p>Minimum and maximum cutoff for equivalent diameter</p>
</dd>
<dt>asp_min, asp_max<span class="classifier">float, optional</span></dt><dd><p>Minimum and maximum cutoff for aspect ratio</p>
</dd>
<dt>omega_min, omega_max<span class="classifier">float, optional</span></dt><dd><p>Minimum and maximum cutoff for tilt angle</p>
</dd>
<dt>size<span class="classifier">int, optional</span></dt><dd><p>Side length of cubic RVE</p>
</dd>
<dt>voxels<span class="classifier">int, optional</span></dt><dd><p>Number of voxels per side of RVE</p>
</dd>
<dt>gtype<span class="classifier">str, optional</span></dt><dd><p>Grain type, either ‘Elongated’ or ‘Equiaxed’</p>
</dd>
<dt>rveunit<span class="classifier">str, optional</span></dt><dd><p>Unit of RVE dimensions (‘um’ or ‘mm’)</p>
</dd>
<dt>periodicity<span class="classifier">bool or str, optional</span></dt><dd><p>Whether RVE is periodic</p>
</dd>
<dt>VF<span class="classifier">float, optional</span></dt><dd><p>Volume fraction of phase</p>
</dd>
<dt>phasename<span class="classifier">str, optional</span></dt><dd><p>Name of phase</p>
</dd>
<dt>phasenum<span class="classifier">int, optional</span></dt><dd><p>Phase number</p>
</dd>
<dt>save_file<span class="classifier">bool, optional</span></dt><dd><p>If True, save the dictionary as JSON</p>
</dd>
</dl>
</section>
<section id="id177">
<h3>Returns<a class="headerlink" href="#id177" title="Link to this heading"></a></h3>
<dl class="simple">
<dt>ms_stats<span class="classifier">dict</span></dt><dd><p>Dictionary containing statistical grain data, RVE info, simulation settings, and phase info</p>
</dd>
</dl>
</section>
<section id="id178">
<h3>Notes<a class="headerlink" href="#id178" title="Link to this heading"></a></h3>
<ul class="simple">
<li><p>Checks consistency of grain type and required parameters</p></li>
<li><p>Sets default cutoff values if not provided</p></li>
<li><p>Supports saving statistical info to JSON</p></li>
</ul>
</section>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="kanapy.core.initializations.stat_names">
<span class="sig-prename descclassname"><span class="pre">kanapy.core.initializations.</span></span><span class="sig-name descname"><span class="pre">stat_names</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">legacy</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/kanapy/core/initializations.html#stat_names"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kanapy.core.initializations.stat_names" title="Link to this definition"></a></dt>
<dd><p>Return standardized names for statistical descriptors</p>
<section id="id179">
<h3>Parameters<a class="headerlink" href="#id179" title="Link to this heading"></a></h3>
<dl class="simple">
<dt>legacy<span class="classifier">bool, optional</span></dt><dd><p>If True, use legacy naming convention (‘std’, ‘offs’, ‘mean’, ‘kappa’);
otherwise, use current naming convention (‘sig’, ‘loc’, ‘scale’, ‘kappa’).</p>
</dd>
</dl>
</section>
<section id="id180">
<h3>Returns<a class="headerlink" href="#id180" title="Link to this heading"></a></h3>
<dl class="simple">
<dt>sig<span class="classifier">str</span></dt><dd><p>Name for the standard deviation descriptor</p>
</dd>
<dt>loc<span class="classifier">str</span></dt><dd><p>Name for the location descriptor</p>
</dd>
<dt>scale<span class="classifier">str</span></dt><dd><p>Name for the scale/mean descriptor</p>
</dd>
<dt>kappa<span class="classifier">str</span></dt><dd><p>Name for the kappa/shape parameter</p>
</dd>
</dl>
</section>
</dd></dl>

</section>
<section id="module-kanapy.core.input_output">
<span id="module-input-output"></span><h2>Module input_output<a class="headerlink" href="#module-kanapy.core.input_output" title="Link to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="kanapy.core.input_output.export2abaqus">
<span class="sig-prename descclassname"><span class="pre">kanapy.core.input_output.</span></span><span class="sig-name descname"><span class="pre">export2abaqus</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">nodes</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">file</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grain_dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">voxel_dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">units</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'um'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gb_area</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dual_phase</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">thermal</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ialloy</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grain_phase_dict</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">crystal_plasticity</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">phase_props</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="keyword-only-separator o"><abbr title="Keyword-only parameters separator (PEP 3102)"><span class="pre">*</span></abbr></span></em>, <em class="sig-param"><span class="n"><span class="pre">boundary_conditions</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/kanapy/core/input_output.html#export2abaqus"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kanapy.core.input_output.export2abaqus" title="Link to this definition"></a></dt>
<dd><p>Create an ABAQUS input file with microstructure morphology information including nodes, elements, and element sets</p>
<section id="id181">
<h3>Parameters<a class="headerlink" href="#id181" title="Link to this heading"></a></h3>
<dl class="simple">
<dt>nodes<span class="classifier">list</span></dt><dd><p>List of node objects or coordinates</p>
</dd>
<dt>file<span class="classifier">str</span></dt><dd><p>Output file path for the ABAQUS input file</p>
</dd>
<dt>grain_dict<span class="classifier">dict</span></dt><dd><p>Dictionary containing grain information</p>
</dd>
<dt>voxel_dict<span class="classifier">dict</span></dt><dd><p>Dictionary containing voxel-to-grain mapping</p>
</dd>
<dt>units<span class="classifier">str, optional</span></dt><dd><p>Units used in the input file (default is ‘um’)</p>
</dd>
<dt>gb_area<span class="classifier">optional</span></dt><dd><p>Grain boundary area information</p>
</dd>
<dt>dual_phase<span class="classifier">bool, optional</span></dt><dd><p>If True, element sets with phase numbers are defined and assigned to materials “PHASE_{phase_id}MAT”
If False, each grain refers to a material “GRAIN_{grain_id}MAT”</p>
</dd>
<dt>thermal<span class="classifier">bool, optional</span></dt><dd><p>If True, thermal properties are included</p>
</dd>
<dt>ialloy<span class="classifier">optional</span></dt><dd><p>Alloy information for grains, used if dual_phase is False</p>
</dd>
<dt>grain_phase_dict<span class="classifier">dict, optional</span></dt><dd><p>Mapping from grain ID to phase ID</p>
</dd>
<dt>crystal_plasticity<span class="classifier">bool, optional</span></dt><dd><p>If True, crystal plasticity data is included</p>
</dd>
<dt>phase_props<span class="classifier">optional</span></dt><dd><p>Phase properties for crystal plasticity</p>
</dd>
<dt>boundary_conditions<span class="classifier">dict, optional</span></dt><dd><p>Dictionary defining boundary conditions, keys may include type, loading_direction, value, etc.</p>
</dd>
</dl>
</section>
<section id="id182">
<h3>Notes<a class="headerlink" href="#id182" title="Link to this heading"></a></h3>
<p>If dual_phase is False, a “_mat.inp” file with the same name is expected to define alloy number
and Euler angles for each grain. Element sets are written for grains or phases depending on dual_phase.
The function handles nodes, elements, sets, and optionally boundary conditions for ABAQUS simulations.</p>
</section>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="kanapy.core.input_output.import_stats">
<span class="sig-prename descclassname"><span class="pre">kanapy.core.input_output.</span></span><span class="sig-name descname"><span class="pre">import_stats</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">file</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">path</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'./'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/kanapy/core/input_output.html#import_stats"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kanapy.core.input_output.import_stats" title="Link to this definition"></a></dt>
<dd><p>Read microstructure statistical descriptors from a JSON file.</p>
<p>This function loads and parses a JSON file containing statistical
information about a microstructure, such as RVE dimensions, phase fractions,
or grain statistics.</p>
<section id="id183">
<h3>Parameters<a class="headerlink" href="#id183" title="Link to this heading"></a></h3>
<dl class="simple">
<dt>file<span class="classifier">str</span></dt><dd><p>Filename of the JSON file to read. The ‘.json’ extension will be appended
automatically if missing.</p>
</dd>
<dt>path<span class="classifier">str, optional</span></dt><dd><p>Directory path where the JSON file is located (default: ‘./’).</p>
</dd>
</dl>
</section>
<section id="id184">
<h3>Returns<a class="headerlink" href="#id184" title="Link to this heading"></a></h3>
<dl class="simple">
<dt>desc<span class="classifier">dict</span></dt><dd><p>Dictionary containing the statistical microstructure descriptors.</p>
</dd>
</dl>
</section>
<section id="id185">
<h3>Raises<a class="headerlink" href="#id185" title="Link to this heading"></a></h3>
<dl class="simple">
<dt>ValueError</dt><dd><p>If <cite>file</cite> is None.</p>
</dd>
<dt>FileNotFoundError</dt><dd><p>If the specified JSON file does not exist.</p>
</dd>
<dt>json.JSONDecodeError</dt><dd><p>If the file cannot be parsed as valid JSON.</p>
</dd>
<dt>OSError</dt><dd><p>If the file cannot be read due to permission or I/O errors.</p>
</dd>
</dl>
</section>
<section id="id186">
<h3>Notes<a class="headerlink" href="#id186" title="Link to this heading"></a></h3>
<ul class="simple">
<li><p>The function expects the JSON file to contain key-value pairs describing
microstructure statistics compatible with the output of <a class="reference internal" href="#kanapy.core.input_output.write_stats" title="kanapy.core.input_output.write_stats"><code class="xref py py-func docutils literal notranslate"><span class="pre">write_stats()</span></code></a>.</p></li>
</ul>
</section>
<section id="id187">
<h3>Examples<a class="headerlink" href="#id187" title="Link to this heading"></a></h3>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">desc</span> <span class="o">=</span> <span class="n">import_stats</span><span class="p">(</span><span class="s2">&quot;example_stats.json&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">desc</span><span class="p">[</span><span class="s2">&quot;RVE&quot;</span><span class="p">][</span><span class="s2">&quot;Nx&quot;</span><span class="p">])</span>
<span class="go">20</span>
</pre></div>
</div>
</section>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="kanapy.core.input_output.import_voxels">
<span class="sig-prename descclassname"><span class="pre">kanapy.core.input_output.</span></span><span class="sig-name descname"><span class="pre">import_voxels</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">file</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">path</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'./'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/kanapy/core/input_output.html#import_voxels"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kanapy.core.input_output.import_voxels" title="Link to this definition"></a></dt>
<dd><p>Import a voxelized microstructure from a JSON file and reconstruct
a <cite>Microstructure</cite> object for further analysis or simulation.</p>
<p>The voxel file typically contains:
- Grain-wise orientation, phase, and shape information
- Global model metadata (size, periodicity, phase names, etc.)
- Optionally, mesh node coordinates and voxel connectivity</p>
<section id="id188">
<h3>Parameters<a class="headerlink" href="#id188" title="Link to this heading"></a></h3>
<dl class="simple">
<dt>file<span class="classifier">str</span></dt><dd><p>Filename of the voxelized microstructure JSON file to import.</p>
</dd>
<dt>path<span class="classifier">str, optional</span></dt><dd><p>Path where the JSON file is located (default: ‘./’).</p>
</dd>
</dl>
</section>
<section id="id189">
<h3>Returns<a class="headerlink" href="#id189" title="Link to this heading"></a></h3>
<dl class="simple">
<dt>ms<span class="classifier">Microstructure</span></dt><dd><p>Fully reconstructed microstructure object containing:
- Grain geometry, phases, orientations
- Voxel-level mesh and connectivity
- Simulation box and RVE setup
- Volume fractions and statistics</p>
</dd>
</dl>
</section>
<section id="id190">
<h3>Raises<a class="headerlink" href="#id190" title="Link to this heading"></a></h3>
<dl class="simple">
<dt>ValueError</dt><dd><p>If <cite>file</cite> is None.</p>
</dd>
<dt>FileNotFoundError</dt><dd><p>If the specified voxel file cannot be found.</p>
</dd>
<dt>KeyError</dt><dd><p>If required keys (e.g. ‘Data’, ‘Model’) are missing in the JSON file.</p>
</dd>
<dt>json.JSONDecodeError</dt><dd><p>If the file is not a valid JSON.</p>
</dd>
<dt>RuntimeError</dt><dd><p>If the phase volume fractions do not sum to 1.0 (severe data inconsistency).</p>
</dd>
</dl>
</section>
<section id="id191">
<h3>Notes<a class="headerlink" href="#id191" title="Link to this heading"></a></h3>
<ul class="simple">
<li><p>If <cite>grain_phase_dict</cite> or orientation information is missing,
the function will fall back to single-phase mode and log warnings.</p></li>
<li><p>The mesh is either reconstructed from the JSON (if provided)
or generated using <cite>mesh_creator()</cite>.</p></li>
<li><p>Periodicity and unit information are retained from the model metadata.</p></li>
</ul>
</section>
<section id="id192">
<h3>Examples<a class="headerlink" href="#id192" title="Link to this heading"></a></h3>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">ms</span> <span class="o">=</span> <span class="n">import_voxels</span><span class="p">(</span><span class="s1">&#39;example_vox.json&#39;</span><span class="p">,</span> <span class="n">path</span><span class="o">=</span><span class="s1">&#39;./input&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">ms</span><span class="o">.</span><span class="n">Ngr</span><span class="p">,</span> <span class="s1">&#39;grains loaded with&#39;</span><span class="p">,</span> <span class="n">ms</span><span class="o">.</span><span class="n">nphases</span><span class="p">,</span> <span class="s1">&#39;phases.&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">ms</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">nodes</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="s1">&#39;mesh nodes&#39;</span><span class="p">)</span>
</pre></div>
</div>
</section>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="kanapy.core.input_output.pickle2microstructure">
<span class="sig-prename descclassname"><span class="pre">kanapy.core.input_output.</span></span><span class="sig-name descname"><span class="pre">pickle2microstructure</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">file</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">path</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'./'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/kanapy/core/input_output.html#pickle2microstructure"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kanapy.core.input_output.pickle2microstructure" title="Link to this definition"></a></dt>
<dd><p>Load a pickled microstructure object from disk.</p>
<section id="id193">
<h3>Parameters<a class="headerlink" href="#id193" title="Link to this heading"></a></h3>
<dl class="simple">
<dt>file<span class="classifier">str</span></dt><dd><p>Filename of the pickled microstructure.</p>
</dd>
<dt>path<span class="classifier">str, optional</span></dt><dd><p>Directory where the pickle file is stored (default: ‘./’).</p>
</dd>
</dl>
</section>
<section id="id194">
<h3>Returns<a class="headerlink" href="#id194" title="Link to this heading"></a></h3>
<dl class="simple">
<dt>pcl<span class="classifier">Material</span></dt><dd><p>Unpickled microstructure object.</p>
</dd>
</dl>
</section>
<section id="id195">
<h3>Raises<a class="headerlink" href="#id195" title="Link to this heading"></a></h3>
<dl class="simple">
<dt>ValueError</dt><dd><p>If <cite>file</cite> is None.</p>
</dd>
<dt>FileNotFoundError</dt><dd><p>If the specified pickle file does not exist.</p>
</dd>
<dt>pickle.UnpicklingError</dt><dd><p>If the file cannot be unpickled (e.g., corrupted or invalid format).</p>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="kanapy.core.input_output.read_dump">
<span class="sig-prename descclassname"><span class="pre">kanapy.core.input_output.</span></span><span class="sig-name descname"><span class="pre">read_dump</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">file</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/kanapy/core/input_output.html#read_dump"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kanapy.core.input_output.read_dump" title="Link to this definition"></a></dt>
<dd><p>Read a .dump file to extract simulation box and ellipsoid information for voxelization</p>
<section id="id196">
<h3>Parameters<a class="headerlink" href="#id196" title="Link to this heading"></a></h3>
<dl class="simple">
<dt>file<span class="classifier">str</span></dt><dd><p>Path to the .dump file containing ellipsoid data generated in the packing routine</p>
</dd>
</dl>
</section>
<section id="id197">
<h3>Returns<a class="headerlink" href="#id197" title="Link to this heading"></a></h3>
<dl class="simple">
<dt>sim_box<span class="classifier">Cuboid</span></dt><dd><p>Cuboid object representing the RVE (simulation box)</p>
</dd>
<dt>Ellipsoids<span class="classifier">list of Ellipsoid</span></dt><dd><p>List of ellipsoid objects representing the grains</p>
</dd>
</dl>
</section>
<section id="id198">
<h3>Raises<a class="headerlink" href="#id198" title="Link to this heading"></a></h3>
<dl class="simple">
<dt>FileNotFoundError</dt><dd><p>If the specified .dump file does not exist</p>
</dd>
</dl>
</section>
<section id="id199">
<h3>Notes<a class="headerlink" href="#id199" title="Link to this heading"></a></h3>
<p>The function reads the simulation box dimensions and ellipsoid attributes including
position, axes lengths, orientation, and phase number. Duplicate ellipsoids are identified
based on naming convention in the dump file</p>
</section>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="kanapy.core.input_output.writeAbaqusMat">
<span class="sig-prename descclassname"><span class="pre">kanapy.core.input_output.</span></span><span class="sig-name descname"><span class="pre">writeAbaqusMat</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ialloy</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">angles</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">file</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">path</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'./'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grain_phase_dict</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nsdv</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">200</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/kanapy/core/input_output.html#writeAbaqusMat"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kanapy.core.input_output.writeAbaqusMat" title="Link to this definition"></a></dt>
<dd><p>Export Euler angles to Abaqus input deck that can be included in the _geom.inp file. If
parameter “grain_phase_dict” is given, the phase number for each grain will be used to select
the corresponding ialloy from a list. If the list ialloy is shorter than the number of phases in
grain_phase_dict, no angles for phases with no corresponding ialloy will be written.</p>
<section id="id200">
<h3>Parameters:<a class="headerlink" href="#id200" title="Link to this heading"></a></h3>
<dl class="simple">
<dt>ialloy<span class="classifier">int or list</span></dt><dd><p>Identifier, alloy number in ICAMS CP-UMAT: mod_alloys.f</p>
</dd>
<dt>angles<span class="classifier">dict or (N, 3)-ndarray</span></dt><dd><dl class="simple">
<dt>Dict with Euler angles for each grain or array with number of N rows (= number of grains) and</dt><dd><p>three columns phi1, Phi, phi2</p>
</dd>
</dl>
</dd>
<dt>file<span class="classifier">str</span></dt><dd><p>Filename, optional (default: None)</p>
</dd>
<dt>path<span class="classifier">str</span></dt><dd><p>Path to save file, option (default: ‘./’)</p>
</dd>
<dt>grain_phase_dict: dict</dt><dd><p>Dict with phase for each grain, optional (default: None)</p>
</dd>
<dt>nsdv<span class="classifier">int</span></dt><dd><p>Number of state dependant variables, optional (default: 200)</p>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="kanapy.core.input_output.write_dump">
<span class="sig-prename descclassname"><span class="pre">kanapy.core.input_output.</span></span><span class="sig-name descname"><span class="pre">write_dump</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Ellipsoids</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sim_box</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/kanapy/core/input_output.html#write_dump"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kanapy.core.input_output.write_dump" title="Link to this definition"></a></dt>
<dd><p>Write .dump files into a sub-directory “dump_files” for visualization or reuse in Kanapy</p>
<section id="id201">
<h3>Parameters<a class="headerlink" href="#id201" title="Link to this heading"></a></h3>
<dl class="simple">
<dt>Ellipsoids<span class="classifier">list</span></dt><dd><p>Contains information of ellipsoids such as positions, axes lengths, and tilt angles</p>
</dd>
<dt>sim_box<span class="classifier">Cuboid</span></dt><dd><p>Contains information of the dimensions of the simulation box</p>
</dd>
</dl>
</section>
<section id="id202">
<h3>Returns<a class="headerlink" href="#id202" title="Link to this heading"></a></h3>
<p>None</p>
</section>
<section id="id203">
<h3>Notes<a class="headerlink" href="#id203" title="Link to this heading"></a></h3>
<p>The function creates a ‘dump_files’ directory in the current working directory if it does not exist
and writes a file named ‘particle.&lt;timestep&gt;.dump’, where &lt;timestep&gt; is given by sim_box.sim_ts.
The generated .dump files can be read by visualization software like OVITO or imported back into Kanapy
to avoid repeating the packing simulation. Each file contains simulation domain bounds and ellipsoid
attributes including position, axes lengths, and quaternion orientation.</p>
</section>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="kanapy.core.input_output.write_stats">
<span class="sig-prename descclassname"><span class="pre">kanapy.core.input_output.</span></span><span class="sig-name descname"><span class="pre">write_stats</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">stats</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">file</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">path</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'./'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/kanapy/core/input_output.html#write_stats"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kanapy.core.input_output.write_stats" title="Link to this definition"></a></dt>
<dd><p>Write microstructure statistical descriptors to a JSON file.</p>
<p>This function serializes the provided statistical data (e.g., phase
fractions, grain sizes, RVE dimensions) and writes it to disk in JSON format.
The <cite>.json</cite> extension is automatically appended if not provided.</p>
<section id="id204">
<h3>Parameters<a class="headerlink" href="#id204" title="Link to this heading"></a></h3>
<dl class="simple">
<dt>stats<span class="classifier">dict</span></dt><dd><p>Dictionary containing statistical descriptors of the microstructure
(e.g., grain count, phase fractions, RVE size, or any other metadata).</p>
</dd>
<dt>file<span class="classifier">str</span></dt><dd><p>Output filename for the JSON file. The ‘.json’ extension will be appended
automatically if missing.</p>
</dd>
<dt>path<span class="classifier">str, optional</span></dt><dd><p>Directory path where the JSON file will be written (default: ‘./’).</p>
</dd>
</dl>
</section>
<section id="id205">
<h3>Raises<a class="headerlink" href="#id205" title="Link to this heading"></a></h3>
<dl class="simple">
<dt>ValueError</dt><dd><p>If <cite>stats</cite> or <cite>file</cite> is None.</p>
</dd>
<dt>OSError</dt><dd><p>If the file cannot be written (e.g., due to permission or path issues).</p>
</dd>
<dt>TypeError</dt><dd><p>If <cite>stats</cite> contains non-serializable objects (invalid for JSON encoding).</p>
</dd>
</dl>
</section>
<section id="id206">
<h3>Notes<a class="headerlink" href="#id206" title="Link to this heading"></a></h3>
<ul class="simple">
<li><p>The function uses Python’s built-in <code class="xref py py-mod docutils literal notranslate"><span class="pre">json</span></code> module.</p></li>
<li><p>The output file is overwritten if it already exists.</p></li>
</ul>
</section>
<section id="id207">
<h3>Examples<a class="headerlink" href="#id207" title="Link to this heading"></a></h3>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">stats</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;RVE&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;Nx&quot;</span><span class="p">:</span> <span class="mi">20</span><span class="p">,</span> <span class="s2">&quot;Ny&quot;</span><span class="p">:</span> <span class="mi">20</span><span class="p">,</span> <span class="s2">&quot;Nz&quot;</span><span class="p">:</span> <span class="mi">20</span><span class="p">},</span> <span class="s2">&quot;Phase&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;Volume fraction&quot;</span><span class="p">:</span> <span class="mf">0.8</span><span class="p">}}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">write_stats</span><span class="p">(</span><span class="n">stats</span><span class="p">,</span> <span class="s2">&quot;example_stats&quot;</span><span class="p">)</span>
<span class="go"># Writes &#39;./example_stats.json&#39;</span>
</pre></div>
</div>
</section>
</dd></dl>

</section>
<section id="module-kanapy.core.packing">
<span id="module-packing"></span><h2>Module packing<a class="headerlink" href="#module-kanapy.core.packing" title="Link to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="kanapy.core.packing.calculateForce">
<span class="sig-prename descclassname"><span class="pre">kanapy.core.packing.</span></span><span class="sig-name descname"><span class="pre">calculateForce</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Ellipsoids</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sim_box</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">periodicity</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">k_rep</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">k_att</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/kanapy/core/packing.html#calculateForce"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kanapy.core.packing.calculateForce" title="Link to this definition"></a></dt>
<dd><p>Calculate the interaction forces between ellipsoids within the simulation box</p>
<p>Computes pairwise repulsive or attractive forces based on distance and phase
between ellipsoids. Applies periodic boundary conditions if enabled.</p>
<section id="id208">
<h3>Parameters<a class="headerlink" href="#id208" title="Link to this heading"></a></h3>
<dl class="simple">
<dt>Ellipsoids<span class="classifier">list of Ellipsoid</span></dt><dd><p>List of ellipsoid instances for which forces are calculated</p>
</dd>
<dt>sim_box<span class="classifier">Simulation_Box</span></dt><dd><p>Simulation box representing the RVE dimensions</p>
</dd>
<dt>periodicity<span class="classifier">bool</span></dt><dd><p>If True, applies periodic boundary conditions</p>
</dd>
<dt>k_rep<span class="classifier">float, optional</span></dt><dd><p>Repulsion factor for particles of the same phase (default is 0.0)</p>
</dd>
<dt>k_att<span class="classifier">float, optional</span></dt><dd><p>Attraction factor for particles of different phases (default is 0.0)</p>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="kanapy.core.packing.packingRoutine">
<span class="sig-prename descclassname"><span class="pre">kanapy.core.packing.</span></span><span class="sig-name descname"><span class="pre">packingRoutine</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">particle_data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">periodic</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nsteps</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sim_box</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">k_rep</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">k_att</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fill_factor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">poly</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_files</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/kanapy/core/packing.html#packingRoutine"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kanapy.core.packing.packingRoutine" title="Link to this definition"></a></dt>
<dd><p>Perform particle packing routine using particle generation and growth simulation</p>
<p>The function first generates ellipsoids from the provided particle statistics
and then grows them over time steps while handling collisions and interactions.
Uses <a class="reference internal" href="#kanapy.core.packing.particle_generator" title="kanapy.core.packing.particle_generator"><code class="xref py py-meth docutils literal notranslate"><span class="pre">particle_generator()</span></code></a> to create particles and <a class="reference internal" href="#kanapy.core.packing.particle_grow" title="kanapy.core.packing.particle_grow"><code class="xref py py-meth docutils literal notranslate"><span class="pre">particle_grow()</span></code></a>
to grow and settle them.</p>
<section id="id209">
<h3>Parameters<a class="headerlink" href="#id209" title="Link to this heading"></a></h3>
<dl class="simple">
<dt>particle_data<span class="classifier">list of dict</span></dt><dd><p>Statistics describing particle attributes for generation</p>
</dd>
<dt>periodic<span class="classifier">bool</span></dt><dd><p>Flag indicating if periodic boundary conditions are applied</p>
</dd>
<dt>nsteps<span class="classifier">int</span></dt><dd><p>Total number of timesteps for the growth simulation</p>
</dd>
<dt>sim_box<span class="classifier">Simulation_Box</span></dt><dd><p>Simulation box representing the RVE dimensions</p>
</dd>
<dt>k_rep<span class="classifier">float, optional</span></dt><dd><p>Repulsion factor for same-phase particles (default 0.0)</p>
</dd>
<dt>k_att<span class="classifier">float, optional</span></dt><dd><p>Attraction factor for different-phase particles (default 0.0)</p>
</dd>
<dt>fill_factor<span class="classifier">float, optional</span></dt><dd><p>Target volume fraction for particle filling (default None, uses 0.65)</p>
</dd>
<dt>poly<span class="classifier">ndarray, optional</span></dt><dd><p>Points defining a primitive polygon inside ellipsoids (default None)</p>
</dd>
<dt>save_files<span class="classifier">bool, optional</span></dt><dd><p>Whether to save dump files during simulation (default False)</p>
</dd>
<dt>verbose<span class="classifier">bool, optional</span></dt><dd><p>If True, prints detailed simulation output (default False)</p>
</dd>
</dl>
</section>
<section id="id210">
<h3>Returns<a class="headerlink" href="#id210" title="Link to this heading"></a></h3>
<dl class="simple">
<dt>particles<span class="classifier">list</span></dt><dd><p>List of generated and packed ellipsoids</p>
</dd>
<dt>simbox<span class="classifier">Simulation_Box</span></dt><dd><p>Updated simulation box with current timestep information</p>
</dd>
</dl>
</section>
<section id="id211">
<h3>Notes<a class="headerlink" href="#id211" title="Link to this heading"></a></h3>
<p>Particle, RVE, and simulation data are read from JSON files generated by
<code class="xref py py-meth docutils literal notranslate"><span class="pre">kanapy.input_output.particleStatGenerator()</span></code>. These files contain:</p>
<ul class="simple">
<li><p>Ellipsoid attributes such as Major, Minor, Equivalent diameters, and tilt angles</p></li>
<li><p>RVE attributes such as simulation domain size, number of voxels, and voxel resolution</p></li>
<li><p>Simulation attributes such as total number of timesteps and periodicity</p></li>
</ul>
</section>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="kanapy.core.packing.particle_generator">
<span class="sig-prename descclassname"><span class="pre">kanapy.core.packing.</span></span><span class="sig-name descname"><span class="pre">particle_generator</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">particle_data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sim_box</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">poly</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/kanapy/core/packing.html#particle_generator"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kanapy.core.packing.particle_generator" title="Link to this definition"></a></dt>
<dd><p>Initialize a list of ellipsoids by assigning random positions, orientations,
and sizes within the given simulation box.</p>
<section id="id212">
<h3>Parameters<a class="headerlink" href="#id212" title="Link to this heading"></a></h3>
<dl class="simple">
<dt>particle_data<span class="classifier">dict</span></dt><dd><p>Dictionary containing ellipsoid properties such as major, minor, and
equivalent diameters, tilt angles, and number of particles per phase.</p>
</dd>
<dt>sim_box<span class="classifier">entities.Simulation_Box</span></dt><dd><p>Simulation box object defining the representative volume element (RVE)
dimensions (width, height, depth).</p>
</dd>
<dt>poly<span class="classifier">ndarray of shape (N, 3), optional</span></dt><dd><p>Points defining a primitive polygon inside the ellipsoid. Used for
geometry construction.</p>
</dd>
</dl>
</section>
<section id="id213">
<h3>Returns<a class="headerlink" href="#id213" title="Link to this heading"></a></h3>
<dl class="simple">
<dt>list</dt><dd><p>List of <cite>Ellipsoid</cite> objects initialized for the packing routine.</p>
</dd>
</dl>
</section>
<section id="id214">
<h3>Notes<a class="headerlink" href="#id214" title="Link to this heading"></a></h3>
<p>The function introduces a scaling factor (0.5) to reduce overlap among
generated ellipsoids. Ellipsoids are assigned random colors and positions
within the simulation box.</p>
</section>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="kanapy.core.packing.particle_grow">
<span class="sig-prename descclassname"><span class="pre">kanapy.core.packing.</span></span><span class="sig-name descname"><span class="pre">particle_grow</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sim_box</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Ellipsoids</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">periodicity</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nsteps</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">k_rep</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">k_att</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fill_factor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dump</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/kanapy/core/packing.html#particle_grow"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kanapy.core.packing.particle_grow" title="Link to this definition"></a></dt>
<dd><p>Perform recursive particle growth and collision detection within the
simulation box. Initializes an <code class="xref py py-class docutils literal notranslate"><span class="pre">entities.Octree</span></code> instance and
progressively grows ellipsoids while handling inter-particle and
wall collisions.</p>
<section id="id215">
<h3>Parameters<a class="headerlink" href="#id215" title="Link to this heading"></a></h3>
<dl class="simple">
<dt>sim_box<span class="classifier">entities.Simulation_Box</span></dt><dd><p>Simulation box representing the representative volume element (RVE).</p>
</dd>
<dt>Ellipsoids<span class="classifier">list</span></dt><dd><p>List of <cite>Ellipsoid</cite> objects used in the packing routine.</p>
</dd>
<dt>periodicity<span class="classifier">bool</span></dt><dd><p>Whether periodic boundary conditions are applied.</p>
</dd>
<dt>nsteps<span class="classifier">int</span></dt><dd><p>Total number of simulation steps for filling the box with particles.</p>
</dd>
<dt>k_rep<span class="classifier">float, optional</span></dt><dd><p>Repulsion factor for particle interactions (default: 0.0).</p>
</dd>
<dt>k_att<span class="classifier">float, optional</span></dt><dd><p>Attraction factor for particle interactions (default: 0.0).</p>
</dd>
<dt>fill_factor<span class="classifier">float, optional</span></dt><dd><p>Target volume fraction for particle filling (default: 0.65).</p>
</dd>
<dt>dump<span class="classifier">bool, optional</span></dt><dd><p>If True, dump files for particles are written at intervals (default: False).</p>
</dd>
<dt>verbose<span class="classifier">bool, optional</span></dt><dd><p>If True, print detailed information at iteration steps (default: False).</p>
</dd>
</dl>
</section>
<section id="id216">
<h3>Returns<a class="headerlink" href="#id216" title="Link to this heading"></a></h3>
<dl class="simple">
<dt>Ellipsoids<span class="classifier">list</span></dt><dd><p>Updated list of <cite>Ellipsoid</cite> objects after particle growth.</p>
</dd>
<dt>sim_box<span class="classifier">entities.Simulation_Box</span></dt><dd><p>Updated simulation box object after the packing process.</p>
</dd>
</dl>
</section>
<section id="id217">
<h3>Notes<a class="headerlink" href="#id217" title="Link to this heading"></a></h3>
<p>The function calls <code class="xref py py-func docutils literal notranslate"><span class="pre">kanapy.input_output.write_dump()</span></code> at each time step
to write <cite>.dump</cite> files. Periodic images are written by default but can be
disabled inside that function.</p>
</section>
</dd></dl>

</section>
<section id="module-kanapy.core.entities">
<span id="module-entities"></span><h2>Module entities<a class="headerlink" href="#module-kanapy.core.entities" title="Link to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="kanapy.core.entities.Cuboid">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">kanapy.core.entities.</span></span><span class="sig-name descname"><span class="pre">Cuboid</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">left</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">top</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">right</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bottom</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">front</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">back</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/kanapy/core/entities.html#Cuboid"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kanapy.core.entities.Cuboid" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Create Cuboid objects for ellipsoids and Octree sub-branches</p>
<section id="id218">
<h3>Parameters<a class="headerlink" href="#id218" title="Link to this heading"></a></h3>
<dl class="simple">
<dt>left<span class="classifier">float</span></dt><dd><p>Bounding box minimum along x</p>
</dd>
<dt>top<span class="classifier">float</span></dt><dd><p>Bounding box minimum along y</p>
</dd>
<dt>right<span class="classifier">float</span></dt><dd><p>Bounding box maximum along x</p>
</dd>
<dt>bottom<span class="classifier">float</span></dt><dd><p>Bounding box maximum along y</p>
</dd>
<dt>front<span class="classifier">float</span></dt><dd><p>Bounding box minimum along z</p>
</dd>
<dt>back<span class="classifier">float</span></dt><dd><p>Bounding box maximum along z</p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="kanapy.core.entities.Cuboid.intersect">
<span class="sig-name descname"><span class="pre">intersect</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">other</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/kanapy/core/entities.html#Cuboid.intersect"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kanapy.core.entities.Cuboid.intersect" title="Link to this definition"></a></dt>
<dd><p>Evaluate whether the Cuboid object of the ellipsoid intersects with the Cuboid object of the Octree sub-branch</p>
<section id="id219">
<h4>Parameters<a class="headerlink" href="#id219" title="Link to this heading"></a></h4>
<dl class="simple">
<dt>other: Cuboid</dt><dd><p>Sub-branch cuboid object of the octree</p>
</dd>
</dl>
</section>
<section id="id220">
<h4>Returns<a class="headerlink" href="#id220" title="Link to this heading"></a></h4>
<dl class="simple">
<dt>bool</dt><dd><p>True if intersection occurs, False otherwise</p>
</dd>
</dl>
</section>
</dd></dl>

</section>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="kanapy.core.entities.Ellipsoid">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">kanapy.core.entities.</span></span><span class="sig-name descname"><span class="pre">Ellipsoid</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">iden</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">c</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">quat</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">phasenum</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dup</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">points</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/kanapy/core/entities.html#Ellipsoid"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kanapy.core.entities.Ellipsoid" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Creates Ellipsoid objects for each ellipsoid generated from input statistics</p>
<section id="id221">
<h3>Parameters<a class="headerlink" href="#id221" title="Link to this heading"></a></h3>
<dl class="simple">
<dt>iden<span class="classifier">int</span></dt><dd><p>ID of the ellipsoid</p>
</dd>
<dt>x<span class="classifier">float</span></dt><dd><p>X-coordinate of the ellipsoid center</p>
</dd>
<dt>y<span class="classifier">float</span></dt><dd><p>Y-coordinate of the ellipsoid center</p>
</dd>
<dt>z<span class="classifier">float</span></dt><dd><p>Z-coordinate of the ellipsoid center</p>
</dd>
<dt>a<span class="classifier">float</span></dt><dd><p>Semi-major axis length of the ellipsoid</p>
</dd>
<dt>b<span class="classifier">float</span></dt><dd><p>Semi-minor axis length of the ellipsoid</p>
</dd>
<dt>c<span class="classifier">float</span></dt><dd><p>Semi-minor axis length of the ellipsoid</p>
</dd>
<dt>quat<span class="classifier">numpy.ndarray</span></dt><dd><p>Quaternion representing the ellipsoid’s orientation</p>
</dd>
<dt>phasenum<span class="classifier">int, optional</span></dt><dd><p>Phase number of the ellipsoid, default is 0</p>
</dd>
<dt>dup<span class="classifier">optional</span></dt><dd><p>Duplicate status used for voxelization, default is None</p>
</dd>
<dt>points<span class="classifier">list or None, optional</span></dt><dd><p>Points used to create a Delaunay tessellation for the ellipsoid, default is None</p>
</dd>
</dl>
</section>
<section id="id222">
<h3>Attributes<a class="headerlink" href="#id222" title="Link to this heading"></a></h3>
<dl class="simple">
<dt>id<span class="classifier">int</span></dt><dd><p>ID of the ellipsoid</p>
</dd>
<dt>x, y, z<span class="classifier">float</span></dt><dd><p>Position of the ellipsoid center</p>
</dd>
<dt>xold, yold, zold<span class="classifier">float</span></dt><dd><p>Previous positions</p>
</dd>
<dt>a, b, c<span class="classifier">float</span></dt><dd><p>Semi-major and semi-minor axes lengths</p>
</dd>
<dt>oria, orib, oric<span class="classifier">float</span></dt><dd><p>Original axes lengths</p>
</dd>
<dt>speedx, speedy, speedz<span class="classifier">float</span></dt><dd><p>Velocity components, initialized to 0</p>
</dd>
<dt>force_x, force_y, force_z<span class="classifier">float</span></dt><dd><p>Forces acting on the ellipsoid, initialized to 0</p>
</dd>
<dt>rotation_matrix<span class="classifier">ndarray</span></dt><dd><p>Rotation matrix of the ellipsoid</p>
</dd>
<dt>surface_points<span class="classifier">list</span></dt><dd><p>Surface points of the ellipsoid</p>
</dd>
<dt>inside_voxels<span class="classifier">list</span></dt><dd><p>Voxels belonging to the ellipsoid</p>
</dd>
<dt>duplicate<span class="classifier">optional</span></dt><dd><p>Duplicate status used for voxelization</p>
</dd>
<dt>phasenum<span class="classifier">int</span></dt><dd><p>Phase number</p>
</dd>
<dt>branches<span class="classifier">list</span></dt><dd><p>Branches associated with the ellipsoid</p>
</dd>
<dt>neighborlist<span class="classifier">set</span></dt><dd><p>Neighbor ellipsoids</p>
</dd>
<dt>ncollision<span class="classifier">int</span></dt><dd><p>Number of collisions</p>
</dd>
<dt>inner<span class="classifier">optional</span></dt><dd><p>Delaunay tessellation of points if provided, else None</p>
</dd>
</dl>
</section>
<section id="id223">
<h3>Notes<a class="headerlink" href="#id223" title="Link to this heading"></a></h3>
<ol class="arabic simple">
<li><p>The orientation of each ellipsoid in the global coordinate space is defined by its
tilt angle and axis vector, expressed in quaternion notation.</p></li>
<li><p>Ellipsoids are initialized without a velocity; a random value is later assigned by
<cite>kanapy.packing.particle_generator</cite>.</p></li>
<li><p>An empty list for storing voxels belonging to the ellipsoid is initialized.</p></li>
</ol>
<dl class="py method">
<dt class="sig sig-object py" id="kanapy.core.entities.Ellipsoid.Bbox">
<span class="sig-name descname"><span class="pre">Bbox</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/kanapy/core/entities.html#Ellipsoid.Bbox"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kanapy.core.entities.Ellipsoid.Bbox" title="Link to this definition"></a></dt>
<dd><p>Compute the axis-aligned bounding box of the ellipsoid using its surface points</p>
<p>Sets the attributes:
- bbox_xmin, bbox_xmax
- bbox_ymin, bbox_ymax
- bbox_zmin, bbox_zmax</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="kanapy.core.entities.Ellipsoid.create_poly">
<span class="sig-name descname"><span class="pre">create_poly</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">points</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/kanapy/core/entities.html#Ellipsoid.create_poly"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kanapy.core.entities.Ellipsoid.create_poly" title="Link to this definition"></a></dt>
<dd><p>Create a polygon inside the ellipsoid</p>
<p>This method applies a rotation to the input points using the object’s rotation_matrix
and computes the Delaunay triangulation to form a polygon</p>
<section id="id224">
<h4>Parameters<a class="headerlink" href="#id224" title="Link to this heading"></a></h4>
<dl class="simple">
<dt>points<span class="classifier">array_like</span></dt><dd><p>Input points to construct the polygon</p>
</dd>
</dl>
</section>
<section id="id225">
<h4>Returns<a class="headerlink" href="#id225" title="Link to this heading"></a></h4>
<dl class="simple">
<dt>Delaunay</dt><dd><p>A Delaunay triangulation object representing the polygon</p>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="kanapy.core.entities.Ellipsoid.get_coeffs">
<span class="sig-name descname"><span class="pre">get_coeffs</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/kanapy/core/entities.html#Ellipsoid.get_coeffs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kanapy.core.entities.Ellipsoid.get_coeffs" title="Link to this definition"></a></dt>
<dd><p>Return the semi-axes coefficients of the ellipsoid</p>
<section id="id226">
<h4>Returns<a class="headerlink" href="#id226" title="Link to this heading"></a></h4>
<dl class="simple">
<dt>numpy.ndarray</dt><dd><p>A 1D array [a, b, c] representing the semi-major and semi-minor axes lengths of the ellipsoid.</p>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="kanapy.core.entities.Ellipsoid.get_cub">
<span class="sig-name descname"><span class="pre">get_cub</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/kanapy/core/entities.html#Ellipsoid.get_cub"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kanapy.core.entities.Ellipsoid.get_cub" title="Link to this definition"></a></dt>
<dd><p>Return the cuboid object of the ellipsoid</p>
<section id="id227">
<h4>Returns<a class="headerlink" href="#id227" title="Link to this heading"></a></h4>
<dl class="simple">
<dt>Cuboid</dt><dd><p>Cuboid object representing the ellipsoid’s bounding cuboid</p>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="kanapy.core.entities.Ellipsoid.get_pos">
<span class="sig-name descname"><span class="pre">get_pos</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/kanapy/core/entities.html#Ellipsoid.get_pos"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kanapy.core.entities.Ellipsoid.get_pos" title="Link to this definition"></a></dt>
<dd><p>Return the current position of the ellipsoid</p>
<section id="id228">
<h4>Returns<a class="headerlink" href="#id228" title="Link to this heading"></a></h4>
<dl class="simple">
<dt>numpy.ndarray</dt><dd><p>A 1D array [x, y, z] representing the current center coordinates of the ellipsoid.</p>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="kanapy.core.entities.Ellipsoid.get_volume">
<span class="sig-name descname"><span class="pre">get_volume</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/kanapy/core/entities.html#Ellipsoid.get_volume"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kanapy.core.entities.Ellipsoid.get_volume" title="Link to this definition"></a></dt>
<dd><p>Return the volume of the ellipsoid</p>
<section id="id229">
<h4>Returns<a class="headerlink" href="#id229" title="Link to this heading"></a></h4>
<dl class="simple">
<dt>float</dt><dd><p>The volume of the ellipsoid calculated as (4/3) * pi * a * b * c.</p>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="kanapy.core.entities.Ellipsoid.gravity_effect">
<span class="sig-name descname"><span class="pre">gravity_effect</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/kanapy/core/entities.html#Ellipsoid.gravity_effect"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kanapy.core.entities.Ellipsoid.gravity_effect" title="Link to this definition"></a></dt>
<dd><p>Move the ellipsoid downwards to mimic the effect of gravity acting on it</p>
<section id="id230">
<h4>Parameters<a class="headerlink" href="#id230" title="Link to this heading"></a></h4>
<dl class="simple">
<dt>value<span class="classifier">float</span></dt><dd><p>User defined value for downward movement</p>
</dd>
</dl>
</section>
<section id="id231">
<h4>Notes<a class="headerlink" href="#id231" title="Link to this heading"></a></h4>
<p>The Cuboid object of the ellipsoid must be updated every time it moves</p>
</section>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="kanapy.core.entities.Ellipsoid.growth">
<span class="sig-name descname"><span class="pre">growth</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fac</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/kanapy/core/entities.html#Ellipsoid.growth"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kanapy.core.entities.Ellipsoid.growth" title="Link to this definition"></a></dt>
<dd><p>Increase the size of the ellipsoid along its axes by a scaling factor</p>
<section id="id232">
<h4>Parameters<a class="headerlink" href="#id232" title="Link to this heading"></a></h4>
<dl class="simple">
<dt>fac<span class="classifier">float</span></dt><dd><p>Scaling factor applied to the original axes lengths.</p>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="kanapy.core.entities.Ellipsoid.move">
<span class="sig-name descname"><span class="pre">move</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dt</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/kanapy/core/entities.html#Ellipsoid.move"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kanapy.core.entities.Ellipsoid.move" title="Link to this definition"></a></dt>
<dd><p>Move the ellipsoid by updating its position vector using the Verlet integration method</p>
<p>This method updates the ellipsoid’s position and velocity components based on
the current force and previous positions, and then updates the Cuboid object.</p>
<section id="id233">
<h4>Parameters<a class="headerlink" href="#id233" title="Link to this heading"></a></h4>
<dl class="simple">
<dt>dt<span class="classifier">float</span></dt><dd><p>Time step used in the Verlet integration</p>
</dd>
</dl>
</section>
<section id="id234">
<h4>Notes<a class="headerlink" href="#id234" title="Link to this heading"></a></h4>
<p>The Cuboid object of the ellipsoid must be updated every time the ellipsoid moves</p>
</section>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="kanapy.core.entities.Ellipsoid.rotationMatrixGen">
<span class="sig-name descname"><span class="pre">rotationMatrixGen</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/kanapy/core/entities.html#Ellipsoid.rotationMatrixGen"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kanapy.core.entities.Ellipsoid.rotationMatrixGen" title="Link to this definition"></a></dt>
<dd><p>Compute the rotation matrix of the ellipsoid from its quaternion</p>
<section id="id235">
<h4>Returns<a class="headerlink" href="#id235" title="Link to this heading"></a></h4>
<dl class="simple">
<dt>numpy.ndarray</dt><dd><p>A 3x3 rotation matrix representing the ellipsoid’s orientation.</p>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="kanapy.core.entities.Ellipsoid.set_cub">
<span class="sig-name descname"><span class="pre">set_cub</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/kanapy/core/entities.html#Ellipsoid.set_cub"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kanapy.core.entities.Ellipsoid.set_cub" title="Link to this definition"></a></dt>
<dd><p>Initialize an object of the class Cuboid using the bounding box limits from Bbox</p>
<p>This method calls the Bbox method to obtain the bounding box limits and then
creates a Cuboid object using these limits</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="kanapy.core.entities.Ellipsoid.surfacePointsGen">
<span class="sig-name descname"><span class="pre">surfacePointsGen</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">nang</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">20</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/kanapy/core/entities.html#Ellipsoid.surfacePointsGen"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kanapy.core.entities.Ellipsoid.surfacePointsGen" title="Link to this definition"></a></dt>
<dd><p>Generate points on the outer surface of the ellipsoid using its rotation matrix</p>
<section id="id236">
<h4>Parameters<a class="headerlink" href="#id236" title="Link to this heading"></a></h4>
<dl class="simple">
<dt>nang<span class="classifier">int, optional</span></dt><dd><p>Number of points along each angular direction (default is 20).</p>
</dd>
</dl>
</section>
<section id="id237">
<h4>Returns<a class="headerlink" href="#id237" title="Link to this heading"></a></h4>
<dl class="simple">
<dt>numpy.ndarray</dt><dd><p>An array of shape (nang*nang, 3) containing 3D coordinates of points on the ellipsoid surface.</p>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="kanapy.core.entities.Ellipsoid.sync_poly">
<span class="sig-name descname"><span class="pre">sync_poly</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">scale</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/kanapy/core/entities.html#Ellipsoid.sync_poly"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kanapy.core.entities.Ellipsoid.sync_poly" title="Link to this definition"></a></dt>
<dd><p>Move the center of the polygon to the center of the ellipsoid and scale the hull to fit inside the ellipsoid</p>
<p>This method recenters the polygon points at the ellipsoid’s center, applies rotation
and scaling to fit the polygon inside the ellipsoid, and updates the Delaunay triangulation.</p>
<section id="id238">
<h4>Parameters<a class="headerlink" href="#id238" title="Link to this heading"></a></h4>
<dl class="simple">
<dt>scale<span class="classifier">float, optional</span></dt><dd><p>Scaling factor to apply to the polygon. If None, the default poly_scale from kanapy is used.</p>
</dd>
</dl>
</section>
<section id="id239">
<h4>Notes<a class="headerlink" href="#id239" title="Link to this heading"></a></h4>
<p>The function assumes that self.inner contains a Delaunay object representing the polygon.
If self.inner is None, the method does nothing.</p>
</section>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="kanapy.core.entities.Ellipsoid.wallCollision">
<span class="sig-name descname"><span class="pre">wallCollision</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sim_box</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">periodicity</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/kanapy/core/entities.html#Ellipsoid.wallCollision"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kanapy.core.entities.Ellipsoid.wallCollision" title="Link to this definition"></a></dt>
<dd><p>Evaluate whether the ellipsoid collides with the boundaries of the simulation box</p>
<p>This method checks if the ellipsoid intersects with the simulation box walls.
If periodicity is enabled, duplicates of the ellipsoid are created on opposite faces.
If periodicity is disabled, the ellipsoid bounces back from the walls.</p>
<section id="id240">
<h4>Parameters<a class="headerlink" href="#id240" title="Link to this heading"></a></h4>
<dl class="simple">
<dt>sim_box<span class="classifier">Simulation_Box</span></dt><dd><p>Simulation box object containing boundary limits</p>
</dd>
<dt>periodicity<span class="classifier">bool</span></dt><dd><p>Status of periodicity</p>
</dd>
</dl>
</section>
<section id="id241">
<h4>Returns<a class="headerlink" href="#id241" title="Link to this heading"></a></h4>
<dl class="simple">
<dt>list</dt><dd><p>List of ellipsoid duplicates if periodicity is enabled, otherwise an empty list</p>
</dd>
</dl>
</section>
<section id="id242">
<h4>Notes<a class="headerlink" href="#id242" title="Link to this heading"></a></h4>
<p>The Cuboid object of the ellipsoid must be updated every time the ellipsoid moves</p>
</section>
</dd></dl>

</section>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="kanapy.core.entities.Octree">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">kanapy.core.entities.</span></span><span class="sig-name descname"><span class="pre">Octree</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">level</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cub</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">particles</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/kanapy/core/entities.html#Octree"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kanapy.core.entities.Octree" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Create an Octree object for tree trunk and its sub-branches</p>
<section id="id243">
<h3>Parameters<a class="headerlink" href="#id243" title="Link to this heading"></a></h3>
<dl class="simple">
<dt>level: int</dt><dd><p>Current level of the Octree, 0 for the trunk</p>
</dd>
<dt>cub: Cuboid</dt><dd><p>Cuboid object of the tree trunk or sub-branches, should be entire simulation box for the trunk</p>
</dd>
<dt>particles: list</dt><dd><p>List of particles within the tree trunk or sub-branches, contains all ellipsoids in the simulation domain for the trunk</p>
</dd>
</dl>
</section>
<section id="id244">
<h3>Notes<a class="headerlink" href="#id244" title="Link to this heading"></a></h3>
<ol class="arabic simple">
<li><p>level is set to zero for the trunk of the Octree</p></li>
<li><p>cub should be entire simulation box for the tree trunk</p></li>
<li><p>particles list contains all the ellipsoids in the simulation domain for the tree trunk</p></li>
</ol>
<dl class="py method">
<dt class="sig sig-object py" id="kanapy.core.entities.Octree.add_particle">
<span class="sig-name descname"><span class="pre">add_particle</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">particle</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/kanapy/core/entities.html#Octree.add_particle"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kanapy.core.entities.Octree.add_particle" title="Link to this definition"></a></dt>
<dd><p>Update the particle list of the Octree sub-branch</p>
<section id="id245">
<h4>Parameters<a class="headerlink" href="#id245" title="Link to this heading"></a></h4>
<dl class="simple">
<dt>particle: object</dt><dd><p>Particle object to be added to the sub-branch</p>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="kanapy.core.entities.Octree.collisionsTest">
<span class="sig-name descname"><span class="pre">collisionsTest</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/kanapy/core/entities.html#Octree.collisionsTest"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kanapy.core.entities.Octree.collisionsTest" title="Link to this definition"></a></dt>
<dd><p>Test for collisions between all ellipsoids in the Octree sub-branch</p>
<section id="id246">
<h4>Returns<a class="headerlink" href="#id246" title="Link to this heading"></a></h4>
<dl class="simple">
<dt>int</dt><dd><p>Number of collisions detected</p>
</dd>
</dl>
</section>
<section id="id247">
<h4>Notes<a class="headerlink" href="#id247" title="Link to this heading"></a></h4>
<p>Uses bounding sphere check as a preliminary filter and then calls the
collision_routine to determine actual overlaps. Updates the collision count
for each ellipsoid</p>
</section>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="kanapy.core.entities.Octree.get_cub">
<span class="sig-name descname"><span class="pre">get_cub</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/kanapy/core/entities.html#Octree.get_cub"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kanapy.core.entities.Octree.get_cub" title="Link to this definition"></a></dt>
<dd><p>Return the cuboid object of the octree sub-branch</p>
<section id="id248">
<h4>Returns<a class="headerlink" href="#id248" title="Link to this heading"></a></h4>
<dl class="simple">
<dt>Cuboid</dt><dd><p>Cuboid object corresponding to the octree sub-branch</p>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="kanapy.core.entities.Octree.make_neighborlist">
<span class="sig-name descname"><span class="pre">make_neighborlist</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/kanapy/core/entities.html#Octree.make_neighborlist"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kanapy.core.entities.Octree.make_neighborlist" title="Link to this definition"></a></dt>
<dd><p>Find the neighbor list for each particle in the Octree sub-branch</p>
<section id="id249">
<h4>Notes<a class="headerlink" href="#id249" title="Link to this heading"></a></h4>
<p>Initializes the neighborlist of each particle as a set and updates it with particles
from all branches that the particle belongs to</p>
</section>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="kanapy.core.entities.Octree.subdivide">
<span class="sig-name descname"><span class="pre">subdivide</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/kanapy/core/entities.html#Octree.subdivide"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kanapy.core.entities.Octree.subdivide" title="Link to this definition"></a></dt>
<dd><p>Divide the Octree sub-branch into eight further sub-branches and initialize each as an Octree object</p>
<section id="id250">
<h4>Notes<a class="headerlink" href="#id250" title="Link to this heading"></a></h4>
<p>Each newly created sub-branch is appended to the branches list of the current Octree</p>
</section>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="kanapy.core.entities.Octree.subdivide_particles">
<span class="sig-name descname"><span class="pre">subdivide_particles</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/kanapy/core/entities.html#Octree.subdivide_particles"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kanapy.core.entities.Octree.subdivide_particles" title="Link to this definition"></a></dt>
<dd><p>Evaluate which ellipsoids belong to each Octree sub-branch by checking intersections</p>
<section id="id251">
<h4>Notes<a class="headerlink" href="#id251" title="Link to this heading"></a></h4>
<p>Calls the intersect method of each sub-branch cuboid with each particle cuboid
and adds the particle to the sub-branch if an intersection occurs</p>
</section>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="kanapy.core.entities.Octree.update">
<span class="sig-name descname"><span class="pre">update</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/kanapy/core/entities.html#Octree.update"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kanapy.core.entities.Octree.update" title="Link to this definition"></a></dt>
<dd><p>Update the Octree and begin recursive subdivision or particle assignment</p>
<section id="id252">
<h4>Notes<a class="headerlink" href="#id252" title="Link to this heading"></a></h4>
<p>If the number of particles exceeds the maximum allowed and the current
level is below the maximum, the sub-branch is subdivided and particles
are distributed among the new branches. Otherwise, particles are
associated with this branch</p>
</section>
</dd></dl>

</section>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="kanapy.core.entities.Simulation_Box">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">kanapy.core.entities.</span></span><span class="sig-name descname"><span class="pre">Simulation_Box</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">size</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/kanapy/core/entities.html#Simulation_Box"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kanapy.core.entities.Simulation_Box" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Represents a 3D simulation domain box</p>
<p>This class defines the simulation box dimensions and boundaries,
and keeps track of the simulation time step.</p>
<section id="id253">
<h3>Parameters<a class="headerlink" href="#id253" title="Link to this heading"></a></h3>
<dl class="simple">
<dt>size<span class="classifier">tuple of float</span></dt><dd><p>Dimensions of the box as (width, height, depth).</p>
</dd>
</dl>
</section>
<section id="id254">
<h3>Attributes<a class="headerlink" href="#id254" title="Link to this heading"></a></h3>
<dl class="simple">
<dt>w<span class="classifier">float</span></dt><dd><p>Width of the box.</p>
</dd>
<dt>h<span class="classifier">float</span></dt><dd><p>Height of the box.</p>
</dd>
<dt>d<span class="classifier">float</span></dt><dd><p>Depth of the box.</p>
</dd>
<dt>sim_ts<span class="classifier">int</span></dt><dd><p>Current simulation time-step, initialized to 0.</p>
</dd>
<dt>left<span class="classifier">float</span></dt><dd><p>Position of the left boundary, initialized to 0.</p>
</dd>
<dt>top<span class="classifier">float</span></dt><dd><p>Position of the top boundary, initialized to 0.</p>
</dd>
<dt>front<span class="classifier">float</span></dt><dd><p>Position of the front boundary, initialized to 0.</p>
</dd>
<dt>right<span class="classifier">float</span></dt><dd><p>Position of the right boundary, initialized to width.</p>
</dd>
<dt>bottom<span class="classifier">float</span></dt><dd><p>Position of the bottom boundary, initialized to height.</p>
</dd>
<dt>back<span class="classifier">float</span></dt><dd><p>Position of the back boundary, initialized to depth.</p>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="kanapy.core.entities.cub_oct_split">
<span class="sig-prename descclassname"><span class="pre">kanapy.core.entities.</span></span><span class="sig-name descname"><span class="pre">cub_oct_split</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cub</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/kanapy/core/entities.html#cub_oct_split"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kanapy.core.entities.cub_oct_split" title="Link to this definition"></a></dt>
<dd><p>Splits cuboid object of the class <a class="reference internal" href="#kanapy.core.entities.Cuboid" title="kanapy.core.entities.Cuboid"><code class="xref py py-class docutils literal notranslate"><span class="pre">Cuboid</span></code></a> into eight smaller cuboid objects</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>cub</strong> (object of the class <a class="reference internal" href="#kanapy.core.entities.Cuboid" title="kanapy.core.entities.Cuboid"><code class="xref py py-class docutils literal notranslate"><span class="pre">Cuboid</span></code></a>) – Branch cuboid object containing ellipsoids</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Eight new sub-branch cuboid objects in a list</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>List</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-kanapy.core.collisions">
<span id="module-collisions"></span><h2>Module collisions<a class="headerlink" href="#module-kanapy.core.collisions" title="Link to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="kanapy.core.collisions.collide_detect">
<span class="sig-prename descclassname"><span class="pre">kanapy.core.collisions.</span></span><span class="sig-name descname"><span class="pre">collide_detect</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">coef_i</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">coef_j</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">r_i</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">r_j</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">A_i</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">A_j</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/kanapy/core/collisions.html#collide_detect"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kanapy.core.collisions.collide_detect" title="Link to this definition"></a></dt>
<dd><p>Determines overlap between two static ellipsoids using the Algebraic Separation Condition
developed by W. Wang et al., 2001. This function implements the method for two ellipsoids
with given coefficients, positions, and rotation matrices</p>
<section id="id255">
<h3>Parameters<a class="headerlink" href="#id255" title="Link to this heading"></a></h3>
<dl class="simple">
<dt>coef_i<span class="classifier">numpy array</span></dt><dd><p>Coefficients of ellipsoid i</p>
</dd>
<dt>coef_j<span class="classifier">numpy array</span></dt><dd><p>Coefficients of ellipsoid j</p>
</dd>
<dt>r_i<span class="classifier">numpy array</span></dt><dd><p>Position vector of ellipsoid i</p>
</dd>
<dt>r_j<span class="classifier">numpy array</span></dt><dd><p>Position vector of ellipsoid j</p>
</dd>
<dt>A_i<span class="classifier">numpy array</span></dt><dd><p>Rotation matrix of ellipsoid i</p>
</dd>
<dt>A_j<span class="classifier">numpy array</span></dt><dd><p>Rotation matrix of ellipsoid j</p>
</dd>
</dl>
</section>
<section id="id256">
<h3>Returns<a class="headerlink" href="#id256" title="Link to this heading"></a></h3>
<dl class="simple">
<dt>bool</dt><dd><p>True if ellipsoids i and j overlap, False otherwise</p>
</dd>
</dl>
</section>
<section id="id257">
<h3>Notes<a class="headerlink" href="#id257" title="Link to this heading"></a></h3>
<p>The method calculates the characteristic polynomial based on the ellipsoid coefficients
and rigid body transformations. Roots of this polynomial are used with the Algebraic
Separation Condition to determine whether the ellipsoids intersect. Real roots with
negative values are analyzed to establish the overlap.</p>
</section>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="kanapy.core.collisions.collision_react">
<span class="sig-prename descclassname"><span class="pre">kanapy.core.collisions.</span></span><span class="sig-name descname"><span class="pre">collision_react</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ell1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ell2</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/kanapy/core/collisions.html#collision_react"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kanapy.core.collisions.collision_react" title="Link to this definition"></a></dt>
<dd><p>Evaluates and modifies the magnitude and direction of the ellipsoid’s velocity after collision</p>
<section id="id258">
<h3>Parameters<a class="headerlink" href="#id258" title="Link to this heading"></a></h3>
<dl class="simple">
<dt>ell1<span class="classifier">Ellipsoid</span></dt><dd><p>Ellipsoid i</p>
</dd>
<dt>ell2<span class="classifier">Ellipsoid</span></dt><dd><p>Ellipsoid j</p>
</dd>
</dl>
</section>
<section id="id259">
<h3>Notes<a class="headerlink" href="#id259" title="Link to this heading"></a></h3>
<p>Consider two ellipsoids i, j at collision. Let them occupy certain positions in space
defined by the position vectors r^i, r^j and have certain velocities represented by v^i, v^j
respectively. The objective is to find the velocity vectors after collision. The elevation angle φ
between the ellipsoids is determined by:</p>
<a class="reference internal image-reference" href="_images/elevation_ell.png"><img alt="_images/elevation_ell.png" class="align-center" src="_images/elevation_ell.png" style="width: 200px; height: 45px;" />
</a>
<p>where dx, dy, dz are defined as the distance between the two ellipsoid centers along
x, y, z directions given by:</p>
<a class="reference internal image-reference" href="_images/dist_ell.png"><img alt="_images/dist_ell.png" class="align-center" src="_images/dist_ell.png" style="width: 110px; height: 75px;" />
</a>
<p>Depending on the magnitudes of dx, dz as projected on the x-z plane, the angle Θ is computed.
The angles Θ and φ determine the in-plane and out-of-plane directions along which
ellipsoid i would bounce back after collision. Thus, the updated velocity vector components
along the x, y, z directions are determined by:</p>
<a class="reference internal image-reference" href="_images/velocities_ell.png"><img alt="_images/velocities_ell.png" class="align-center" src="_images/velocities_ell.png" style="width: 180px; height: 80px;" />
</a>
</section>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="kanapy.core.collisions.collision_routine">
<span class="sig-prename descclassname"><span class="pre">kanapy.core.collisions.</span></span><span class="sig-name descname"><span class="pre">collision_routine</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">E1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">E2</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/kanapy/core/collisions.html#collision_routine"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kanapy.core.collisions.collision_routine" title="Link to this definition"></a></dt>
<dd><p>Detect and handle collision between two ellipsoid objects</p>
<p>Uses the algebraic separation condition by W. Wang et al. to detect overlap
between two ellipsoids, and if a collision occurs, computes the contact
response via the <cite>collision_react</cite> method.</p>
<section id="id260">
<h3>Parameters<a class="headerlink" href="#id260" title="Link to this heading"></a></h3>
<dl class="simple">
<dt>E1<span class="classifier">Ellipsoid</span></dt><dd><p>First ellipsoid object (particle i)</p>
</dd>
<dt>E2<span class="classifier">Ellipsoid</span></dt><dd><p>Second ellipsoid object (particle j)</p>
</dd>
</dl>
</section>
<section id="id261">
<h3>Returns<a class="headerlink" href="#id261" title="Link to this heading"></a></h3>
<dl class="simple">
<dt>bool</dt><dd><p>True if overlap (collision) is detected, False otherwise</p>
</dd>
</dl>
</section>
<section id="id262">
<h3>Notes<a class="headerlink" href="#id262" title="Link to this heading"></a></h3>
<ul class="simple">
<li><p>If both particles are spheres, the bounding sphere hierarchy alone
suffices to detect collision.</p></li>
<li><p>If either particle is an ellipsoid, their coefficients, positions,
and rotation matrices are used in the overlap test.</p></li>
</ul>
</section>
</dd></dl>

</section>
<section id="module-kanapy.core.voxelization">
<span id="module-voxelization"></span><h2>Module voxelization<a class="headerlink" href="#module-kanapy.core.voxelization" title="Link to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="kanapy.core.voxelization.assign_voxels_to_ellipsoid">
<span class="sig-prename descclassname"><span class="pre">kanapy.core.voxelization.</span></span><span class="sig-name descname"><span class="pre">assign_voxels_to_ellipsoid</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cooDict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Ellipsoids</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">voxel_dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vf_target</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/kanapy/core/voxelization.html#assign_voxels_to_ellipsoid"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kanapy.core.voxelization.assign_voxels_to_ellipsoid" title="Link to this definition"></a></dt>
<dd><p>Assign voxels to each ellipsoid based on spatial position and shared nodes</p>
<p>Iteratively grows each ellipsoid and assigns voxels whose centers lie
within the ellipsoid’s convex hull. Voxels are additionally checked
to share at least 4 nodes with existing voxels of the ellipsoid to
ensure connectivity.</p>
<section id="id263">
<h3>Parameters<a class="headerlink" href="#id263" title="Link to this heading"></a></h3>
<dl class="simple">
<dt>cooDict<span class="classifier">dict</span></dt><dd><p>Voxel dictionary containing voxel IDs as keys and center coordinates
as values</p>
</dd>
<dt>Ellipsoids<span class="classifier">list</span></dt><dd><p>List of ellipsoid objects from the packing routine. Each object must
support <cite>.a</cite>, <cite>.b</cite>, <cite>.c</cite> attributes and <cite>.surfacePointsGen()</cite> and <cite>.get_pos()</cite> methods</p>
</dd>
<dt>voxel_dict<span class="classifier">dict</span></dt><dd><p>Element dictionary containing voxel IDs as keys and lists of nodal
connectivity as values</p>
</dd>
<dt>vf_target<span class="classifier">float, optional</span></dt><dd><p>Target volume fraction of particles to be assigned (default is 1.0)</p>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="kanapy.core.voxelization.points_in_convexHull">
<span class="sig-prename descclassname"><span class="pre">kanapy.core.voxelization.</span></span><span class="sig-name descname"><span class="pre">points_in_convexHull</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Points</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hull</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/kanapy/core/voxelization.html#points_in_convexHull"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kanapy.core.voxelization.points_in_convexHull" title="Link to this definition"></a></dt>
<dd><p>Determine whether the given array of points lie inside the convex hull</p>
<p>Checks if each point in <cite>Points</cite> is inside or outside the convex hull defined
by <cite>hull</cite>. Returns a boolean array with True for points inside the hull and False otherwise.</p>
<section id="id264">
<h3>Parameters<a class="headerlink" href="#id264" title="Link to this heading"></a></h3>
<dl class="simple">
<dt>Points<span class="classifier">ndarray, shape (N_points, dim)</span></dt><dd><p>Array of points to be tested</p>
</dd>
<dt>hull<span class="classifier">scipy.spatial.ConvexHull</span></dt><dd><p>Convex hull object representing an ellipsoid or other shape</p>
</dd>
</dl>
</section>
<section id="id265">
<h3>Returns<a class="headerlink" href="#id265" title="Link to this heading"></a></h3>
<dl class="simple">
<dt>ndarray, shape (N_points,)</dt><dd><p>Boolean array indicating whether each point is inside the convex hull</p>
</dd>
</dl>
</section>
<section id="see-also">
<h3>See Also<a class="headerlink" href="#see-also" title="Link to this heading"></a></h3>
<p><a class="reference external" href="https://stackoverflow.com/questions/21698630/how-can-i-find-if-a-point-lies-inside-or-outside-of-convexhull">https://stackoverflow.com/questions/21698630/how-can-i-find-if-a-point-lies-inside-or-outside-of-convexhull</a></p>
</section>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="kanapy.core.voxelization.reassign_shared_voxels">
<span class="sig-prename descclassname"><span class="pre">kanapy.core.voxelization.</span></span><span class="sig-name descname"><span class="pre">reassign_shared_voxels</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cooDict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Ellipsoids</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">voxel_dict</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/kanapy/core/voxelization.html#reassign_shared_voxels"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kanapy.core.voxelization.reassign_shared_voxels" title="Link to this definition"></a></dt>
<dd><p>Reassign shared voxels among ellipsoids to the most appropriate ellipsoid based on node overlap
and proximity to ellipsoid centers</p>
<p>This function identifies voxels that are contained within multiple ellipsoids and resolves
conflicts by:
1. Removing the shared voxel from all ellipsoids initially.
2. Assigning the voxel to the ellipsoid with the largest number of shared nodes.
3. If multiple ellipsoids have the same node overlap, assigning the voxel to the closest</p>
<blockquote>
<div><p>ellipsoid based on center distance.</p>
</div></blockquote>
<ol class="arabic simple" start="4">
<li><p>If still tied, assigning to the ellipsoid with the smallest volume.</p></li>
</ol>
<section id="id266">
<h3>Parameters<a class="headerlink" href="#id266" title="Link to this heading"></a></h3>
<dl class="simple">
<dt>cooDict<span class="classifier">dict</span></dt><dd><p>Dictionary mapping voxel IDs to their coordinates in 3D space.
Example: {voxel_id: [x, y, z], …}</p>
</dd>
<dt>Ellipsoids<span class="classifier">list</span></dt><dd><p>List of ellipsoid objects from the packing routine. Each ellipsoid must have attributes:
- <cite>inside_voxels</cite> (list of voxel IDs contained in the ellipsoid)
- <cite>id</cite> (unique identifier)
- <cite>get_pos()</cite> method returning the ellipsoid center coordinates as [x, y, z]
- <cite>get_volume()</cite> method returning the ellipsoid volume</p>
</dd>
<dt>voxel_dict<span class="classifier">dict</span></dt><dd><p>Dictionary mapping voxel IDs to the node IDs that define the voxel.
Example: {voxel_id: [node1, node2, …], …}</p>
</dd>
</dl>
</section>
<section id="id267">
<h3>Notes<a class="headerlink" href="#id267" title="Link to this heading"></a></h3>
<ul class="simple">
<li><p>The reassignment loop has a maximum of 5 cycles to avoid infinite loops in edge cases.</p></li>
<li><p>A voxel is assigned to an ellipsoid only if it has at least 4 nodes in common with it.</p></li>
<li><p>Distance calculations assume Cartesian coordinates.</p></li>
<li><p>The function can handle ties in node overlap by considering proximity and volume.</p></li>
<li><p>Modifies <cite>inside_voxels</cite> lists of ellipsoids in place.</p></li>
</ul>
</section>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="kanapy.core.voxelization.voxelizationRoutine">
<span class="sig-prename descclassname"><span class="pre">kanapy.core.voxelization.</span></span><span class="sig-name descname"><span class="pre">voxelizationRoutine</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Ellipsoids</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mesh</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nphases</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prec_vf</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/kanapy/core/voxelization.html#voxelizationRoutine"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kanapy.core.voxelization.voxelizationRoutine" title="Link to this definition"></a></dt>
<dd><p>Perform voxelization of a microstructure defined by ellipsoids and mesh.</p>
<p>This function controls the voxelization process by calling several subroutines:
- <code class="xref py py-meth docutils literal notranslate"><span class="pre">kanapy.input_output.read_dump()</span></code>
- <code class="xref py py-meth docutils literal notranslate"><span class="pre">create_voxels()</span></code>
- <a class="reference internal" href="#kanapy.core.voxelization.assign_voxels_to_ellipsoid" title="kanapy.core.voxelization.assign_voxels_to_ellipsoid"><code class="xref py py-meth docutils literal notranslate"><span class="pre">assign_voxels_to_ellipsoid()</span></code></a>
- <a class="reference internal" href="#kanapy.core.voxelization.reassign_shared_voxels" title="kanapy.core.voxelization.reassign_shared_voxels"><code class="xref py py-meth docutils literal notranslate"><span class="pre">reassign_shared_voxels()</span></code></a></p>
<p>Depending on whether ellipsoids have inner polygons, it either assigns voxels
directly to ellipsoids or uses polygon-based voxel assignment.</p>
<p>The function also generates:
- <cite>mesh.grains</cite>: array of voxelized structure with grain IDs
- <cite>mesh.phases</cite>: array of voxelized structure with phase numbers
- <cite>mesh.grain_dict</cite>: dictionary mapping grain IDs to voxel IDs
- <cite>mesh.grain_phase_dict</cite>: dictionary mapping grain IDs to phase numbers
- <cite>mesh.ngrains_phase</cite>: count of grains per phase
- <cite>mesh.prec_vf_voxels</cite>: current volume fraction if <cite>prec_vf</cite> is provided</p>
<section id="id268">
<h3>Parameters<a class="headerlink" href="#id268" title="Link to this heading"></a></h3>
<dl class="simple">
<dt>Ellipsoids<span class="classifier">list</span></dt><dd><p>List of ellipsoid objects representing grains. Each ellipsoid should have:
- <cite>inside_voxels</cite> (list of voxel IDs)
- <cite>duplicate</cite> (ID of original ellipsoid if duplicated, else None)
- <cite>inner</cite> (optional polygon object)
- <cite>phasenum</cite> (phase number)
- <cite>get_pos()</cite> and <cite>create_poly()</cite> methods.</p>
</dd>
<dt>mesh<span class="classifier">object</span></dt><dd><p>Mesh object containing voxel information, including:
- <cite>vox_center_dict</cite> (voxel centers)
- <cite>voxel_dict</cite> (voxel-to-node mapping)
- <cite>nvox</cite> (number of voxels)
- <cite>dim</cite> (mesh dimensions)</p>
</dd>
<dt>nphases<span class="classifier">int</span></dt><dd><p>Number of phases in the RVE.</p>
</dd>
<dt>prec_vf<span class="classifier">float, optional</span></dt><dd><p>Target volume fraction for precipitates/porosity. Defaults to <cite>None</cite> (fully filled RVE).</p>
</dd>
</dl>
</section>
<section id="id269">
<h3>Notes<a class="headerlink" href="#id269" title="Link to this heading"></a></h3>
<ul class="simple">
<li><p>Voxels shared by multiple ellipsoids are resolved using <cite>reassign_shared_voxels</cite>.</p></li>
<li><p>Voxels not assigned to any grain are either assigned to neighbors or set to phase 1.</p></li>
<li><p>If <cite>prec_vf</cite> &lt; 1.0, empty voxels are treated as dispersed phase (precipitates/porosity).</p></li>
<li><p>The function modifies the <cite>mesh</cite> object in place.</p></li>
</ul>
</section>
<section id="id270">
<h3>Returns<a class="headerlink" href="#id270" title="Link to this heading"></a></h3>
<dl class="simple">
<dt>mesh</dt><dd><p>The input mesh object with updated voxelized grain and phase information.</p>
</dd>
</dl>
</section>
</dd></dl>

</section>
<section id="module-kanapy.core.grains">
<span id="module-grains"></span><h2>Module grains<a class="headerlink" href="#module-kanapy.core.grains" title="Link to this heading"></a></h2>
<p>Subroutines for analysis of grains in microstructure</p>
<p>&#64;author: Alexander Hartmaier
ICAMS, Ruhr University Bochum, Germany
March 2024</p>
<dl class="py function">
<dt class="sig sig-object py" id="kanapy.core.grains.calc_polygons">
<span class="sig-prename descclassname"><span class="pre">kanapy.core.grains.</span></span><span class="sig-name descname"><span class="pre">calc_polygons</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rve</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mesh</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.001</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/kanapy/core/grains.html#calc_polygons"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kanapy.core.grains.calc_polygons" title="Link to this definition"></a></dt>
<dd><p>Evaluates grain volumes and the shared surface area of grain boundaries
between neighboring grains in a voxelized microstructure. Generates
vertices at contact points where three or more grains meet and constructs
polyhedral convex hulls for these vertices.</p>
<section id="id271">
<h3>Parameters<a class="headerlink" href="#id271" title="Link to this heading"></a></h3>
<dl class="simple">
<dt>rve<span class="classifier">kanapy object</span></dt><dd><p>Object containing information about the RVE geometry.</p>
</dd>
<dt>mesh<span class="classifier">kanapy object</span></dt><dd><p>Object containing voxel mesh details and grain assignments for each voxel.</p>
</dd>
<dt>tol<span class="classifier">float, optional</span></dt><dd><p>Tolerance for numerical operations. Default is 1.e-3.</p>
</dd>
</dl>
</section>
<section id="id272">
<h3>Returns<a class="headerlink" href="#id272" title="Link to this heading"></a></h3>
<dl class="simple">
<dt>geometry<span class="classifier">dict</span></dt><dd><p>Dictionary containing the calculated geometrical information, including
vertices, contact points, and convex hulls for grains.</p>
</dd>
</dl>
</section>
<section id="id273">
<h3>Notes<a class="headerlink" href="#id273" title="Link to this heading"></a></h3>
<p>For periodic structures, large grains spanning both halves of the simulation
box and touching a boundary may be incorrectly split, which can affect
geometry calculations.</p>
</section>
</dd></dl>

</section>
<section id="module-kanapy.core.rve_stats">
<span id="module-rve-stats"></span><h2>Module rve_stats<a class="headerlink" href="#module-kanapy.core.rve_stats" title="Link to this heading"></a></h2>
<dl class="simple">
<dt>Subroutines for analysis of statistical descriptors of RVEs:</dt><dd><ul class="simple">
<li><p>original particles (or their inner polyhedra)</p></li>
<li><p>voxel structure</p></li>
<li><p>polyhedral grain structure</p></li>
</ul>
</dd>
</dl>
<p>&#64;author: Alexander Hartmaier
ICAMS, Ruhr University Bochum, Germany
March 2024</p>
<dl class="py function">
<dt class="sig sig-object py" id="kanapy.core.rve_stats.arr2mat">
<span class="sig-prename descclassname"><span class="pre">kanapy.core.rve_stats.</span></span><span class="sig-name descname"><span class="pre">arr2mat</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mc</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/kanapy/core/rve_stats.html#arr2mat"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kanapy.core.rve_stats.arr2mat" title="Link to this definition"></a></dt>
<dd><p>Convert a 6-element numpy array into a 3x3 symmetric matrix</p>
<section id="id274">
<h3>Parameters<a class="headerlink" href="#id274" title="Link to this heading"></a></h3>
<dl class="simple">
<dt>mc<span class="classifier">array-like of length 6</span></dt><dd><p>Input array containing the elements of a symmetric matrix in Voigt notation:
[M11, M22, M33, M23, M13, M12]</p>
</dd>
</dl>
</section>
<section id="id275">
<h3>Returns<a class="headerlink" href="#id275" title="Link to this heading"></a></h3>
<dl class="simple">
<dt>mat<span class="classifier">ndarray of shape (3, 3)</span></dt><dd><p>Symmetric 3x3 matrix corresponding to the input array</p>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="kanapy.core.rve_stats.bbox">
<span class="sig-prename descclassname"><span class="pre">kanapy.core.rve_stats.</span></span><span class="sig-name descname"><span class="pre">bbox</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pts</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_vector</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">two_dim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/kanapy/core/rve_stats.html#bbox"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kanapy.core.rve_stats.bbox" title="Link to this definition"></a></dt>
<dd><p>Approximate the smallest rectangular cuboid around points of a grain</p>
<p>The function computes the principal axes and lengths of a cuboid
that encloses the grain, allowing analysis of prolate (aspect ratio &gt; 1)
and oblate (aspect ratio &lt; 1) particles. For 2D points, only two axes are returned.</p>
<section id="id276">
<h3>Parameters<a class="headerlink" href="#id276" title="Link to this heading"></a></h3>
<dl class="simple">
<dt>pts<span class="classifier">(N, dim) ndarray</span></dt><dd><p>Coordinates of points representing the grain</p>
</dd>
<dt>return_vector<span class="classifier">bool, default=False</span></dt><dd><p>If True, return the unit vectors along each principal axis</p>
</dd>
<dt>two_dim<span class="classifier">bool, default=False</span></dt><dd><p>If True, treat points as 2D; otherwise, treat as 3D</p>
</dd>
</dl>
</section>
<section id="id277">
<h3>Returns<a class="headerlink" href="#id277" title="Link to this heading"></a></h3>
<dl class="simple">
<dt>If two_dim is True:</dt><dd><dl class="simple">
<dt>len_a<span class="classifier">float</span></dt><dd><p>Semi-major axis length</p>
</dd>
<dt>len_b<span class="classifier">float</span></dt><dd><p>Semi-minor axis length</p>
</dd>
<dt>ax_a<span class="classifier">(dim,) ndarray, optional</span></dt><dd><p>Unit vector along major axis (only if return_vector=True)</p>
</dd>
<dt>ax_b<span class="classifier">(dim,) ndarray, optional</span></dt><dd><p>Unit vector along minor axis (only if return_vector=True)</p>
</dd>
</dl>
</dd>
<dt>If two_dim is False:</dt><dd><dl class="simple">
<dt>len_a<span class="classifier">float</span></dt><dd><p>Semi-major axis length</p>
</dd>
<dt>len_b<span class="classifier">float</span></dt><dd><p>Semi-intermediate axis length</p>
</dd>
<dt>len_c<span class="classifier">float</span></dt><dd><p>Semi-minor axis length</p>
</dd>
<dt>ax_a<span class="classifier">(3,) ndarray, optional</span></dt><dd><p>Unit vector along major axis (only if return_vector=True)</p>
</dd>
<dt>ax_b<span class="classifier">(3,) ndarray, optional</span></dt><dd><p>Unit vector along intermediate axis (only if return_vector=True)</p>
</dd>
<dt>ax_c<span class="classifier">(3,) ndarray, optional</span></dt><dd><p>Unit vector along minor axis (only if return_vector=True)</p>
</dd>
</dl>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="kanapy.core.rve_stats.calc_stats_dict">
<span class="sig-prename descclassname"><span class="pre">kanapy.core.rve_stats.</span></span><span class="sig-name descname"><span class="pre">calc_stats_dict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">c</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eqd</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/kanapy/core/rve_stats.html#calc_stats_dict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kanapy.core.rve_stats.calc_stats_dict" title="Link to this definition"></a></dt>
<dd><p>Calculate statistical descriptors of grain semi-axes and equivalent diameters</p>
<p>Computes log-normal parameters, identifies the rotation axis, and calculates aspect ratios
for a set of grain semi-axes and equivalent diameters.</p>
<section id="id278">
<h3>Parameters<a class="headerlink" href="#id278" title="Link to this heading"></a></h3>
<dl class="simple">
<dt>a<span class="classifier">ndarray</span></dt><dd><p>Array of semi-axis a lengths</p>
</dd>
<dt>b<span class="classifier">ndarray</span></dt><dd><p>Array of semi-axis b lengths</p>
</dd>
<dt>c<span class="classifier">ndarray</span></dt><dd><p>Array of semi-axis c lengths</p>
</dd>
<dt>eqd<span class="classifier">ndarray</span></dt><dd><p>Array of equivalent diameters</p>
</dd>
</dl>
</section>
<section id="id279">
<h3>Returns<a class="headerlink" href="#id279" title="Link to this heading"></a></h3>
<dl class="simple">
<dt>sd<span class="classifier">dict</span></dt><dd><p>Dictionary containing sorted semi-axes, equivalent diameters, their log-normal
parameters (sigma and scale), rotation axis index, aspect ratios, and related statistics</p>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="kanapy.core.rve_stats.con_fun">
<span class="sig-prename descclassname"><span class="pre">kanapy.core.rve_stats.</span></span><span class="sig-name descname"><span class="pre">con_fun</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mc</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/kanapy/core/rve_stats.html#con_fun"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kanapy.core.rve_stats.con_fun" title="Link to this definition"></a></dt>
<dd><p>Constraint function: penalizes non-positive-definite matrices</p>
<p>For a symmetric matrix, all eigenvalues must be positive. This constraint
returns a large negative value if the matrix has negative eigenvalues.</p>
<section id="id280">
<h3>Parameters<a class="headerlink" href="#id280" title="Link to this heading"></a></h3>
<dl class="simple">
<dt>mc<span class="classifier">array-like of length 6</span></dt><dd><p>Input array representing a symmetric 3x3 matrix in Voigt notation</p>
</dd>
</dl>
</section>
<section id="id281">
<h3>Returns<a class="headerlink" href="#id281" title="Link to this heading"></a></h3>
<dl class="simple">
<dt>float</dt><dd><p>The smallest eigenvalue multiplied by 1000, serving as a penalty for
negative eigenvalues</p>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="kanapy.core.rve_stats.find_rot_axis">
<span class="sig-prename descclassname"><span class="pre">kanapy.core.rve_stats.</span></span><span class="sig-name descname"><span class="pre">find_rot_axis</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">len_a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">len_b</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">len_c</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/kanapy/core/rve_stats.html#find_rot_axis"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kanapy.core.rve_stats.find_rot_axis" title="Link to this definition"></a></dt>
<dd><p>Determine the rotation axis of an ellipsoid based on its three semi-axes</p>
<p>The function identifies the axis of approximate rotational symmetry. If no
clear symmetry is found, the longest axis is chosen as the rotation axis.</p>
<section id="id282">
<h3>Parameters<a class="headerlink" href="#id282" title="Link to this heading"></a></h3>
<dl class="simple">
<dt>len_a<span class="classifier">float</span></dt><dd><p>Length of the first semi-axis</p>
</dd>
<dt>len_b<span class="classifier">float</span></dt><dd><p>Length of the second semi-axis</p>
</dd>
<dt>len_c<span class="classifier">float</span></dt><dd><p>Length of the third semi-axis</p>
</dd>
</dl>
</section>
<section id="id283">
<h3>Returns<a class="headerlink" href="#id283" title="Link to this heading"></a></h3>
<dl class="simple">
<dt>irot<span class="classifier">int</span></dt><dd><p>Index of the rotation axis (0 for a, 1 for b, 2 for c)</p>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="kanapy.core.rve_stats.get_diameter">
<span class="sig-prename descclassname"><span class="pre">kanapy.core.rve_stats.</span></span><span class="sig-name descname"><span class="pre">get_diameter</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pts</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/kanapy/core/rve_stats.html#get_diameter"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kanapy.core.rve_stats.get_diameter" title="Link to this definition"></a></dt>
<dd><p>Estimate the largest diameter of a set of points along Cartesian axes</p>
<section id="id284">
<h3>Parameters<a class="headerlink" href="#id284" title="Link to this heading"></a></h3>
<dl class="simple">
<dt>pts<span class="classifier">ndarray, shape (N, dim)</span></dt><dd><p>Point set in dim dimensions</p>
</dd>
</dl>
</section>
<section id="id285">
<h3>Returns<a class="headerlink" href="#id285" title="Link to this heading"></a></h3>
<dl class="simple">
<dt>diameter<span class="classifier">ndarray, shape (dim,)</span></dt><dd><p>Vector connecting the two points with the largest separation along
the axis of maximum extent</p>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="kanapy.core.rve_stats.get_grain_geom">
<span class="sig-prename descclassname"><span class="pre">kanapy.core.rve_stats.</span></span><span class="sig-name descname"><span class="pre">get_grain_geom</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">points</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'raw'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">two_dim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/kanapy/core/rve_stats.html#get_grain_geom"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kanapy.core.rve_stats.get_grain_geom" title="Link to this definition"></a></dt>
<dd><p>Fit an ellipse to the 2D convex hull of grain pixels</p>
<p>Depending on the chosen method, the ellipse can be obtained from
direct fitting, PCA, or a rectangular bounding box. Currently,
3D grains are not supported.</p>
<section id="id286">
<h3>Parameters<a class="headerlink" href="#id286" title="Link to this heading"></a></h3>
<dl class="simple">
<dt>points<span class="classifier">(N, 2) ndarray</span></dt><dd><p>Coordinates of points on the grain hull</p>
</dd>
<dt>method<span class="classifier">str, default=’raw’</span></dt><dd><p>Method to obtain ellipse parameters:
- ‘raw’: rectangular bounding box
- ‘pca’: principal component analysis
- ‘ell’, ‘ellipsis’, ‘e’: direct ellipse fitting</p>
</dd>
<dt>two_dim<span class="classifier">bool, default=False</span></dt><dd><p>If True, process as 2D data; 3D is not yet implemented</p>
</dd>
</dl>
</section>
<section id="id287">
<h3>Returns<a class="headerlink" href="#id287" title="Link to this heading"></a></h3>
<dl class="simple">
<dt>ea<span class="classifier">float</span></dt><dd><p>Semi-major axis length (a &gt;= b)</p>
</dd>
<dt>eb<span class="classifier">float</span></dt><dd><p>Semi-minor axis length</p>
</dd>
<dt>va<span class="classifier">(2,) ndarray</span></dt><dd><p>Unit vector along the major axis</p>
</dd>
<dt>vb<span class="classifier">(2,) ndarray</span></dt><dd><p>Unit vector along the minor axis</p>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="kanapy.core.rve_stats.get_ln_param">
<span class="sig-prename descclassname"><span class="pre">kanapy.core.rve_stats.</span></span><span class="sig-name descname"><span class="pre">get_ln_param</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/kanapy/core/rve_stats.html#get_ln_param"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kanapy.core.rve_stats.get_ln_param" title="Link to this definition"></a></dt>
<dd><p>Compute log-normal parameters (sigma and scale) from a dataset</p>
<p>This function calculates the parameters for a log-normal distribution
by taking the logarithm of positive data points and computing the
standard deviation and median-based scale.</p>
<section id="id288">
<h3>Parameters<a class="headerlink" href="#id288" title="Link to this heading"></a></h3>
<dl class="simple">
<dt>data<span class="classifier">array-like</span></dt><dd><p>Input data array. Values should be non-negative.</p>
</dd>
</dl>
</section>
<section id="id289">
<h3>Returns<a class="headerlink" href="#id289" title="Link to this heading"></a></h3>
<dl class="simple">
<dt>sig<span class="classifier">float</span></dt><dd><p>Standard deviation of the log-transformed data</p>
</dd>
<dt>scale<span class="classifier">float</span></dt><dd><p>Scale parameter of the log-normal distribution (exp of median)</p>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="kanapy.core.rve_stats.get_stats_part">
<span class="sig-prename descclassname"><span class="pre">kanapy.core.rve_stats.</span></span><span class="sig-name descname"><span class="pre">get_stats_part</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">part</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">iphase</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ax_max</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">minval</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-05</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show_plot</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_files</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/kanapy/core/rve_stats.html#get_stats_part"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kanapy.core.rve_stats.get_stats_part" title="Link to this definition"></a></dt>
<dd><p>Extract statistics of particles and optionally their inner structures</p>
<p>Fits a 3D ellipsoid to each particle or its inner structure, calculates
semi-axes, equivalent diameters, and statistical descriptors of the microstructure.</p>
<section id="id290">
<h3>Parameters<a class="headerlink" href="#id290" title="Link to this heading"></a></h3>
<dl class="simple">
<dt>part<span class="classifier">list</span></dt><dd><p>List of particle objects, each with attributes <cite>a</cite>, <cite>b</cite>, <cite>c</cite> or <cite>inner.points</cite></p>
</dd>
<dt>iphase<span class="classifier">int, optional</span></dt><dd><p>Phase number to restrict analysis to, default is None (all phases)</p>
</dd>
<dt>ax_max<span class="classifier">float, optional</span></dt><dd><p>Maximum allowed semi-axis, used to adjust minval for numerical stability</p>
</dd>
<dt>minval<span class="classifier">float, optional</span></dt><dd><p>Minimum allowed eigenvalue for positive-definiteness, default 1.e-5</p>
</dd>
<dt>show_plot<span class="classifier">bool, optional</span></dt><dd><p>Whether to display plots of the statistics, default True</p>
</dd>
<dt>verbose<span class="classifier">bool, optional</span></dt><dd><p>If True, print detailed information during processing, default False</p>
</dd>
<dt>save_files<span class="classifier">bool, optional</span></dt><dd><p>If True, save plots as files, default False</p>
</dd>
</dl>
</section>
<section id="id291">
<h3>Returns<a class="headerlink" href="#id291" title="Link to this heading"></a></h3>
<dl class="simple">
<dt>part_stats_dict<span class="classifier">dict</span></dt><dd><p>Dictionary containing semi-axes, equivalent diameters, log-normal parameters,
rotation axis index, aspect ratios, and related statistics</p>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="kanapy.core.rve_stats.get_stats_poly">
<span class="sig-prename descclassname"><span class="pre">kanapy.core.rve_stats.</span></span><span class="sig-name descname"><span class="pre">get_stats_poly</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">grains</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">iphase</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ax_max</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">phase_dict</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">minval</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-05</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show_plot</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_files</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/kanapy/core/rve_stats.html#get_stats_poly"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kanapy.core.rve_stats.get_stats_poly" title="Link to this definition"></a></dt>
<dd><p>Extract statistics about the microstructure from polyhedral grains</p>
<p>Fits a 3D ellipsoid to each polyhedron to compute semi-axes, equivalent diameters,
and other statistical descriptors.</p>
<section id="id292">
<h3>Parameters<a class="headerlink" href="#id292" title="Link to this heading"></a></h3>
<dl class="simple">
<dt>grains<span class="classifier">dict</span></dt><dd><p>Dictionary of polyhedral grains with ‘Points’ for each grain</p>
</dd>
<dt>iphase<span class="classifier">int, optional</span></dt><dd><p>Phase number to restrict analysis to, default is None (all phases)</p>
</dd>
<dt>phase_dict<span class="classifier">dict, optional</span></dt><dd><p>Dictionary mapping grain ID to phase number, required if iphase is provided</p>
</dd>
<dt>ax_max<span class="classifier">float, optional</span></dt><dd><p>Maximum allowed semi-axis, used to adjust minval for numerical stability</p>
</dd>
<dt>minval<span class="classifier">float, optional</span></dt><dd><p>Minimum allowed eigenvalue for positive-definiteness, default 1.e-5</p>
</dd>
<dt>show_plot<span class="classifier">bool, optional</span></dt><dd><p>Whether to display plots of the statistics, default True</p>
</dd>
<dt>verbose<span class="classifier">bool, optional</span></dt><dd><p>If True, print detailed information during processing, default False</p>
</dd>
<dt>save_files<span class="classifier">bool, optional</span></dt><dd><p>If True, save plots as files, default False</p>
</dd>
</dl>
</section>
<section id="id293">
<h3>Returns<a class="headerlink" href="#id293" title="Link to this heading"></a></h3>
<dl class="simple">
<dt>poly_stats_dict<span class="classifier">dict</span></dt><dd><p>Dictionary containing semi-axes, equivalent diameters, log-normal parameters,
rotation axis index, aspect ratios, and related statistics</p>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="kanapy.core.rve_stats.get_stats_vox">
<span class="sig-prename descclassname"><span class="pre">kanapy.core.rve_stats.</span></span><span class="sig-name descname"><span class="pre">get_stats_vox</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mesh</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">iphase</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ax_max</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">minval</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-05</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show_plot</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_files</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/kanapy/core/rve_stats.html#get_stats_vox"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kanapy.core.rve_stats.get_stats_vox" title="Link to this definition"></a></dt>
<dd><p>Extract statistics of the microstructure from voxels</p>
<p>Analyses nodes at grain boundaries, constructs a rectangular bounding box,
and calculates semi-axes, equivalent diameters, and statistical descriptors.</p>
<section id="id294">
<h3>Parameters<a class="headerlink" href="#id294" title="Link to this heading"></a></h3>
<dl class="simple">
<dt>mesh<span class="classifier">object</span></dt><dd><p>Mesh object containing grain and voxel information</p>
</dd>
<dt>iphase<span class="classifier">int, optional</span></dt><dd><p>Phase number to restrict analysis to, default is None (all phases)</p>
</dd>
<dt>ax_max<span class="classifier">float, optional</span></dt><dd><p>Maximum allowed semi-axis, used to adjust minval for numerical stability</p>
</dd>
<dt>minval<span class="classifier">float, optional</span></dt><dd><p>Minimum allowed eigenvalue for positive-definiteness, default 1.e-5</p>
</dd>
<dt>show_plot<span class="classifier">bool, optional</span></dt><dd><p>Whether to display plots of the statistics, default True</p>
</dd>
<dt>verbose<span class="classifier">bool, optional</span></dt><dd><p>If True, print detailed information during processing, default False</p>
</dd>
<dt>save_files<span class="classifier">bool, optional</span></dt><dd><p>If True, save plots as files, default False</p>
</dd>
</dl>
</section>
<section id="id295">
<h3>Returns<a class="headerlink" href="#id295" title="Link to this heading"></a></h3>
<dl class="simple">
<dt>vox_stats_dict<span class="classifier">dict</span></dt><dd><p>Dictionary containing semi-axes, equivalent diameters, log-normal parameters,
rotation axis index, aspect ratios, and related statistics</p>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="kanapy.core.rve_stats.project_pts">
<span class="sig-prename descclassname"><span class="pre">kanapy.core.rve_stats.</span></span><span class="sig-name descname"><span class="pre">project_pts</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pts</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ctr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axis</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/kanapy/core/rve_stats.html#project_pts"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kanapy.core.rve_stats.project_pts" title="Link to this definition"></a></dt>
<dd><p>Project points to a plane defined by a center point and a normal vector</p>
<section id="id296">
<h3>Parameters<a class="headerlink" href="#id296" title="Link to this heading"></a></h3>
<dl class="simple">
<dt>pts<span class="classifier">ndarray, shape (N, dim)</span></dt><dd><p>Point set in dim dimensions</p>
</dd>
<dt>ctr<span class="classifier">ndarray, shape (dim,)</span></dt><dd><p>Center point of the projection plane</p>
</dd>
<dt>axis<span class="classifier">ndarray, shape (dim,)</span></dt><dd><p>Unit vector normal to the plane</p>
</dd>
</dl>
</section>
<section id="id297">
<h3>Returns<a class="headerlink" href="#id297" title="Link to this heading"></a></h3>
<dl class="simple">
<dt>ppt<span class="classifier">ndarray, shape (N, dim)</span></dt><dd><p>Points projected onto the plane</p>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="kanapy.core.rve_stats.pts_in_ellips">
<span class="sig-prename descclassname"><span class="pre">kanapy.core.rve_stats.</span></span><span class="sig-name descname"><span class="pre">pts_in_ellips</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Mcomp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pts</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/kanapy/core/rve_stats.html#pts_in_ellips"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kanapy.core.rve_stats.pts_in_ellips" title="Link to this definition"></a></dt>
<dd><p>Check how well a set of points satisfy the equation of an ellipsoid
(pts - ctr)^T M (pts - ctr) = 1</p>
<section id="id298">
<h3>Parameters<a class="headerlink" href="#id298" title="Link to this heading"></a></h3>
<dl class="simple">
<dt>Mcomp<span class="classifier">array-like, shape (6,)</span></dt><dd><p>Components of a symmetric matrix representing the ellipsoid.</p>
</dd>
<dt>pts<span class="classifier">array-like, shape (N, 3)</span></dt><dd><p>Coordinates of points to be tested.</p>
</dd>
</dl>
</section>
<section id="id299">
<h3>Returns<a class="headerlink" href="#id299" title="Link to this heading"></a></h3>
<dl class="simple">
<dt>score<span class="classifier">float</span></dt><dd><p>Average deviation of points from the ellipsoid equation. Lower values
indicate points are closer to lying on the ellipsoid surface.</p>
</dd>
</dl>
</section>
</dd></dl>

</section>
<section id="module-kanapy.texture">
<span id="module-texture"></span><h2>Module texture<a class="headerlink" href="#module-kanapy.texture" title="Link to this heading"></a></h2>
<p>Tools for analysis of EBSD maps in form of .ang files</p>
<p>&#64;author: Alexander Hartmaier, Abhishek Biswas, ICAMS, Ruhr-Universität Bochum</p>
<dl class="py class">
<dt class="sig sig-object py" id="kanapy.texture.DeLaValleePoussinKernel">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">kanapy.texture.</span></span><span class="sig-name descname"><span class="pre">DeLaValleePoussinKernel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">kappa</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">halfwidth</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bandwidth</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/kanapy/texture.html#DeLaValleePoussinKernel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kanapy.texture.DeLaValleePoussinKernel" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#kanapy.texture.Kernel" title="kanapy.texture.Kernel"><code class="xref py py-class docutils literal notranslate"><span class="pre">Kernel</span></code></a></p>
<p>De La Vallee Poussin kernel class for orientation distribution functions</p>
<section id="id300">
<h3>Parameters<a class="headerlink" href="#id300" title="Link to this heading"></a></h3>
<dl class="simple">
<dt>kappa<span class="classifier">float, optional</span></dt><dd><p>Shape parameter of the kernel</p>
</dd>
<dt>halfwidth<span class="classifier">float, optional</span></dt><dd><p>Halfwidth in radians; overrides kappa if provided</p>
</dd>
<dt>bandwidth<span class="classifier">int, optional</span></dt><dd><p>Maximum degree of the series expansion</p>
</dd>
</dl>
</section>
<section id="id301">
<h3>Attributes<a class="headerlink" href="#id301" title="Link to this heading"></a></h3>
<dl class="simple">
<dt>A<span class="classifier">ndarray</span></dt><dd><p>Series coefficients of the kernel</p>
</dd>
<dt>kappa<span class="classifier">float</span></dt><dd><p>Shape parameter of the kernel</p>
</dd>
<dt>C<span class="classifier">float</span></dt><dd><p>Normalization constant</p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="kanapy.texture.DeLaValleePoussinKernel.DK">
<span class="sig-name descname"><span class="pre">DK</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">co2</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/kanapy/texture.html#DeLaValleePoussinKernel.DK"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kanapy.texture.DeLaValleePoussinKernel.DK" title="Link to this definition"></a></dt>
<dd><p>Evaluate the derivative of the De La Vallee Poussin kernel with respect to misorientation.</p>
<section id="id302">
<h4>Parameters<a class="headerlink" href="#id302" title="Link to this heading"></a></h4>
<dl class="simple">
<dt>co2<span class="classifier">float or ndarray</span></dt><dd><p>Cosine of half the misorientation angle. Values should be in [-1, 1].</p>
</dd>
</dl>
</section>
<section id="id303">
<h4>Returns<a class="headerlink" href="#id303" title="Link to this heading"></a></h4>
<dl class="simple">
<dt>float or ndarray</dt><dd><p>Derivative of the kernel function evaluated at the input <cite>co2</cite>.</p>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="kanapy.texture.DeLaValleePoussinKernel.DRK">
<span class="sig-name descname"><span class="pre">DRK</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/kanapy/texture.html#DeLaValleePoussinKernel.DRK"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kanapy.texture.DeLaValleePoussinKernel.DRK" title="Link to this definition"></a></dt>
<dd><p>Evaluate the derivative of the reduced kernel function R_K at a given input.</p>
<section id="id304">
<h4>Parameters<a class="headerlink" href="#id304" title="Link to this heading"></a></h4>
<dl class="simple">
<dt>t<span class="classifier">float or ndarray</span></dt><dd><p>Input value, typically representing a normalized distance or cosine value.</p>
</dd>
</dl>
</section>
<section id="id305">
<h4>Returns<a class="headerlink" href="#id305" title="Link to this heading"></a></h4>
<dl class="simple">
<dt>float or ndarray</dt><dd><p>Value of the derivative of R_K at <cite>t</cite>.</p>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="kanapy.texture.DeLaValleePoussinKernel.K">
<span class="sig-name descname"><span class="pre">K</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">co2</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/kanapy/texture.html#DeLaValleePoussinKernel.K"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kanapy.texture.DeLaValleePoussinKernel.K" title="Link to this definition"></a></dt>
<dd><p>Evaluate the De La Vallee Poussin kernel function.</p>
<section id="id306">
<h4>Parameters<a class="headerlink" href="#id306" title="Link to this heading"></a></h4>
<dl class="simple">
<dt>co2<span class="classifier">float or ndarray</span></dt><dd><p>Cosine of half the misorientation angle. Values will be clipped to [-1, 1].</p>
</dd>
</dl>
</section>
<section id="id307">
<h4>Returns<a class="headerlink" href="#id307" title="Link to this heading"></a></h4>
<dl class="simple">
<dt>float or ndarray</dt><dd><p>Kernel value(s) evaluated at the input <cite>co2</cite>.</p>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="kanapy.texture.DeLaValleePoussinKernel.RK">
<span class="sig-name descname"><span class="pre">RK</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/kanapy/texture.html#DeLaValleePoussinKernel.RK"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kanapy.texture.DeLaValleePoussinKernel.RK" title="Link to this definition"></a></dt>
<dd><p>Evaluate the reduced kernel function R_K at a given input.</p>
<section id="id308">
<h4>Parameters<a class="headerlink" href="#id308" title="Link to this heading"></a></h4>
<dl class="simple">
<dt>t<span class="classifier">float or ndarray</span></dt><dd><p>Input value, typically representing a normalized distance or cosine value.</p>
</dd>
</dl>
</section>
<section id="id309">
<h4>Returns<a class="headerlink" href="#id309" title="Link to this heading"></a></h4>
<dl class="simple">
<dt>float or ndarray</dt><dd><p>Value of the reduced kernel function R_K at <cite>t</cite>.</p>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="kanapy.texture.DeLaValleePoussinKernel.halfwidth">
<span class="sig-name descname"><span class="pre">halfwidth</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/kanapy/texture.html#DeLaValleePoussinKernel.halfwidth"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kanapy.texture.DeLaValleePoussinKernel.halfwidth" title="Link to this definition"></a></dt>
<dd><p>Compute the halfwidth of the DeLaValleePoussin kernel.</p>
<p>The halfwidth is the misorientation angle ω where the kernel value
drops to half its maximum.</p>
<section id="id310">
<h4>Returns<a class="headerlink" href="#id310" title="Link to this heading"></a></h4>
<dl class="simple">
<dt>float</dt><dd><p>Halfwidth angle in radians.</p>
</dd>
</dl>
</section>
</dd></dl>

</section>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="kanapy.texture.EBSDmap">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">kanapy.texture.</span></span><span class="sig-name descname"><span class="pre">EBSDmap</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fname</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gs_min</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vf_min</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.03</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_angle</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">connectivity</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">8</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show_plot</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show_hist</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">felzenszwalb</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show_grains</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hist</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/kanapy/texture.html#EBSDmap"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kanapy.texture.EBSDmap" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Class to store attributes and methods to import EBSD maps
and filter out their statistical data needed to generate
synthetic RVEs</p>
<section id="id311">
<h3>Parameters<a class="headerlink" href="#id311" title="Link to this heading"></a></h3>
<dl class="simple">
<dt>fname<span class="classifier">str</span></dt><dd><p>Filename including path to EBSD file.</p>
</dd>
<dt>gs_min<span class="classifier">float, optional</span></dt><dd><p>Minimum grain size in pixels. Grains smaller than this are disregarded
for statistical analysis. Default is 10.0.</p>
</dd>
<dt>vf_min<span class="classifier">float, optional</span></dt><dd><p>Minimum volume fraction. Phases with smaller values are disregarded.
Default is 0.03.</p>
</dd>
<dt>max_angle<span class="classifier">float, optional</span></dt><dd><p>Maximum misorientation angle (degrees) used for grain merging.
Default is 5.0.</p>
</dd>
<dt>connectivity<span class="classifier">int, optional</span></dt><dd><p>Connectivity for grain identification. Default is 8.</p>
</dd>
<dt>show_plot<span class="classifier">bool, optional</span></dt><dd><p>If True, plots microstructure maps. Default is True.</p>
</dd>
<dt>show_hist<span class="classifier">bool, optional</span></dt><dd><p>If True, plots histograms of grain statistics. Default follows <cite>show_plot</cite>.</p>
</dd>
<dt>felzenszwalb<span class="classifier">bool, optional</span></dt><dd><p>If True, applies Felzenszwalb segmentation. Default is False.</p>
</dd>
<dt>show_grains<span class="classifier">bool, optional</span></dt><dd><p>If True, plots grain labeling. Default is False.</p>
</dd>
<dt>hist<span class="classifier">bool, optional</span></dt><dd><p>Deprecated. Use <cite>show_hist</cite> instead.</p>
</dd>
<dt>plot<span class="classifier">bool, optional</span></dt><dd><p>Deprecated. Use <cite>show_plot</cite> instead.</p>
</dd>
</dl>
</section>
<section id="id312">
<h3>Attributes<a class="headerlink" href="#id312" title="Link to this heading"></a></h3>
<dl class="simple">
<dt>emap<span class="classifier">object</span></dt><dd><p>Loaded EBSD map object.</p>
</dd>
<dt>sh_x, sh_y<span class="classifier">int</span></dt><dd><p>Shape of EBSD map in pixels.</p>
</dd>
<dt>dx, dy<span class="classifier">float</span></dt><dd><p>Pixel size in microns.</p>
</dd>
<dt>npx<span class="classifier">int</span></dt><dd><p>Total number of pixels in the map.</p>
</dd>
<dt>ms_data<span class="classifier">list of dict</span></dt><dd><p>Phase-specific microstructure information including:
- name : str — phase name
- vf : float — volume fraction
- index : int — phase index
- ori : Orientation — grain orientations
- cs : crystal symmetry / Laue group
- mo_map : ndarray — misorientation field
- rgb_im : ndarray — IPF color image
- ngrains : int — number of grains
- gs_param, ar_param, om_param : ndarray — grain size, aspect ratio, main axis angle parameters
- gs_data, ar_data, om_data : ndarray — raw distributions
- gs_moments, ar_moments, om_moments : list — distribution moments
- graph : object — microstructure graph</p>
</dd>
<dt>ci_map<span class="classifier">ndarray</span></dt><dd><p>Optional confidence index map if available.</p>
</dd>
<dt>ngrains<span class="classifier">int</span></dt><dd><p>Total number of grains after merging/pruning.</p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="kanapy.texture.EBSDmap.calcORI">
<span class="sig-name descname"><span class="pre">calcORI</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Ng</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">iphase</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shared_area</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nbins</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">12</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">res_low</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">res_high</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">25</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">res_step</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">full_output</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/kanapy/texture.html#EBSDmap.calcORI"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kanapy.texture.EBSDmap.calcORI" title="Link to this definition"></a></dt>
<dd><p>Estimate optimum kernel half-width and produce reduced set of
orientations for given number of grains</p>
<section id="id313">
<h4>Parameters<a class="headerlink" href="#id313" title="Link to this heading"></a></h4>
<dl class="simple">
<dt>Ng<span class="classifier">int</span></dt><dd><p>Numbr of grains for which orientation is requested.</p>
</dd>
<dt>iphase<span class="classifier">int, optional</span></dt><dd><p>Phase for which data is requested. The default is 0.</p>
</dd>
<dt>shared_area<span class="classifier">array, optional</span></dt><dd><p>Grain boundary data. The default is None.</p>
</dd>
<dt>nbins<span class="classifier">int, optional</span></dt><dd><p>number of bins for GB texture. The default is 12.</p>
</dd>
</dl>
</section>
<section id="id314">
<h4>Returns<a class="headerlink" href="#id314" title="Link to this heading"></a></h4>
<dl class="simple">
<dt>ori<span class="classifier">(Ng, 3)-array</span></dt><dd><p>Array with Ng Euler angles.</p>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="kanapy.texture.EBSDmap.plot_ci_map">
<span class="sig-name descname"><span class="pre">plot_ci_map</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/kanapy/texture.html#EBSDmap.plot_ci_map"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kanapy.texture.EBSDmap.plot_ci_map" title="Link to this definition"></a></dt>
<dd><p>Plot the confidence index (CI) map of the EBSD data if available</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="kanapy.texture.EBSDmap.plot_felsenszwalb">
<span class="sig-name descname"><span class="pre">plot_felsenszwalb</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/kanapy/texture.html#EBSDmap.plot_felsenszwalb"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kanapy.texture.EBSDmap.plot_felsenszwalb" title="Link to this definition"></a></dt>
<dd><p>Apply Felzenszwalb segmentation to the misorientation map and plot the results</p>
<section id="id315">
<h4>Notes<a class="headerlink" href="#id315" title="Link to this heading"></a></h4>
<p>Segments the misorientation map using the Felzenszwalb algorithm and overlays
the segment boundaries for visualization.</p>
</section>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="kanapy.texture.EBSDmap.plot_grains">
<span class="sig-name descname"><span class="pre">plot_grains</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">N</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/kanapy/texture.html#EBSDmap.plot_grains"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kanapy.texture.EBSDmap.plot_grains" title="Link to this definition"></a></dt>
<dd><p>Plot the N largest grains with one-hot maps, convex hulls, and principal axes</p>
<section id="id316">
<h4>Parameters<a class="headerlink" href="#id316" title="Link to this heading"></a></h4>
<dl class="simple">
<dt>N<span class="classifier">int, optional</span></dt><dd><p>Number of largest grains to plot for each phase. Default is 5.</p>
</dd>
</dl>
</section>
<section id="id317">
<h4>Notes<a class="headerlink" href="#id317" title="Link to this heading"></a></h4>
<p>Each grain is visualized with its pixels, convex hull, and major/minor axes.
Major axes are plotted in cyan, minor axes in green.</p>
</section>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="kanapy.texture.EBSDmap.plot_grains_marked">
<span class="sig-name descname"><span class="pre">plot_grains_marked</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/kanapy/texture.html#EBSDmap.plot_grains_marked"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kanapy.texture.EBSDmap.plot_grains_marked" title="Link to this definition"></a></dt>
<dd><p>Plot grains with labels and major/minor axes for all phases</p>
<section id="id318">
<h4>Notes<a class="headerlink" href="#id318" title="Link to this heading"></a></h4>
<p>Each grain is annotated with its number. Major axes are plotted in black,
minor axes in red. The plot uses a distinct colormap for different grains.</p>
</section>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="kanapy.texture.EBSDmap.plot_graph">
<span class="sig-name descname"><span class="pre">plot_graph</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/kanapy/texture.html#EBSDmap.plot_graph"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kanapy.texture.EBSDmap.plot_graph" title="Link to this definition"></a></dt>
<dd><p>Visualize the microstructure graph for all phases</p>
<section id="id319">
<h4>Notes<a class="headerlink" href="#id319" title="Link to this heading"></a></h4>
<p>Uses the <cite>visualize_graph</cite> function to display nodes and connections of each phase’s graph.</p>
</section>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="kanapy.texture.EBSDmap.plot_ipf_map">
<span class="sig-name descname"><span class="pre">plot_ipf_map</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/kanapy/texture.html#EBSDmap.plot_ipf_map"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kanapy.texture.EBSDmap.plot_ipf_map" title="Link to this definition"></a></dt>
<dd><p>Plot the IPF (inverse pole figure) map for all phases</p>
<section id="id320">
<h4>Notes<a class="headerlink" href="#id320" title="Link to this heading"></a></h4>
<p>Pixels belonging to other phases are set to black. Each phase is visualized separately.</p>
</section>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="kanapy.texture.EBSDmap.plot_mo_map">
<span class="sig-name descname"><span class="pre">plot_mo_map</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/kanapy/texture.html#EBSDmap.plot_mo_map"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kanapy.texture.EBSDmap.plot_mo_map" title="Link to this definition"></a></dt>
<dd><p>Plot the misorientation map for all phases</p>
<section id="id321">
<h4>Notes<a class="headerlink" href="#id321" title="Link to this heading"></a></h4>
<p>Shows the misorientation angle of each pixel with respect to a reference orientation.</p>
</section>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="kanapy.texture.EBSDmap.plot_pf">
<span class="sig-name descname"><span class="pre">plot_pf</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">vector</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/kanapy/texture.html#EBSDmap.plot_pf"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kanapy.texture.EBSDmap.plot_pf" title="Link to this definition"></a></dt>
<dd><p>Plot pole figures for all phases using the specified sample direction</p>
<section id="id322">
<h4>Parameters<a class="headerlink" href="#id322" title="Link to this heading"></a></h4>
<dl class="simple">
<dt>vector<span class="classifier">array-like, optional</span></dt><dd><p>Sample reference vector for the pole figure. Default is [0, 0, 1].</p>
</dd>
</dl>
</section>
<section id="id323">
<h4>Notes<a class="headerlink" href="#id323" title="Link to this heading"></a></h4>
<p>Plots &lt;111&gt; poles in the sample reference frame for each phase.</p>
</section>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="kanapy.texture.EBSDmap.plot_pf_proj">
<span class="sig-name descname"><span class="pre">plot_pf_proj</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">vector</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/kanapy/texture.html#EBSDmap.plot_pf_proj"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kanapy.texture.EBSDmap.plot_pf_proj" title="Link to this definition"></a></dt>
<dd><p>Plot projected pole figures for all phases using the specified sample direction</p>
<section id="id324">
<h4>Parameters<a class="headerlink" href="#id324" title="Link to this heading"></a></h4>
<dl class="simple">
<dt>vector<span class="classifier">array-like, optional</span></dt><dd><p>Sample reference vector for the projected pole figure. Default is [0, 0, 1].</p>
</dd>
</dl>
</section>
<section id="id325">
<h4>Notes<a class="headerlink" href="#id325" title="Link to this heading"></a></h4>
<p>Uses a projection method to visualize &lt;111&gt; poles in the sample reference frame.</p>
</section>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="kanapy.texture.EBSDmap.plot_segmentation">
<span class="sig-name descname"><span class="pre">plot_segmentation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">show_mo</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show_ipf</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/kanapy/texture.html#EBSDmap.plot_segmentation"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kanapy.texture.EBSDmap.plot_segmentation" title="Link to this definition"></a></dt>
<dd><p>Plot segmentation results for all phases</p>
<section id="id326">
<h4>Parameters<a class="headerlink" href="#id326" title="Link to this heading"></a></h4>
<dl class="simple">
<dt>show_mo<span class="classifier">bool, optional</span></dt><dd><p>If True, overlay grain boundaries on the misorientation map. Default is True.</p>
</dd>
<dt>show_ipf<span class="classifier">bool, optional</span></dt><dd><p>If True, overlay grain boundaries on the IPF map. Default is True.</p>
</dd>
</dl>
</section>
<section id="id327">
<h4>Notes<a class="headerlink" href="#id327" title="Link to this heading"></a></h4>
<p>Uses similarity-based segmentation to highlight grain boundaries on the maps.</p>
</section>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="kanapy.texture.EBSDmap.showIPF">
<span class="sig-name descname"><span class="pre">showIPF</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/kanapy/texture.html#EBSDmap.showIPF"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kanapy.texture.EBSDmap.showIPF" title="Link to this definition"></a></dt>
<dd><p>Plot the inverse pole figure (IPF) color key for all phases in the EBSD map</p>
</dd></dl>

</section>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="kanapy.texture.Kernel">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">kanapy.texture.</span></span><span class="sig-name descname"><span class="pre">Kernel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">A</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/kanapy/texture.html#Kernel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kanapy.texture.Kernel" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">ABC</span></code></p>
<p>Abstract base class for kernels used in orientation distribution estimation.</p>
<section id="id328">
<h3>Attributes<a class="headerlink" href="#id328" title="Link to this heading"></a></h3>
<dl class="simple">
<dt>A<span class="classifier">ndarray</span></dt><dd><p>Flattened array of kernel parameters. Initialized to empty array if not provided.</p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="kanapy.texture.Kernel.K">
<span class="sig-name descname"><span class="pre">K</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">co2</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/kanapy/texture.html#Kernel.K"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kanapy.texture.Kernel.K" title="Link to this definition"></a></dt>
<dd><p>Evaluate the kernel function at a given squared cosine value.</p>
<section id="id329">
<h4>Parameters<a class="headerlink" href="#id329" title="Link to this heading"></a></h4>
<dl class="simple">
<dt>co2<span class="classifier">float or ndarray</span></dt><dd><p>Cosine squared value(s), will be clipped to [-1, 1].</p>
</dd>
</dl>
</section>
<section id="id330">
<h4>Returns<a class="headerlink" href="#id330" title="Link to this heading"></a></h4>
<dl class="simple">
<dt>float or ndarray</dt><dd><p>Value(s) of the kernel function.</p>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="kanapy.texture.Kernel.K_orientations">
<span class="sig-name descname"><span class="pre">K_orientations</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">orientations_ref</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">orientations</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/kanapy/texture.html#Kernel.K_orientations"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kanapy.texture.Kernel.K_orientations" title="Link to this definition"></a></dt>
<dd><p>Evaluate the kernel function for the misorientation angles between two sets of orientations.</p>
<section id="id331">
<h4>Parameters<a class="headerlink" href="#id331" title="Link to this heading"></a></h4>
<dl class="simple">
<dt>orientations_ref<span class="classifier">Orientation</span></dt><dd><p>Reference set of orientations.</p>
</dd>
<dt>orientations<span class="classifier">Orientation</span></dt><dd><p>Target set of orientations to compare.</p>
</dd>
</dl>
</section>
<section id="id332">
<h4>Returns<a class="headerlink" href="#id332" title="Link to this heading"></a></h4>
<dl class="simple">
<dt>ndarray</dt><dd><p>Kernel values corresponding to misorientation angles.</p>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="kanapy.texture.Kernel.RK">
<span class="sig-name descname"><span class="pre">RK</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">d</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/kanapy/texture.html#Kernel.RK"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kanapy.texture.Kernel.RK" title="Link to this definition"></a></dt>
<dd><p>Evaluate the kernel using the Clenshaw-L method for given cosine distances.</p>
<section id="id333">
<h4>Parameters<a class="headerlink" href="#id333" title="Link to this heading"></a></h4>
<dl class="simple">
<dt>d<span class="classifier">array_like</span></dt><dd><p>Cosine of angles (distance metric) in the range [-1, 1].</p>
</dd>
</dl>
</section>
<section id="id334">
<h4>Returns<a class="headerlink" href="#id334" title="Link to this heading"></a></h4>
<dl class="simple">
<dt>ndarray</dt><dd><p>Kernel values for the given distances.</p>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="kanapy.texture.Kernel.RRK">
<span class="sig-name descname"><span class="pre">RRK</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dh</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dr</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/kanapy/texture.html#Kernel.RRK"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kanapy.texture.Kernel.RRK" title="Link to this definition"></a></dt>
<dd><p>Evaluate the kernel on two sets of cosine distances using a reduced rotational kernel.</p>
<section id="id335">
<h4>Parameters<a class="headerlink" href="#id335" title="Link to this heading"></a></h4>
<dl class="simple">
<dt>dh<span class="classifier">array_like</span></dt><dd><p>Cosines of angles for the first set, clipped to [-1, 1].</p>
</dd>
<dt>dr<span class="classifier">array_like</span></dt><dd><p>Cosines of angles for the second set, clipped to [-1, 1].</p>
</dd>
</dl>
</section>
<section id="id336">
<h4>Returns<a class="headerlink" href="#id336" title="Link to this heading"></a></h4>
<dl class="simple">
<dt>ndarray</dt><dd><p>2D array of kernel values for each combination of dh and dr.</p>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="kanapy.texture.Kernel.bandwidth">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">bandwidth</span></span><a class="headerlink" href="#kanapy.texture.Kernel.bandwidth" title="Link to this definition"></a></dt>
<dd><p>Returns the bandwidth of the kernel.</p>
<p>The bandwidth is defined as the number of elements in <cite>A</cite> minus one.</p>
<section id="id337">
<h4>Returns<a class="headerlink" href="#id337" title="Link to this heading"></a></h4>
<dl class="simple">
<dt>int</dt><dd><p>Bandwidth of the kernel.</p>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="kanapy.texture.Kernel.calc_fourier">
<span class="sig-name descname"><span class="pre">calc_fourier</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">L</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_angle</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3.141592653589793</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fft_accuracy</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.01</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/kanapy/texture.html#Kernel.calc_fourier"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kanapy.texture.Kernel.calc_fourier" title="Link to this definition"></a></dt>
<dd><p>Compute the Fourier coefficients of the kernel up to order L.</p>
<section id="id338">
<h4>Parameters<a class="headerlink" href="#id338" title="Link to this heading"></a></h4>
<dl class="simple">
<dt>L<span class="classifier">int</span></dt><dd><p>Maximum order of the Fourier coefficients.</p>
</dd>
<dt>max_angle<span class="classifier">float, optional</span></dt><dd><p>Upper limit of integration in radians (default is pi).</p>
</dd>
<dt>fft_accuracy<span class="classifier">float, optional</span></dt><dd><p>Threshold below which coefficients are considered negligible and
computation stops early (default is 1e-2).</p>
</dd>
</dl>
</section>
<section id="id339">
<h4>Returns<a class="headerlink" href="#id339" title="Link to this heading"></a></h4>
<dl class="simple">
<dt>ndarray</dt><dd><p>Array of Fourier coefficients of length &lt;= L+1.</p>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="kanapy.texture.Kernel.cutA">
<span class="sig-name descname"><span class="pre">cutA</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fft_accuracy</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.01</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/kanapy/texture.html#Kernel.cutA"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kanapy.texture.Kernel.cutA" title="Link to this definition"></a></dt>
<dd><p>Truncate the kernel array <cite>A</cite> based on the specified FFT accuracy.</p>
<p>Elements of <cite>A</cite> are scaled by 1/(l^2), and elements smaller than
a threshold determined from <cite>fft_accuracy</cite> are removed.</p>
<section id="id340">
<h4>Parameters<a class="headerlink" href="#id340" title="Link to this heading"></a></h4>
<dl class="simple">
<dt>fft_accuracy<span class="classifier">float, optional</span></dt><dd><p>Desired FFT accuracy (default is 1e-2).</p>
</dd>
</dl>
</section>
<section id="id341">
<h4>Notes<a class="headerlink" href="#id341" title="Link to this heading"></a></h4>
<p>The first element is never truncated.</p>
</section>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="kanapy.texture.Kernel.halfwidth">
<span class="sig-name descname"><span class="pre">halfwidth</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/kanapy/texture.html#Kernel.halfwidth"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kanapy.texture.Kernel.halfwidth" title="Link to this definition"></a></dt>
<dd><p>Compute the halfwidth of the kernel.</p>
<p>The halfwidth is determined by finding the angle <cite>omega</cite> that minimizes
the squared difference between K(1) and 2*K(cos(omega/2)).</p>
<section id="id342">
<h4>Returns<a class="headerlink" href="#id342" title="Link to this heading"></a></h4>
<dl class="simple">
<dt>float</dt><dd><p>Halfwidth angle in radians.</p>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="kanapy.texture.Kernel.norm">
<span class="sig-name descname"><span class="pre">norm</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/kanapy/texture.html#Kernel.norm"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kanapy.texture.Kernel.norm" title="Link to this definition"></a></dt>
<dd><p>Compute the L2 norm of the squared kernel elements.</p>
<section id="id343">
<h4>Returns<a class="headerlink" href="#id343" title="Link to this heading"></a></h4>
<dl class="simple">
<dt>float</dt><dd><p>L2 norm of the squared elements of the kernel array <cite>A</cite>.</p>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="kanapy.texture.Kernel.plot_K">
<span class="sig-name descname"><span class="pre">plot_K</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n_points</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">200</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/kanapy/texture.html#Kernel.plot_K"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kanapy.texture.Kernel.plot_K" title="Link to this definition"></a></dt>
<dd><p>Plot the kernel function K as a function of misorientation angle.</p>
<section id="id344">
<h4>Parameters<a class="headerlink" href="#id344" title="Link to this heading"></a></h4>
<dl class="simple">
<dt>n_points<span class="classifier">int, optional</span></dt><dd><p>Number of points used for plotting the kernel function (default is 200).</p>
</dd>
</dl>
</section>
</dd></dl>

</section>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="kanapy.texture.ODF">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">kanapy.texture.</span></span><span class="sig-name descname"><span class="pre">ODF</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">orientations</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">halfwidth</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">np.float64(0.17453292519943295)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weights</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kernel</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">exact</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/kanapy/texture.html#ODF"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kanapy.texture.ODF" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Estimate an Orientation Distribution Function (ODF) from a set of orientations
using kernel density estimation.</p>
<section id="id345">
<h3>Parameters<a class="headerlink" href="#id345" title="Link to this heading"></a></h3>
<dl class="simple">
<dt>orientations<span class="classifier">orix.quaternion.Orientation</span></dt><dd><p>Input orientation set.</p>
</dd>
<dt>halfwidth<span class="classifier">float, optional</span></dt><dd><p>Halfwidth of the kernel in radians (default: 10 degrees).</p>
</dd>
<dt>weights<span class="classifier">array-like, optional</span></dt><dd><p>Weights for each orientation. If None, uniform weights are used.</p>
</dd>
<dt>kernel<span class="classifier">Kernel instance, optional</span></dt><dd><p>Kernel function to use. If None, DeLaValleePoussinKernel is used.</p>
</dd>
<dt>exact<span class="classifier">bool, optional</span></dt><dd><p>If False and orientation count &gt; 1000, approximation using grid is applied.</p>
</dd>
</dl>
</section>
<section id="id346">
<h3>Attributes<a class="headerlink" href="#id346" title="Link to this heading"></a></h3>
<dl class="simple">
<dt>orientations<span class="classifier">orix.quaternion.Orientation</span></dt><dd><p>Orientation set stored in the ODF.</p>
</dd>
<dt>weights<span class="classifier">ndarray</span></dt><dd><p>Normalized weights of the orientations.</p>
</dd>
<dt>kernel<span class="classifier">Kernel</span></dt><dd><p>Kernel used for density estimation.</p>
</dd>
<dt>halfwidth<span class="classifier">float</span></dt><dd><p>Halfwidth of the kernel in radians.</p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="kanapy.texture.ODF.evaluate">
<span class="sig-name descname"><span class="pre">evaluate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ori</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/kanapy/texture.html#ODF.evaluate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kanapy.texture.ODF.evaluate" title="Link to this definition"></a></dt>
<dd><p>Evaluate the ODF at given orientations.</p>
<section id="id347">
<h4>Parameters<a class="headerlink" href="#id347" title="Link to this heading"></a></h4>
<dl class="simple">
<dt>ori<span class="classifier">Orientation</span></dt><dd><p>Orientation(s) at which to evaluate the ODF.</p>
</dd>
</dl>
</section>
<section id="id348">
<h4>Returns<a class="headerlink" href="#id348" title="Link to this heading"></a></h4>
<dl class="simple">
<dt>values<span class="classifier">ndarray</span></dt><dd><p>ODF values at the specified orientations.</p>
</dd>
</dl>
</section>
</dd></dl>

</section>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="kanapy.texture.build_graph_from_labeled_pixels">
<span class="sig-prename descclassname"><span class="pre">kanapy.texture.</span></span><span class="sig-name descname"><span class="pre">build_graph_from_labeled_pixels</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">label_array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">emap</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">phase</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">connectivity</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">8</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/kanapy/texture.html#build_graph_from_labeled_pixels"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kanapy.texture.build_graph_from_labeled_pixels" title="Link to this definition"></a></dt>
<dd><p>Build a graph representation of a microstructure from labeled pixels</p>
<p>Each node in the graph represents a grain (label) and stores pixel indices,
average orientation, and orientation statistics. Edges connect neighboring grains
based on pixel adjacency.</p>
<section id="id349">
<h3>Parameters<a class="headerlink" href="#id349" title="Link to this heading"></a></h3>
<dl class="simple">
<dt>label_array<span class="classifier">ndarray of shape (H, W)</span></dt><dd><p>2D array of integer labels representing grains.</p>
</dd>
<dt>emap<span class="classifier">object</span></dt><dd><p>Orientation map object containing:
- <cite>rotations.data</cite> : orientation vectors for each pixel
- <cite>phases.point_groups</cite> : symmetry information for each phase
- <cite>dx</cite>, <cite>dy</cite> : pixel spacing in x and y directions</p>
</dd>
<dt>phase<span class="classifier">int</span></dt><dd><p>Phase index to select the corresponding symmetry from <cite>emap.phases.point_groups</cite>.</p>
</dd>
<dt>connectivity<span class="classifier">int, optional</span></dt><dd><p>Connectivity criterion for neighbors (4 or 8). Default is 8.</p>
</dd>
</dl>
</section>
<section id="id350">
<h3>Returns<a class="headerlink" href="#id350" title="Link to this heading"></a></h3>
<dl class="simple">
<dt>networkx.Graph</dt><dd><p>Graph object with:
- Nodes representing grains, storing ‘pixels’, ‘ori_av’, ‘ori_std’, ‘npix’
- Edges representing neighboring grains (shared boundaries)
- Graph attributes: ‘label_map’, ‘symmetry’, ‘dx’, ‘dy’</p>
</dd>
</dl>
</section>
<section id="id351">
<h3>Notes<a class="headerlink" href="#id351" title="Link to this heading"></a></h3>
<ul class="simple">
<li><p>Uses <cite>summarize_labels</cite> to extract node properties from labeled pixels</p></li>
<li><p>Loops over all pixels to add edges between neighboring grains</p></li>
<li><p>The function preserves the shape and indices of <cite>label_array</cite></p></li>
</ul>
</section>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="kanapy.texture.calc_error">
<span class="sig-prename descclassname"><span class="pre">kanapy.texture.</span></span><span class="sig-name descname"><span class="pre">calc_error</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">odf_ref</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">odf_test</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">res</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10.0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/kanapy/texture.html#calc_error"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kanapy.texture.calc_error" title="Link to this definition"></a></dt>
<dd><p>Compute the normalized difference between two orientation distribution functions (ODFs)</p>
<p>This function evaluates the ODFs on a sample grid in fundamental space and
computes the L1 norm of the difference after normalization.</p>
<section id="id352">
<h3>Parameters<a class="headerlink" href="#id352" title="Link to this heading"></a></h3>
<dl class="simple">
<dt>odf_ref<span class="classifier">object</span></dt><dd><p>Reference ODF object. Must have <cite>.orientations.symmetry</cite> and <cite>.evaluate()</cite> method.</p>
</dd>
<dt>odf_test<span class="classifier">object</span></dt><dd><p>Test ODF object to compare. Must have the same symmetry as <cite>odf_ref</cite>.</p>
</dd>
<dt>res<span class="classifier">float, optional</span></dt><dd><p>Resolution for sampling the fundamental space grid. Default is 10.</p>
</dd>
</dl>
</section>
<section id="id353">
<h3>Returns<a class="headerlink" href="#id353" title="Link to this heading"></a></h3>
<dl class="simple">
<dt>float</dt><dd><p>L1 error between the normalized ODFs.</p>
</dd>
</dl>
</section>
<section id="id354">
<h3>Notes<a class="headerlink" href="#id354" title="Link to this heading"></a></h3>
<ul class="simple">
<li><p>Raises a RuntimeError if the symmetries of the two ODFs do not match.</p></li>
<li><p>Uses <cite>get_sample_fundamental</cite> to sample the fundamental zone and <cite>Orientation</cite> for evaluation.</p></li>
<li><p>Does not modify the input ODFs.</p></li>
</ul>
</section>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="kanapy.texture.calc_orientations">
<span class="sig-prename descclassname"><span class="pre">kanapy.texture.</span></span><span class="sig-name descname"><span class="pre">calc_orientations</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">odf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nori</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">res</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/kanapy/texture.html#calc_orientations"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kanapy.texture.calc_orientations" title="Link to this definition"></a></dt>
<dd><p>Generate a set of orientations sampled from an orientation distribution function (ODF)</p>
<p>This function uses Monte Carlo sampling to generate <cite>nori</cite> orientations according to
the probabilities defined by the input ODF. Sampling is performed in the fundamental
zone of the crystal symmetry.</p>
<section id="id355">
<h3>Parameters<a class="headerlink" href="#id355" title="Link to this heading"></a></h3>
<dl class="simple">
<dt>odf<span class="classifier">object</span></dt><dd><p>Orientation distribution function object. Must have <cite>.orientations.symmetry</cite> and <cite>.evaluate()</cite> method.</p>
</dd>
<dt>nori<span class="classifier">int</span></dt><dd><p>Number of orientations to generate.</p>
</dd>
<dt>res<span class="classifier">float, optional</span></dt><dd><p>Angular resolution in degrees for sampling the fundamental zone grid.
If None, a resolution between 2° and 5° is selected based on ODF half-width.</p>
</dd>
</dl>
</section>
<section id="id356">
<h3>Returns<a class="headerlink" href="#id356" title="Link to this heading"></a></h3>
<dl class="simple">
<dt>Orientation</dt><dd><p>Orientation object containing <cite>nori</cite> orientations sampled from the ODF.</p>
</dd>
</dl>
</section>
<section id="id357">
<h3>Notes<a class="headerlink" href="#id357" title="Link to this heading"></a></h3>
<ul class="simple">
<li><p>Raises a RuntimeError if the Monte Carlo sampling does not converge after 200 iterations.</p></li>
<li><p>Logs a warning if the SO3 grid resolution is too coarse for the requested number of orientations.</p></li>
<li><p>Uses <cite>get_sample_fundamental</cite> to generate the sampling grid and <cite>Orientation</cite> to store results.</p></li>
<li><p>Does not modify the input ODF.</p></li>
</ul>
</section>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="kanapy.texture.createOriset">
<span class="sig-prename descclassname"><span class="pre">kanapy.texture.</span></span><span class="sig-name descname"><span class="pre">createOriset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">num</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ang</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">omega</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hist</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shared_area</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">degree</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Nbase</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">resolution</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">res_low</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">res_high</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">25</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">res_step</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">full_output</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/kanapy/texture.html#createOriset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kanapy.texture.createOriset" title="Link to this definition"></a></dt>
<dd><p>Create a set of Euler angles according to an ODF defined by input orientations and kernel half-width</p>
<section id="id358">
<h3>Parameters<a class="headerlink" href="#id358" title="Link to this heading"></a></h3>
<dl class="simple">
<dt>num<span class="classifier">int</span></dt><dd><p>Number of Euler angles to generate</p>
</dd>
<dt>ang<span class="classifier">(3,) or (M, 3) array or Orientation</span></dt><dd><p>Input set of Euler angles (in degrees or radians) defining the ODF</p>
</dd>
<dt>omega<span class="classifier">float</span></dt><dd><p>Kernel half-width (in degrees or radians)</p>
</dd>
<dt>hist<span class="classifier">array, optional</span></dt><dd><p>Histogram of MDF. Default is None</p>
</dd>
<dt>shared_area<span class="classifier">array, optional</span></dt><dd><p>Shared area between pairs of grains. Default is None</p>
</dd>
<dt>cs<span class="classifier">Symmetry, optional</span></dt><dd><p>Crystal symmetry group. Default is ‘m3m’</p>
</dd>
<dt>degree<span class="classifier">bool, optional</span></dt><dd><p>If True, input angles and omega are in degrees. Default is True</p>
</dd>
<dt>Nbase<span class="classifier">int, optional</span></dt><dd><p>Base number of orientations for artificial ODF. Default is 10000</p>
</dd>
<dt>resolution<span class="classifier">float, optional</span></dt><dd><p>Resolution for orientation generation. If None, derived from omega</p>
</dd>
<dt>res_low, res_high, res_step, lim<span class="classifier">int, optional</span></dt><dd><p>Parameters for texture reconstruction</p>
</dd>
<dt>verbose<span class="classifier">bool, optional</span></dt><dd><p>If True, prints progress messages. Default is False</p>
</dd>
<dt>full_output<span class="classifier">bool, optional</span></dt><dd><p>If True, returns additional reconstruction outputs. Default is False</p>
</dd>
</dl>
</section>
<section id="id359">
<h3>Returns<a class="headerlink" href="#id359" title="Link to this heading"></a></h3>
<dl class="simple">
<dt>ori<span class="classifier">(num, 3) ndarray</span></dt><dd><p>Reduced set of Euler angles</p>
</dd>
</dl>
</section>
<section id="id360">
<h3>Notes<a class="headerlink" href="#id360" title="Link to this heading"></a></h3>
<p>Can generate artificial ODFs if input set is small. Grain-boundary-texture
reconstruction with hist or shared_area requires the kanapy-mtex module.</p>
</section>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="kanapy.texture.createOrisetRandom">
<span class="sig-prename descclassname"><span class="pre">kanapy.texture.</span></span><span class="sig-name descname"><span class="pre">createOrisetRandom</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">num</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">omega</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hist</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shared_area</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Nbase</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/kanapy/texture.html#createOrisetRandom"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kanapy.texture.createOrisetRandom" title="Link to this definition"></a></dt>
<dd><p>Create a set of Euler angles for a random texture</p>
<section id="id361">
<h3>Parameters<a class="headerlink" href="#id361" title="Link to this heading"></a></h3>
<dl class="simple">
<dt>num<span class="classifier">int</span></dt><dd><p>Number of Euler angles to generate</p>
</dd>
<dt>omega<span class="classifier">float, optional</span></dt><dd><p>Kernel half-width in degrees. Default is 7.5</p>
</dd>
<dt>hist<span class="classifier">array, optional</span></dt><dd><p>Histogram of MDF. Default is None</p>
</dd>
<dt>shared_area<span class="classifier">array, optional</span></dt><dd><p>Shared area between pairs of grains. Default is None</p>
</dd>
<dt>cs<span class="classifier">Symmetry, optional</span></dt><dd><p>Crystal symmetry group. Default is ‘m3m’</p>
</dd>
<dt>Nbase<span class="classifier">int, optional</span></dt><dd><p>Base number of orientations for random texture. Default is 5000</p>
</dd>
</dl>
</section>
<section id="id362">
<h3>Returns<a class="headerlink" href="#id362" title="Link to this heading"></a></h3>
<dl class="simple">
<dt>ori<span class="classifier">(num, 3) ndarray</span></dt><dd><p>Set of randomly distributed Euler angles</p>
</dd>
</dl>
</section>
<section id="id363">
<h3>Notes<a class="headerlink" href="#id363" title="Link to this heading"></a></h3>
<p>Unlike <cite>createOriset</cite>, this function directly generates <cite>num</cite> random orientations
without reducing a larger artificial EBSD set. Grain-boundary-texture reconstruction
using <cite>hist</cite> or <cite>shared_area</cite> requires the kanapy-mtex module.</p>
</section>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="kanapy.texture.export_graph">
<span class="sig-prename descclassname"><span class="pre">kanapy.texture.</span></span><span class="sig-name descname"><span class="pre">export_graph</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">G</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filename</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">format</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'graphml'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/kanapy/texture.html#export_graph"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kanapy.texture.export_graph" title="Link to this definition"></a></dt>
<dd><p>Export a microstructure graph to a file in the specified format</p>
<p>This function writes the NetworkX graph to disk in either GraphML or GEXF format.</p>
<section id="id364">
<h3>Parameters<a class="headerlink" href="#id364" title="Link to this heading"></a></h3>
<dl class="simple">
<dt>G<span class="classifier">networkx.Graph</span></dt><dd><p>Graph object representing the microstructure.</p>
</dd>
<dt>filename<span class="classifier">str</span></dt><dd><p>Path to the output file.</p>
</dd>
<dt>format<span class="classifier">str, optional</span></dt><dd><p>File format for export. Supported options are ‘graphml’ and ‘gexf’. Default is ‘graphml’.</p>
</dd>
</dl>
</section>
<section id="id365">
<h3>Notes<a class="headerlink" href="#id365" title="Link to this heading"></a></h3>
<ul class="simple">
<li><p>Raises a ValueError if an unsupported format is provided</p></li>
<li><p>Does not modify the graph</p></li>
</ul>
</section>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="kanapy.texture.find_largest_neighbor">
<span class="sig-prename descclassname"><span class="pre">kanapy.texture.</span></span><span class="sig-name descname"><span class="pre">find_largest_neighbor</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">G</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">node</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/kanapy/texture.html#find_largest_neighbor"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kanapy.texture.find_largest_neighbor" title="Link to this definition"></a></dt>
<dd><p>Find the largest neighboring node of a given node in a graph</p>
<p>This function iterates over all neighbors of the specified node and returns
the neighbor with the largest ‘npix’ (number of pixels).</p>
<section id="id366">
<h3>Parameters<a class="headerlink" href="#id366" title="Link to this heading"></a></h3>
<dl class="simple">
<dt>G<span class="classifier">networkx.Graph</span></dt><dd><p>Graph object where nodes have an attribute ‘npix’ representing their size.</p>
</dd>
<dt>node<span class="classifier">int</span></dt><dd><p>Node ID for which the largest neighbor is to be found.</p>
</dd>
</dl>
</section>
<section id="id367">
<h3>Returns<a class="headerlink" href="#id367" title="Link to this heading"></a></h3>
<dl class="simple">
<dt>int</dt><dd><p>Node ID of the largest neighbor.</p>
</dd>
</dl>
</section>
<section id="id368">
<h3>Notes<a class="headerlink" href="#id368" title="Link to this heading"></a></h3>
<ul class="simple">
<li><p>Raises a ValueError if the node has no neighbors.</p></li>
<li><p>Raises a ValueError if the graph contains circular edges (neighbor is the node itself).</p></li>
<li><p>Does not modify the graph.</p></li>
</ul>
</section>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="kanapy.texture.find_orientations_fast">
<span class="sig-prename descclassname"><span class="pre">kanapy.texture.</span></span><span class="sig-name descname"><span class="pre">find_orientations_fast</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ori1</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Orientation</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ori2</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Orientation</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tol</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.001</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span></span></span><a class="reference internal" href="_modules/kanapy/texture.html#find_orientations_fast"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kanapy.texture.find_orientations_fast" title="Link to this definition"></a></dt>
<dd><p>Find closest matches in ori1 for each orientation in ori2 using KDTree</p>
<section id="id369">
<h3>Parameters<a class="headerlink" href="#id369" title="Link to this heading"></a></h3>
<dl class="simple">
<dt>ori1<span class="classifier">Orientation</span></dt><dd><p>Orientation database (e.g., EBSD orientations).</p>
</dd>
<dt>ori2<span class="classifier">Orientation</span></dt><dd><p>Orientations to match (e.g., grain mean orientations).</p>
</dd>
<dt>tol<span class="classifier">float</span></dt><dd><p>Angular tolerance in radians.</p>
</dd>
</dl>
</section>
<section id="id370">
<h3>Returns<a class="headerlink" href="#id370" title="Link to this heading"></a></h3>
<dl class="simple">
<dt>matches<span class="classifier">np.ndarray</span></dt><dd><p>Array of indices in ori1 matching each entry in ori2; -1 if no match found.</p>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="kanapy.texture.find_sim_neighbor">
<span class="sig-prename descclassname"><span class="pre">kanapy.texture.</span></span><span class="sig-name descname"><span class="pre">find_sim_neighbor</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">G</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nn</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/kanapy/texture.html#find_sim_neighbor"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kanapy.texture.find_sim_neighbor" title="Link to this definition"></a></dt>
<dd><p>Find the neighboring node most similar in orientation to the given node</p>
<p>This function computes the misorientation angles between the given node and
all its neighbors, and returns the neighbor with the smallest misorientation.</p>
<section id="id371">
<h3>Parameters<a class="headerlink" href="#id371" title="Link to this heading"></a></h3>
<dl class="simple">
<dt>G<span class="classifier">networkx.Graph</span></dt><dd><p>Graph object where nodes have an ‘ori_av’ attribute representing average orientation.
The graph also contains a ‘symmetry’ key in G.graph used for orientation calculations.</p>
</dd>
<dt>nn<span class="classifier">int</span></dt><dd><p>Node ID for which the most similar neighbor is to be found.</p>
</dd>
</dl>
</section>
<section id="id372">
<h3>Returns<a class="headerlink" href="#id372" title="Link to this heading"></a></h3>
<dl class="simple">
<dt>tuple</dt><dd><p>A tuple (neighbor_id, angle) where:
- neighbor_id : int, ID of the neighbor with smallest misorientation
- angle : float, misorientation angle with the given node</p>
</dd>
</dl>
</section>
<section id="id373">
<h3>Notes<a class="headerlink" href="#id373" title="Link to this heading"></a></h3>
<ul class="simple">
<li><p>Uses the <cite>Orientation</cite> class for misorientation calculations</p></li>
<li><p>Assumes all neighbors have a valid ‘ori_av’ attribute</p></li>
<li><p>Does not modify the graph</p></li>
</ul>
</section>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="kanapy.texture.find_similar_regions">
<span class="sig-prename descclassname"><span class="pre">kanapy.texture.</span></span><span class="sig-name descname"><span class="pre">find_similar_regions</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tolerance</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.087</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">connectivity</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/kanapy/texture.html#find_similar_regions"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kanapy.texture.find_similar_regions" title="Link to this definition"></a></dt>
<dd><p>Identify connected regions of similar values in a 2D array</p>
<p>This function labels all connected pixels in the input array whose values
differ by at most <cite>tolerance</cite>. Connectivity can be 4- or 8-connected.</p>
<section id="id374">
<h3>Parameters<a class="headerlink" href="#id374" title="Link to this heading"></a></h3>
<dl class="simple">
<dt>array<span class="classifier">ndarray of shape (H, W)</span></dt><dd><p>2D input array with values to segment.</p>
</dd>
<dt>tolerance<span class="classifier">float, optional</span></dt><dd><p>Maximum allowed difference between connected values. Default is 0.087.</p>
</dd>
<dt>connectivity<span class="classifier">int, optional</span></dt><dd><p>Connectivity criterion for neighbors: 1 for 4-connectivity, 2 for 8-connectivity. Default is 1.</p>
</dd>
</dl>
</section>
<section id="id375">
<h3>Returns<a class="headerlink" href="#id375" title="Link to this heading"></a></h3>
<dl class="simple">
<dt>labeled_array<span class="classifier">ndarray of shape (H, W)</span></dt><dd><p>Array where each connected region of similar values has a unique label.</p>
</dd>
<dt>num_features<span class="classifier">int</span></dt><dd><p>Total number of connected regions found.</p>
</dd>
</dl>
</section>
<section id="id376">
<h3>Notes<a class="headerlink" href="#id376" title="Link to this heading"></a></h3>
<ul class="simple">
<li><p>Uses a depth-first search to find connected regions.</p></li>
<li><p>Does not modify the input array.</p></li>
<li><p>Assumes <cite>neighbors(i, j, connectivity)</cite> returns valid neighboring indices.</p></li>
</ul>
</section>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="kanapy.texture.get_distinct_colormap">
<span class="sig-prename descclassname"><span class="pre">kanapy.texture.</span></span><span class="sig-name descname"><span class="pre">get_distinct_colormap</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">N</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cmap</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'prism'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/kanapy/texture.html#get_distinct_colormap"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kanapy.texture.get_distinct_colormap" title="Link to this definition"></a></dt>
<dd><p>Generate N visually distinct colors as an RGB colormap.</p>
<p>Parameters:
- N: int, number of colors
- seed: optional int, random seed for reproducibility</p>
<p>Returns:
- cmap: list of N RGB tuples in [0, 1]</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="kanapy.texture.get_ipf_colors">
<span class="sig-prename descclassname"><span class="pre">kanapy.texture.</span></span><span class="sig-name descname"><span class="pre">get_ipf_colors</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ori_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">color_key</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/kanapy/texture.html#get_ipf_colors"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kanapy.texture.get_ipf_colors" title="Link to this definition"></a></dt>
<dd><p>Get RGB colors for a list of orientations in radians</p>
<section id="id377">
<h3>Parameters<a class="headerlink" href="#id377" title="Link to this heading"></a></h3>
<dl class="simple">
<dt>ori_list<span class="classifier">(N, 3) ndarray</span></dt><dd><p>List of N Euler angles in radians</p>
</dd>
<dt>color_key<span class="classifier">int, optional</span></dt><dd><p>Index of the IPF color key to use. Default is 0</p>
</dd>
</dl>
</section>
<section id="id378">
<h3>Returns<a class="headerlink" href="#id378" title="Link to this heading"></a></h3>
<dl class="simple">
<dt>colors<span class="classifier">(N, 3) ndarray</span></dt><dd><p>RGB values corresponding to each orientation</p>
</dd>
</dl>
</section>
<section id="id379">
<h3>Notes<a class="headerlink" href="#id379" title="Link to this heading"></a></h3>
<p>Assumes cubic crystal symmetry and cubic specimen symmetry</p>
</section>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="kanapy.texture.merge_nodes">
<span class="sig-prename descclassname"><span class="pre">kanapy.texture.</span></span><span class="sig-name descname"><span class="pre">merge_nodes</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">G</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">node1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">node2</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/kanapy/texture.html#merge_nodes"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kanapy.texture.merge_nodes" title="Link to this definition"></a></dt>
<dd><p>Merge the pixel and attribute data of node1 into node2 in a graph</p>
<p>This function performs the following steps:
1. Concatenates the pixel lists of node1 and node2 and updates node2’s ‘pixels’ attribute
2. Updates the average orientation ‘ori_av’ and pixel count ‘npix’ for node2
3. Updates the convex hull for node2 if it exists
4. Adds edges from node1’s neighbors to node2, avoiding duplicates
5. Removes node1 from the graph
6. Updates the graph’s ‘label_map’ to replace all occurrences of node1 with node2</p>
<section id="id380">
<h3>Parameters<a class="headerlink" href="#id380" title="Link to this heading"></a></h3>
<dl class="simple">
<dt>G<span class="classifier">networkx.Graph</span></dt><dd><p>Graph object where nodes represent grains and have attributes:
- ‘pixels’ : array of pixel indices
- ‘ori_av’ : average orientation
- ‘npix’ : number of pixels
- optional ‘hull’ : ConvexHull object
The graph also contains:
- ‘label_map’ : 2D array of node labels
- ‘dx’, ‘dy’ : pixel spacing in x and y directions</p>
</dd>
<dt>node1<span class="classifier">int</span></dt><dd><p>Node ID to be merged and removed</p>
</dd>
<dt>node2<span class="classifier">int</span></dt><dd><p>Node ID to merge into and retain</p>
</dd>
</dl>
</section>
<section id="id381">
<h3>Notes<a class="headerlink" href="#id381" title="Link to this heading"></a></h3>
<ul class="simple">
<li><p>Modifies the graph <cite>G</cite> in place</p></li>
<li><p>Updates ‘pixels’, ‘ori_av’, ‘npix’, ‘hull’ for node2</p></li>
<li><p>Updates ‘label_map’ to replace node1 with node2</p></li>
<li><p>Adds new edges from node1 to node2 while avoiding duplicates</p></li>
</ul>
</section>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="kanapy.texture.neighbors">
<span class="sig-prename descclassname"><span class="pre">kanapy.texture.</span></span><span class="sig-name descname"><span class="pre">neighbors</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">r</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">c</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">connectivity</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">8</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/kanapy/texture.html#neighbors"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kanapy.texture.neighbors" title="Link to this definition"></a></dt>
<dd><p>Return the neighboring coordinates of a cell in a 2D grid.</p>
<section id="id382">
<h3>Parameters<a class="headerlink" href="#id382" title="Link to this heading"></a></h3>
<dl class="simple">
<dt>r<span class="classifier">int</span></dt><dd><p>Row index of the cell.</p>
</dd>
<dt>c<span class="classifier">int</span></dt><dd><p>Column index of the cell.</p>
</dd>
<dt>connectivity<span class="classifier">int, optional</span></dt><dd><p>Type of connectivity. Options are:
- 1 or 4 : 4-connected neighbors (up, down, left, right)
- 8      : 8-connected neighbors (includes diagonals)
Default is 8.</p>
</dd>
</dl>
</section>
<section id="id383">
<h3>Returns<a class="headerlink" href="#id383" title="Link to this heading"></a></h3>
<dl class="simple">
<dt>neighbors<span class="classifier">list of tuple</span></dt><dd><p>List of (row, column) tuples representing neighboring cells.</p>
</dd>
</dl>
</section>
<section id="id384">
<h3>Examples<a class="headerlink" href="#id384" title="Link to this heading"></a></h3>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">neighbors</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">connectivity</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
<span class="go">[(3, 3), (1, 3), (2, 4), (2, 2)]</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">neighbors</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="go">[(3, 2), (3, 3), (3, 4), (2, 2), (2, 4), (1, 2), (1, 3), (1, 4)]</span>
</pre></div>
</div>
</section>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="kanapy.texture.odf_est">
<span class="sig-prename descclassname"><span class="pre">kanapy.texture.</span></span><span class="sig-name descname"><span class="pre">odf_est</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ori</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">odf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nstep</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">50</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">step</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">halfwidth</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/kanapy/texture.html#odf_est"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kanapy.texture.odf_est" title="Link to this definition"></a></dt>
<dd><p>Estimate an ODF from a set of orientations using iterative half-width adjustment</p>
<p>This function generates a new orientation distribution function (ODF) from
input orientations by iteratively adjusting the half-width to minimize the
error relative to a reference ODF.</p>
<section id="id385">
<h3>Parameters<a class="headerlink" href="#id385" title="Link to this heading"></a></h3>
<dl class="simple">
<dt>ori<span class="classifier">Orientation</span></dt><dd><p>Input orientations used to estimate the ODF.</p>
</dd>
<dt>odf<span class="classifier">ODF</span></dt><dd><p>Reference orientation distribution function for error comparison.</p>
</dd>
<dt>nstep<span class="classifier">int, optional</span></dt><dd><p>Maximum number of iterations for adjusting the half-width. Default is 50.</p>
</dd>
<dt>step<span class="classifier">float, optional</span></dt><dd><p>Increment step in degrees for half-width adjustment. Default is 0.5.</p>
</dd>
<dt>halfwidth<span class="classifier">float, optional</span></dt><dd><p>Initial half-width in radians. If None, a value based on <cite>odf.halfwidth</cite> is used.</p>
</dd>
<dt>verbose<span class="classifier">bool, optional</span></dt><dd><p>If True, prints iteration details. Default is False.</p>
</dd>
</dl>
</section>
<section id="id386">
<h3>Returns<a class="headerlink" href="#id386" title="Link to this heading"></a></h3>
<dl class="simple">
<dt>ODF</dt><dd><p>Estimated orientation distribution function corresponding to input orientations.</p>
</dd>
</dl>
</section>
<section id="id387">
<h3>Notes<a class="headerlink" href="#id387" title="Link to this heading"></a></h3>
<ul class="simple">
<li><p>Uses <cite>calc_error</cite> to compare the estimated ODF with the reference ODF.</p></li>
<li><p>Iteratively increases half-width until the error starts to increase.</p></li>
<li><p>The returned ODF corresponds to the last half-width before error increased.</p></li>
<li><p>Does not modify the input orientations or reference ODF.</p></li>
</ul>
</section>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="kanapy.texture.plot_pole_figure">
<span class="sig-prename descclassname"><span class="pre">kanapy.texture.</span></span><span class="sig-name descname"><span class="pre">plot_pole_figure</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">orientations</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">phase</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vector</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/kanapy/texture.html#plot_pole_figure"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kanapy.texture.plot_pole_figure" title="Link to this definition"></a></dt>
<dd><p>Plot an inverse pole figure and pole density function for given orientations</p>
<p>This function visualizes the orientation distribution of a crystal phase by
plotting the stereographic projection of specified poles and the corresponding
pole density function (PDF).</p>
<section id="id388">
<h3>Parameters<a class="headerlink" href="#id388" title="Link to this heading"></a></h3>
<dl class="simple">
<dt>orientations<span class="classifier">Orientation</span></dt><dd><p>Orientation object containing crystal orientations to plot.</p>
</dd>
<dt>phase<span class="classifier">object</span></dt><dd><p>Crystal phase object containing symmetry information and name.</p>
</dd>
<dt>vector<span class="classifier">array-like of shape (3,), optional</span></dt><dd><p>Miller indices of the pole vector to plot. Default is [0, 0, 1].</p>
</dd>
<dt>size<span class="classifier">float, optional</span></dt><dd><p>Marker size for scatter plot. Automatically scaled if None.</p>
</dd>
<dt>alpha<span class="classifier">float, optional</span></dt><dd><p>Marker transparency for scatter plot. Automatically scaled if None.</p>
</dd>
</dl>
</section>
<section id="id389">
<h3>Notes<a class="headerlink" href="#id389" title="Link to this heading"></a></h3>
<ul class="simple">
<li><p>Uses Matplotlib for plotting with stereographic projection.</p></li>
<li><p>The first subplot shows the inverse pole figure (scatter of poles).</p></li>
<li><p>The second subplot shows the pole density function.</p></li>
<li><p>Marker size and transparency are scaled inversely with the number of orientations.</p></li>
<li><p>Does not modify the input <cite>orientations</cite> or <cite>phase</cite>.</p></li>
</ul>
</section>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="kanapy.texture.plot_pole_figure_proj">
<span class="sig-prename descclassname"><span class="pre">kanapy.texture.</span></span><span class="sig-name descname"><span class="pre">plot_pole_figure_proj</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">orientations</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">phase</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vector</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">title</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/kanapy/texture.html#plot_pole_figure_proj"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kanapy.texture.plot_pole_figure_proj" title="Link to this definition"></a></dt>
<dd><p>Plot an inverse pole figure (IPF) projection and pole density function for EBSD data</p>
<p>This function visualizes crystal orientations along a specified sample direction
using an IPF projection. The first subplot shows the scatter of rotated poles,
and the second subplot shows the corresponding pole density function (PDF).</p>
<section id="id390">
<h3>Parameters<a class="headerlink" href="#id390" title="Link to this heading"></a></h3>
<dl class="simple">
<dt>orientations<span class="classifier">Orientation</span></dt><dd><p>Orientation object containing crystal orientations to plot.</p>
</dd>
<dt>phase<span class="classifier">object</span></dt><dd><p>Crystal phase object with symmetry information and name.</p>
</dd>
<dt>vector<span class="classifier">array-like of shape (3,), optional</span></dt><dd><p>Sample direction to project (Miller indices). Default is [0, 0, 1].</p>
</dd>
<dt>title<span class="classifier">str, optional</span></dt><dd><p>Title for the plot. If None, automatically uses the principal axis of <cite>vector</cite>.</p>
</dd>
<dt>alpha<span class="classifier">float, optional</span></dt><dd><p>Marker transparency for scatter plot. Automatically scaled if None.</p>
</dd>
<dt>size<span class="classifier">float, optional</span></dt><dd><p>Marker size for scatter plot. Automatically scaled if None.</p>
</dd>
</dl>
</section>
<section id="id391">
<h3>Notes<a class="headerlink" href="#id391" title="Link to this heading"></a></h3>
<ul class="simple">
<li><p>Uses Matplotlib with stereographic projection (IPF) for plotting.</p></li>
<li><p>Marker size and transparency are scaled inversely with the number of orientations.</p></li>
<li><p>The first subplot shows the inverse pole figure (scatter of rotated poles).</p></li>
<li><p>The second subplot shows the pole density function (PDF).</p></li>
<li><p>Does not modify the input <cite>orientations</cite> or <cite>phase</cite>.</p></li>
</ul>
</section>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="kanapy.texture.summarize_labels">
<span class="sig-prename descclassname"><span class="pre">kanapy.texture.</span></span><span class="sig-name descname"><span class="pre">summarize_labels</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">label_array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rotations</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wanted_labels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/kanapy/texture.html#summarize_labels"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kanapy.texture.summarize_labels" title="Link to this definition"></a></dt>
<dd><p>Summarize labeled pixels with average orientation and statistics</p>
<p>This function computes, for each label in <cite>label_array</cite> (or a subset of <cite>wanted_labels</cite>):
- Number of pixels
- Pixel indices
- Average orientation vector
- Standard deviation of orientation</p>
<section id="id392">
<h3>Parameters<a class="headerlink" href="#id392" title="Link to this heading"></a></h3>
<dl class="simple">
<dt>label_array<span class="classifier">ndarray of shape (H, W)</span></dt><dd><p>2D array of integer labels.</p>
</dd>
<dt>rotations<span class="classifier">ndarray of shape (H*W, D)</span></dt><dd><p>Orientation data corresponding to each pixel (e.g., emap.rotations.data).</p>
</dd>
<dt>wanted_labels<span class="classifier">sequence of int, optional</span></dt><dd><p>List of label IDs to summarize. If None, all labels in <cite>label_array</cite> are used.</p>
</dd>
</dl>
</section>
<section id="id393">
<h3>Returns<a class="headerlink" href="#id393" title="Link to this heading"></a></h3>
<dl class="simple">
<dt>list of tuples</dt><dd><p>Each tuple is <cite>(label, info_dict)</cite> where <cite>info_dict</cite> contains:
- ‘npix’ : int, number of pixels
- ‘pixels’ : array of 1D indices in <cite>label_array.ravel()</cite>
- ‘ori_av’ : ndarray of shape (D,), average orientation vector
- ‘ori_std’ : ndarray of shape (D,), standard deviation of orientation</p>
</dd>
</dl>
</section>
<section id="id394">
<h3>Notes<a class="headerlink" href="#id394" title="Link to this heading"></a></h3>
<ul class="simple">
<li><p>Uses <cite>np.add.reduceat</cite> and sorting for efficient computation</p></li>
<li><p>The returned list preserves the order of <cite>wanted_labels</cite> if provided,
otherwise follows sorted unique labels from <cite>label_array</cite></p></li>
<li><p>Does not modify input arrays</p></li>
</ul>
</section>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="kanapy.texture.texture_reconstruction">
<span class="sig-prename descclassname"><span class="pre">kanapy.texture.</span></span><span class="sig-name descname"><span class="pre">texture_reconstruction</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ns</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ebsd</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ebsdfile</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">orientations</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grainsfile</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grains</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kernel</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kernel_halfwidth</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">res_low</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">res_high</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">25</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">res_step</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/kanapy/texture.html#texture_reconstruction"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kanapy.texture.texture_reconstruction" title="Link to this definition"></a></dt>
<dd><p>Reconstruct a reduced ODF from EBSD or orientation data</p>
<p>This function systematically reconstructs an orientation distribution function (ODF)
using a given number of orientations or grains in a representative volume element (RVE).
The reconstructed ODF approximates the misorientation distribution of the input data.
Follows the method described in Biswas et al. (<a class="reference external" href="https://doi.org/10.1107/S1600576719017138">https://doi.org/10.1107/S1600576719017138</a>).</p>
<section id="id395">
<h3>Parameters<a class="headerlink" href="#id395" title="Link to this heading"></a></h3>
<dl class="simple">
<dt>ns<span class="classifier">int</span></dt><dd><p>Number of reduced orientations/grains in the RVE.</p>
</dd>
<dt>ebsd<span class="classifier">EBSDmap, optional</span></dt><dd><p>EBSD map containing orientations for a single phase.</p>
</dd>
<dt>ebsdfile<span class="classifier">str, optional</span></dt><dd><p>Path to a <a href="#id396"><span class="problematic" id="id397">*</span></a>.mat file with EBSD data (not yet supported).</p>
</dd>
<dt>orientations<span class="classifier">Orientation, optional</span></dt><dd><p>Predefined orientations to use instead of EBSD data.</p>
</dd>
<dt>grainsfile<span class="classifier">str, optional</span></dt><dd><p>Path to estimated grains file (<a href="#id398"><span class="problematic" id="id399">*</span></a>.mat). Not used for kernel estimation.</p>
</dd>
<dt>grains<span class="classifier">object, optional</span></dt><dd><p>Grain data. Not used for kernel estimation.</p>
</dd>
<dt>kernel<span class="classifier">DeLaValleePoussinKernel, optional</span></dt><dd><p>Kernel for ODF estimation. Default: halfwidth=kernel_halfwidth.</p>
</dd>
<dt>kernel_halfwidth<span class="classifier">float, optional</span></dt><dd><p>Halfwidth in degrees for default DeLaValleePoussin kernel. Default is 5°.</p>
</dd>
<dt>res_low<span class="classifier">float, optional</span></dt><dd><p>Minimum resolution (in degrees) of orientation grid for reconstruction. Default 5°.</p>
</dd>
<dt>res_high<span class="classifier">float, optional</span></dt><dd><p>Maximum resolution (in degrees) of orientation grid. Default 25°.</p>
</dd>
<dt>res_step<span class="classifier">float, optional</span></dt><dd><p>Step size (in degrees) for grid resolution. Default 2°.</p>
</dd>
<dt>lim<span class="classifier">int, optional</span></dt><dd><p>Maximum number of consecutive worsening errors before stopping. Default 5.</p>
</dd>
<dt>verbose<span class="classifier">bool, optional</span></dt><dd><p>If True, print progress and error information. Default False.</p>
</dd>
</dl>
</section>
<section id="id400">
<h3>Returns<a class="headerlink" href="#id400" title="Link to this heading"></a></h3>
<dl class="simple">
<dt>orired_f<span class="classifier">Orientation</span></dt><dd><p>Reduced set of orientations in the fundamental region.</p>
</dd>
<dt>odfred_f<span class="classifier">ODF</span></dt><dd><p>Reconstructed ODF using the reduced orientations.</p>
</dd>
<dt>ero<span class="classifier">float</span></dt><dd><p>L1 error between reference ODF and reconstructed ODF.</p>
</dd>
<dt>res<span class="classifier">float</span></dt><dd><p>Grid resolution (degrees) at which the minimum error was achieved.</p>
</dd>
</dl>
</section>
<section id="id401">
<h3>Notes<a class="headerlink" href="#id401" title="Link to this heading"></a></h3>
<ul class="simple">
<li><p>Uses Monte Carlo sampling and kernel smoothing to generate reduced orientations.</p></li>
<li><p>Only supports single-phase EBSD data.</p></li>
<li><p>Kernel estimation from grains or files is not yet supported; default kernel is used.</p></li>
<li><p>The reconstructed ODF approximates the misorientation distribution of the input data.</p></li>
</ul>
</section>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="kanapy.texture.visualize_graph">
<span class="sig-prename descclassname"><span class="pre">kanapy.texture.</span></span><span class="sig-name descname"><span class="pre">visualize_graph</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">G</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">node_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">12</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/kanapy/texture.html#visualize_graph"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kanapy.texture.visualize_graph" title="Link to this definition"></a></dt>
<dd><p>Visualize a microstructure graph using a spring layout</p>
<p>This function draws the nodes and edges of the graph with labels,
using a spring layout for positioning. Node color, edge color,
node size, and font size can be adjusted.</p>
<section id="id402">
<h3>Parameters<a class="headerlink" href="#id402" title="Link to this heading"></a></h3>
<dl class="simple">
<dt>G<span class="classifier">networkx.Graph</span></dt><dd><p>Graph object representing the microstructure. Nodes should have meaningful labels.</p>
</dd>
<dt>node_size<span class="classifier">int, optional</span></dt><dd><p>Size of the nodes in the plot. Default is 100.</p>
</dd>
<dt>fs<span class="classifier">int, optional</span></dt><dd><p>Font size for node labels. Default is 12.</p>
</dd>
</dl>
</section>
<section id="id403">
<h3>Notes<a class="headerlink" href="#id403" title="Link to this heading"></a></h3>
<ul class="simple">
<li><p>Uses NetworkX’s <cite>spring_layout</cite> for node positioning</p></li>
<li><p>Uses Matplotlib to render the plot</p></li>
<li><p>Does not modify the graph</p></li>
</ul>
</section>
</dd></dl>

</section>
<section id="module-kanapy.core.plotting">
<span id="module-plotting"></span><h2>Module plotting<a class="headerlink" href="#module-kanapy.core.plotting" title="Link to this heading"></a></h2>
<p>Subroutines for plotting of microstructures</p>
<p>Created on Mon Oct  4 07:52:55 2021</p>
<p>&#64;author: Alexander Hartmaier, Golsa Tolooei Eshlaghi, Ronak Shoghi</p>
<dl class="py function">
<dt class="sig sig-object py" id="kanapy.core.plotting.plot_ellipsoids_3D">
<span class="sig-prename descclassname"><span class="pre">kanapy.core.plotting.</span></span><span class="sig-name descname"><span class="pre">plot_ellipsoids_3D</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">particles</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cmap</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'prism'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dual_phase</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">silent</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">asp_arr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">phases</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cols</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/kanapy/core/plotting.html#plot_ellipsoids_3D"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kanapy.core.plotting.plot_ellipsoids_3D" title="Link to this definition"></a></dt>
<dd><p>Display ellipsoids after the packing procedure</p>
<section id="id404">
<h3>Parameters<a class="headerlink" href="#id404" title="Link to this heading"></a></h3>
<dl class="simple">
<dt>particles<span class="classifier">list</span></dt><dd><p>List of ellipsoid objects representing particles in the microstructure.</p>
</dd>
<dt>cmap<span class="classifier">str, optional</span></dt><dd><p>Color map for ellipsoids. Default is ‘prism’.</p>
</dd>
<dt>dual_phase<span class="classifier">bool, optional</span></dt><dd><p>Deprecated. Use <cite>phases</cite> instead. If True, ellipsoids are colored
according to phase (red/green contrast).</p>
</dd>
<dt>silent<span class="classifier">bool, optional</span></dt><dd><p>If True, returns the figure object without displaying it. Default is False.</p>
</dd>
<dt>asp_arr<span class="classifier">list of 3 floats, optional</span></dt><dd><p>Aspect ratio for the 3D axes (x, y, z). Default is [1, 1, 1].</p>
</dd>
<dt>phases<span class="classifier">bool, optional</span></dt><dd><p>If True, ellipsoids are colored according to their phase number.</p>
</dd>
<dt>cols<span class="classifier">list of str, optional</span></dt><dd><p>List of colors used for each phase when <cite>phases=True</cite>.</p>
</dd>
</dl>
</section>
<section id="id405">
<h3>Returns<a class="headerlink" href="#id405" title="Link to this heading"></a></h3>
<dl class="simple">
<dt>fig<span class="classifier">matplotlib.figure.Figure, optional</span></dt><dd><p>The matplotlib figure object if <cite>silent=True</cite>.</p>
</dd>
</dl>
</section>
<section id="id406">
<h3>Notes<a class="headerlink" href="#id406" title="Link to this heading"></a></h3>
<ul class="simple">
<li><p>The <cite>dual_phase</cite> parameter is deprecated. Use <cite>phases</cite> to control
coloring by phase.</p></li>
<li><p>Each ellipsoid is represented by its surface mesh generated via
<cite>surfacePointsGen</cite> method of the ellipsoid object.</p></li>
</ul>
</section>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="kanapy.core.plotting.plot_init_stats">
<span class="sig-prename descclassname"><span class="pre">kanapy.core.plotting.</span></span><span class="sig-name descname"><span class="pre">plot_init_stats</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">stats_dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gs_data</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ar_data</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gs_param</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ar_param</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_files</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">silent</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/kanapy/core/plotting.html#plot_init_stats"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kanapy.core.plotting.plot_init_stats" title="Link to this definition"></a></dt>
<dd><p>Plot initial microstructure descriptors (grain size and aspect ratio) based on user-defined statistics.</p>
<section id="id407">
<h3>Parameters<a class="headerlink" href="#id407" title="Link to this heading"></a></h3>
<dl class="simple">
<dt>stats_dict<span class="classifier">dict</span></dt><dd><p>Dictionary containing initial microstructure statistics. Expected keys:
- “Equivalent diameter”: dict with ‘sig’, ‘scale’, optionally ‘loc’, ‘cutoff_min’, ‘cutoff_max’
- “Aspect ratio”: dict with ‘sig’, ‘scale’, optionally ‘loc’, ‘cutoff_min’, ‘cutoff_max’ (for elongated grains)
- “Grain type”: str, one of “Equiaxed”, “Elongated”, or “Free”
- “Semi axes”: dict with ‘scale’, ‘sig’, ‘cutoff_min’, ‘cutoff_max’ (for free grains)
- “Phase”: dict with ‘Number’ and ‘Name’, optional</p>
</dd>
<dt>gs_data<span class="classifier">array-like, optional</span></dt><dd><p>Experimental equivalent diameter data. Default is None.</p>
</dd>
<dt>ar_data<span class="classifier">array-like, optional</span></dt><dd><p>Experimental aspect ratio data. Default is None.</p>
</dd>
<dt>gs_param<span class="classifier">tuple, optional</span></dt><dd><p>Parameters (s, loc, scale, min, max) for lognormal distribution of experimental equivalent diameters. Default is None.</p>
</dd>
<dt>ar_param<span class="classifier">tuple, optional</span></dt><dd><p>Parameters (s, loc, scale, min, max) for lognormal distribution of experimental aspect ratios. Default is None.</p>
</dd>
<dt>save_files<span class="classifier">bool, optional</span></dt><dd><p>If True, save the figure to file “Input_distribution.png”. Default is False.</p>
</dd>
<dt>silent<span class="classifier">bool, optional</span></dt><dd><p>If True, return the figure object instead of displaying it. Default is False.</p>
</dd>
</dl>
</section>
<section id="id408">
<h3>Returns<a class="headerlink" href="#id408" title="Link to this heading"></a></h3>
<dl class="simple">
<dt>fig<span class="classifier">matplotlib.figure.Figure, optional</span></dt><dd><p>The figure object if <cite>silent=True</cite>.</p>
</dd>
</dl>
</section>
<section id="id409">
<h3>Notes<a class="headerlink" href="#id409" title="Link to this heading"></a></h3>
<ul class="simple">
<li><dl class="simple">
<dt>The function automatically selects plotting style depending on “Grain type”:</dt><dd><ul>
<li><p>“Equiaxed”: only equivalent diameter distribution</p></li>
<li><p>“Elongated”: both equivalent diameter and aspect ratio distributions</p></li>
<li><p>“Free”: compute aspect ratio from semi-axes and rotation axis</p></li>
</ul>
</dd>
</dl>
</li>
<li><p>Vertical dashed lines mark the minimum and maximum cut-offs from <cite>stats_dict</cite>.</p></li>
<li><p>Overlays experimental data (histogram) and lognormal fits if <cite>gs_data</cite> or <cite>ar_data</cite> are provided.</p></li>
<li><p>Uses lognormal PDFs for both grain size and aspect ratio.</p></li>
</ul>
</section>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="kanapy.core.plotting.plot_output_stats">
<span class="sig-prename descclassname"><span class="pre">kanapy.core.plotting.</span></span><span class="sig-name descname"><span class="pre">plot_output_stats</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">labels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">iphase</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gs_data</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gs_param</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ar_data</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ar_param</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_files</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">silent</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">enhanced_plot</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/kanapy/core/plotting.html#plot_output_stats"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kanapy.core.plotting.plot_output_stats" title="Link to this definition"></a></dt>
<dd><p>Evaluate and plot particle- and RVE grain statistics, including equivalent diameters and aspect ratios</p>
<section id="id410">
<h3>Parameters<a class="headerlink" href="#id410" title="Link to this heading"></a></h3>
<dl class="simple">
<dt>data_list<span class="classifier">list of dict</span></dt><dd><p>List of dictionaries containing particle/grain statistics. Each dictionary
should include keys like ‘eqd’, ‘eqd_scale’, ‘eqd_sig’, ‘ar’, ‘ar_scale’, ‘ar_sig’.</p>
</dd>
<dt>labels<span class="classifier">list of str</span></dt><dd><p>Labels indicating the type of data in <cite>data_list</cite>, e.g., [‘Grains’, ‘Partcls’].</p>
</dd>
<dt>iphase<span class="classifier">int, optional</span></dt><dd><p>Phase index to label the plots. Default is None.</p>
</dd>
<dt>gs_data<span class="classifier">array-like, optional</span></dt><dd><p>Experimental equivalent diameter data for comparison. Default is None.</p>
</dd>
<dt>gs_param<span class="classifier">tuple, optional</span></dt><dd><p>Parameters for lognormal distribution of experimental data (s, loc, scale). Default is None.</p>
</dd>
<dt>ar_data<span class="classifier">array-like, optional</span></dt><dd><p>Experimental aspect ratio data for comparison. Default is None.</p>
</dd>
<dt>ar_param<span class="classifier">tuple, optional</span></dt><dd><p>Parameters for lognormal distribution of experimental aspect ratio data (s, loc, scale). Default is None.</p>
</dd>
<dt>save_files<span class="classifier">bool, optional</span></dt><dd><p>If True, saves the generated figures as PNG files. Default is False.</p>
</dd>
<dt>silent<span class="classifier">bool, optional</span></dt><dd><p>If True, returns the figure objects instead of showing them. Default is False.</p>
</dd>
<dt>enhanced_plot<span class="classifier">bool, optional</span></dt><dd><p>If True, produces higher-resolution comparison plots using lognormal PDFs. Default is False.</p>
</dd>
</dl>
</section>
<section id="id411">
<h3>Returns<a class="headerlink" href="#id411" title="Link to this heading"></a></h3>
<dl class="simple">
<dt>fig<span class="classifier">matplotlib.figure.Figure, optional</span></dt><dd><p>Figure object if <cite>silent=True</cite>.</p>
</dd>
</dl>
</section>
<section id="id412">
<h3>Notes<a class="headerlink" href="#id412" title="Link to this heading"></a></h3>
<ul class="simple">
<li><p>The function can compare statistical distributions between grains, particles, and experimental data.</p></li>
<li><p>Both histograms and lognormal probability density functions are used to display distributions.</p></li>
<li><p>If <cite>enhanced_plot=True</cite>, PDFs for equivalent diameter and aspect ratio are plotted using a dense x-axis.</p></li>
<li><p><cite>labels</cite> must contain at least ‘Grains’ or ‘Voxels’. Otherwise, a ValueError is raised.</p></li>
</ul>
</section>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="kanapy.core.plotting.plot_particles_3D">
<span class="sig-prename descclassname"><span class="pre">kanapy.core.plotting.</span></span><span class="sig-name descname"><span class="pre">plot_particles_3D</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">particles</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cmap</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'prism'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dual_phase</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot_hull</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">silent</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">asp_arr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/kanapy/core/plotting.html#plot_particles_3D"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kanapy.core.plotting.plot_particles_3D" title="Link to this definition"></a></dt>
<dd><p>Display inner polyhedra and optional hulls of ellipsoids after packing procedure</p>
<section id="id413">
<h3>Parameters<a class="headerlink" href="#id413" title="Link to this heading"></a></h3>
<dl class="simple">
<dt>particles<span class="classifier">list</span></dt><dd><p>List of ellipsoid objects containing inner polygons and convex hulls.</p>
</dd>
<dt>cmap<span class="classifier">str, optional</span></dt><dd><p>Colormap for ellipsoids. Default is ‘prism’.</p>
</dd>
<dt>dual_phase<span class="classifier">bool, optional</span></dt><dd><p>If True, colors ellipsoids according to phase (red/green contrast).</p>
</dd>
<dt>plot_hull<span class="classifier">bool, optional</span></dt><dd><p>If True, plots the outer hull of the ellipsoid. Default is True.</p>
</dd>
<dt>silent<span class="classifier">bool, optional</span></dt><dd><p>If True, returns the figure object instead of displaying the plot.</p>
</dd>
<dt>asp_arr<span class="classifier">list of 3 floats, optional</span></dt><dd><p>Aspect ratio for the 3D axes (x, y, z). Default is [1, 1, 1].</p>
</dd>
</dl>
</section>
<section id="id414">
<h3>Returns<a class="headerlink" href="#id414" title="Link to this heading"></a></h3>
<dl class="simple">
<dt>fig<span class="classifier">matplotlib.figure.Figure, optional</span></dt><dd><p>Matplotlib figure object if <cite>silent=True</cite>.</p>
</dd>
</dl>
</section>
<section id="id415">
<h3>Notes<a class="headerlink" href="#id415" title="Link to this heading"></a></h3>
<ul class="simple">
<li><p>Each ellipsoid must have an inner polygon (<cite>pa.inner</cite>) to be plotted.</p></li>
<li><p>The convex hull of the ellipsoid is displayed using <cite>plot_trisurf</cite>.</p></li>
<li><p>If <cite>plot_hull</cite> is True, the outer surface of the ellipsoid is also plotted
using <cite>plot_surface</cite>.</p></li>
</ul>
</section>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="kanapy.core.plotting.plot_polygons_3D">
<span class="sig-prename descclassname"><span class="pre">kanapy.core.plotting.</span></span><span class="sig-name descname"><span class="pre">plot_polygons_3D</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">geometry</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cmap</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'prism'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.4</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ec</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dual_phase</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">silent</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">asp_arr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">phases</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cols</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/kanapy/core/plotting.html#plot_polygons_3D"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kanapy.core.plotting.plot_polygons_3D" title="Link to this definition"></a></dt>
<dd><p>Plot triangularized convex hulls of grains based on vertices and simplices</p>
<section id="id416">
<h3>Parameters<a class="headerlink" href="#id416" title="Link to this heading"></a></h3>
<dl class="simple">
<dt>geometry<span class="classifier">dict</span></dt><dd><p>Dictionary containing grain geometry with keys:
- ‘Grains’: dict with simplices (triangles) for each grain
- ‘Points’: ndarray of vertex coordinates (N, 3)</p>
</dd>
<dt>cmap<span class="classifier">str, optional</span></dt><dd><p>Colormap for coloring the triangles. Default is ‘prism’.</p>
</dd>
<dt>alpha<span class="classifier">float, optional</span></dt><dd><p>Transparency of the polygons. Default is 0.4.</p>
</dd>
<dt>ec<span class="classifier">color or list, optional</span></dt><dd><p>Edge color for triangles. Default is [0.5, 0.5, 0.5, 0.1].</p>
</dd>
<dt>dual_phase<span class="classifier">bool, optional</span></dt><dd><p>Deprecated. Use <cite>phases</cite> instead. If True, grains are colored
by phase in red/green contrast.</p>
</dd>
<dt>silent<span class="classifier">bool, optional</span></dt><dd><p>If True, returns the figure object instead of showing it. Default is False.</p>
</dd>
<dt>asp_arr<span class="classifier">list of 3 floats, optional</span></dt><dd><p>Aspect ratio for the 3D axes (x, y, z). Default is [1, 1, 1].</p>
</dd>
<dt>phases<span class="classifier">bool, optional</span></dt><dd><p>If True, colors grains according to their phase number.</p>
</dd>
<dt>cols<span class="classifier">list of str, optional</span></dt><dd><p>Colors to use for each phase when <cite>phases=True</cite>.</p>
</dd>
</dl>
</section>
<section id="id417">
<h3>Returns<a class="headerlink" href="#id417" title="Link to this heading"></a></h3>
<dl class="simple">
<dt>fig<span class="classifier">matplotlib.figure.Figure, optional</span></dt><dd><p>Matplotlib figure object if <cite>silent=True</cite>.</p>
</dd>
</dl>
</section>
<section id="id418">
<h3>Notes<a class="headerlink" href="#id418" title="Link to this heading"></a></h3>
<ul class="simple">
<li><p>The <cite>dual_phase</cite> parameter is deprecated. Use <cite>phases</cite> to control
coloring by phase.</p></li>
<li><p>Each grain is plotted using its convex hull triangles defined in
<cite>geometry[‘Grains’][igr][‘Simplices’]</cite>.</p></li>
</ul>
</section>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="kanapy.core.plotting.plot_stats_dict">
<span class="sig-prename descclassname"><span class="pre">kanapy.core.plotting.</span></span><span class="sig-name descname"><span class="pre">plot_stats_dict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sdict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">title</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_files</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/kanapy/core/plotting.html#plot_stats_dict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kanapy.core.plotting.plot_stats_dict" title="Link to this definition"></a></dt>
<dd><p>Plot statistical data on semi-axes of effective ellipsoids in RVE as histogram</p>
<section id="id419">
<h3>Parameters<a class="headerlink" href="#id419" title="Link to this heading"></a></h3>
<dl class="simple">
<dt>sdict<span class="classifier">dict</span></dt><dd><p>Dictionary containing semi-axis data and log-normal parameters.
Keys should include ‘a’, ‘b’, ‘c’, and their corresponding ‘_sig’ and ‘_scale’.</p>
</dd>
<dt>title<span class="classifier">str, optional</span></dt><dd><p>Title for the plot</p>
</dd>
<dt>save_files<span class="classifier">bool, optional</span></dt><dd><p>Whether to save the plot as PNG in the current working directory</p>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="kanapy.core.plotting.plot_voxels_3D">
<span class="sig-prename descclassname"><span class="pre">kanapy.core.plotting.</span></span><span class="sig-name descname"><span class="pre">plot_voxels_3D</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Ngr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sliced</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dual_phase</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mask</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cmap</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'prism'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">silent</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clist</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">asp_arr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">phases</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cols</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/kanapy/core/plotting.html#plot_voxels_3D"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kanapy.core.plotting.plot_voxels_3D" title="Link to this definition"></a></dt>
<dd><p>Plot voxels in microstructure, each grain with a different color. Sliced
indicates whether one eighth of the box should be removed to see internal
structure. With alpha, the transparency of the grains can be adjusted.</p>
<section id="id420">
<h3>Parameters<a class="headerlink" href="#id420" title="Link to this heading"></a></h3>
<dl class="simple">
<dt>data<span class="classifier">int array</span></dt><dd><p>Grain number or phase number associated to each voxel</p>
</dd>
<dt>Ngr<span class="classifier">int, optional</span></dt><dd><p>Number of grains. The default is 1.</p>
</dd>
<dt>sliced<span class="classifier">Boolean, optional</span></dt><dd><p>Indicate if one eighth of box is invisible. The default is False.</p>
</dd>
<dt>dual_phase<span class="classifier">Boolean, optional</span></dt><dd><p>Indicate if microstructure is dual phase. The default is False.</p>
</dd>
<dt>mask<span class="classifier">bool array, optional</span></dt><dd><p>Mask for voxels to be displayed. The default is None, in which case
all voxels will be plotted (except sliced).</p>
</dd>
<dt>cmap<span class="classifier">color map, optional</span></dt><dd><p>Color map for voxels. The default is ‘prism’.</p>
</dd>
<dt>alpha<span class="classifier">float, optional</span></dt><dd><p>Adjust transparency of voxels in alpha channel of color map.
The default is 1.0.</p>
</dd>
<dt>show<span class="classifier">bool</span></dt><dd><p>Indicate whether to show the plot or to return the axis for further use</p>
</dd>
<dt>clist<span class="classifier">(Ngr, 3)-ndarray</span></dt><dd><p>List of RGB colors for each grain</p>
</dd>
</dl>
</section>
<section id="id421">
<h3>Returns<a class="headerlink" href="#id421" title="Link to this heading"></a></h3>
<dl class="simple">
<dt>ax<span class="classifier">matplotlib.axes</span></dt><dd><p>Axes handle for 3D subplot</p>
</dd>
</dl>
</section>
</dd></dl>

</section>
<section id="module-kanapy.core.smoothingGB">
<span id="module-smoothing"></span><h2>Module smoothing<a class="headerlink" href="#module-kanapy.core.smoothingGB" title="Link to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="kanapy.core.smoothingGB.Node">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">kanapy.core.smoothingGB.</span></span><span class="sig-name descname"><span class="pre">Node</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">iden</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">px</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">py</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pz</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/kanapy/core/smoothingGB.html#Node"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kanapy.core.smoothingGB.Node" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Class representing a single node in 3D space with position, velocity, acceleration, and anchors</p>
<section id="id422">
<h3>Parameters<a class="headerlink" href="#id422" title="Link to this heading"></a></h3>
<dl class="simple">
<dt>iden<span class="classifier">int</span></dt><dd><p>Identifier to assign to the node</p>
</dd>
<dt>px<span class="classifier">float</span></dt><dd><p>Initial x-coordinate of the node</p>
</dd>
<dt>py<span class="classifier">float</span></dt><dd><p>Initial y-coordinate of the node</p>
</dd>
<dt>pz<span class="classifier">float</span></dt><dd><p>Initial z-coordinate of the node</p>
</dd>
</dl>
</section>
<section id="id423">
<h3>Attributes<a class="headerlink" href="#id423" title="Link to this heading"></a></h3>
<dl class="simple">
<dt>id<span class="classifier">int</span></dt><dd><p>Unique identifier of the node</p>
</dd>
<dt>px, py, pz<span class="classifier">float</span></dt><dd><p>Current x, y, z coordinates of the node</p>
</dd>
<dt>oripx, oripy, oripz<span class="classifier">float</span></dt><dd><p>Original x, y, z coordinates of the node</p>
</dd>
<dt>vx, vy, vz<span class="classifier">float</span></dt><dd><p>Velocity components along x, y, z</p>
</dd>
<dt>ax, ay, az<span class="classifier">float</span></dt><dd><p>Acceleration components along x, y, z</p>
</dd>
<dt>anchors<span class="classifier">list</span></dt><dd><p>List of anchors connected to this node</p>
</dd>
</dl>
</section>
<section id="id424">
<h3>Notes<a class="headerlink" href="#id424" title="Link to this heading"></a></h3>
<p>This class represents a single node in 3D space, storing both its kinematic state
(position, velocity, acceleration) and connections to anchors.</p>
<dl class="py method">
<dt class="sig sig-object py" id="kanapy.core.smoothingGB.Node.compute_acc">
<span class="sig-name descname"><span class="pre">compute_acc</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fy</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fz</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mass</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/kanapy/core/smoothingGB.html#Node.compute_acc"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kanapy.core.smoothingGB.Node.compute_acc" title="Link to this definition"></a></dt>
<dd><p>Compute the acceleration of the node given applied forces and mass</p>
<section id="id425">
<h4>Parameters<a class="headerlink" href="#id425" title="Link to this heading"></a></h4>
<dl class="simple">
<dt>fx<span class="classifier">float</span></dt><dd><p>Force component along x</p>
</dd>
<dt>fy<span class="classifier">float</span></dt><dd><p>Force component along y</p>
</dd>
<dt>fz<span class="classifier">float</span></dt><dd><p>Force component along z</p>
</dd>
<dt>mass<span class="classifier">float</span></dt><dd><p>Mass of the node</p>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="kanapy.core.smoothingGB.Node.get_Oripos">
<span class="sig-name descname"><span class="pre">get_Oripos</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/kanapy/core/smoothingGB.html#Node.get_Oripos"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kanapy.core.smoothingGB.Node.get_Oripos" title="Link to this definition"></a></dt>
<dd><p>Return the original position of the node as a NumPy array</p>
<section id="id426">
<h4>Returns<a class="headerlink" href="#id426" title="Link to this heading"></a></h4>
<dl class="simple">
<dt>oripos<span class="classifier">ndarray</span></dt><dd><p>Array containing the original x, y, z coordinates of the node</p>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="kanapy.core.smoothingGB.Node.get_pos">
<span class="sig-name descname"><span class="pre">get_pos</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/kanapy/core/smoothingGB.html#Node.get_pos"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kanapy.core.smoothingGB.Node.get_pos" title="Link to this definition"></a></dt>
<dd><p>Return the current position of the node as a NumPy array</p>
<section id="id427">
<h4>Returns<a class="headerlink" href="#id427" title="Link to this heading"></a></h4>
<dl class="simple">
<dt>pos<span class="classifier">ndarray</span></dt><dd><p>Array containing the x, y, z coordinates of the node</p>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="kanapy.core.smoothingGB.Node.get_vel">
<span class="sig-name descname"><span class="pre">get_vel</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/kanapy/core/smoothingGB.html#Node.get_vel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kanapy.core.smoothingGB.Node.get_vel" title="Link to this definition"></a></dt>
<dd><p>Return the current velocity of the node as a NumPy array</p>
<section id="id428">
<h4>Returns<a class="headerlink" href="#id428" title="Link to this heading"></a></h4>
<dl class="simple">
<dt>vel<span class="classifier">ndarray</span></dt><dd><p>Array containing the velocity components vx, vy, vz</p>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="kanapy.core.smoothingGB.Node.update_pos">
<span class="sig-name descname"><span class="pre">update_pos</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dt</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/kanapy/core/smoothingGB.html#Node.update_pos"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kanapy.core.smoothingGB.Node.update_pos" title="Link to this definition"></a></dt>
<dd><p>Update the position of the node based on its velocity and time step</p>
<section id="id429">
<h4>Parameters<a class="headerlink" href="#id429" title="Link to this heading"></a></h4>
<dl class="simple">
<dt>dt<span class="classifier">float</span></dt><dd><p>Time step for the update</p>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="kanapy.core.smoothingGB.Node.update_vel">
<span class="sig-name descname"><span class="pre">update_vel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dt</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/kanapy/core/smoothingGB.html#Node.update_vel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kanapy.core.smoothingGB.Node.update_vel" title="Link to this definition"></a></dt>
<dd><p>Update the velocity of the node based on its acceleration and time step</p>
<section id="id430">
<h4>Parameters<a class="headerlink" href="#id430" title="Link to this heading"></a></h4>
<dl class="simple">
<dt>dt<span class="classifier">float</span></dt><dd><p>Time step for the update</p>
</dd>
</dl>
</section>
</dd></dl>

</section>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="kanapy.core.smoothingGB.initalizeSystem">
<span class="sig-prename descclassname"><span class="pre">kanapy.core.smoothingGB.</span></span><span class="sig-name descname"><span class="pre">initalizeSystem</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">nodes_v</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grain_facesDict</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/kanapy/core/smoothingGB.html#initalizeSystem"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kanapy.core.smoothingGB.initalizeSystem" title="Link to this definition"></a></dt>
<dd><p>Initialize a spring-mass system from nodes and grain faces</p>
<p>Creates Node objects for all nodes, generates anchors at the center of each face,
and links nodes to their associated anchors for the spring-mass system.</p>
<section id="id431">
<h3>Parameters<a class="headerlink" href="#id431" title="Link to this heading"></a></h3>
<dl class="simple">
<dt>nodes_v<span class="classifier">ndarray</span></dt><dd><p>Array of nodal coordinates with shape (Nnodes, 3)</p>
</dd>
<dt>grain_facesDict<span class="classifier">dict</span></dt><dd><p>Dictionary mapping grain ID to a dictionary of outer faces, as returned by readGrainFaces</p>
</dd>
</dl>
</section>
<section id="id432">
<h3>Returns<a class="headerlink" href="#id432" title="Link to this heading"></a></h3>
<dl class="simple">
<dt>allNodes<span class="classifier">list of Node</span></dt><dd><p>List of Node objects with anchors assigned</p>
</dd>
<dt>anchDict<span class="classifier">dict</span></dt><dd><p>Dictionary mapping face ID to anchor position (x, y, z)</p>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="kanapy.core.smoothingGB.readGrainFaces">
<span class="sig-prename descclassname"><span class="pre">kanapy.core.smoothingGB.</span></span><span class="sig-name descname"><span class="pre">readGrainFaces</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">nodes_v</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">elmtDict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">elmtSetDict</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/kanapy/core/smoothingGB.html#readGrainFaces"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kanapy.core.smoothingGB.readGrainFaces" title="Link to this definition"></a></dt>
<dd><p>Extract outer faces of polyhedral grains from voxel connectivity</p>
<p>Constructs a dictionary of outer faces for each grain by analyzing voxel elements,
excluding faces that lie on the boundary of the RVE.</p>
<section id="id433">
<h3>Parameters<a class="headerlink" href="#id433" title="Link to this heading"></a></h3>
<dl class="simple">
<dt>nodes_v<span class="classifier">ndarray</span></dt><dd><p>Array of nodal coordinates with shape (Nnodes, 3)</p>
</dd>
<dt>elmtDict<span class="classifier">dict</span></dt><dd><p>Dictionary mapping element ID to its 8 node indices</p>
</dd>
<dt>elmtSetDict<span class="classifier">dict</span></dt><dd><p>Dictionary mapping grain ID to a list of element IDs belonging to that grain</p>
</dd>
</dl>
</section>
<section id="id434">
<h3>Returns<a class="headerlink" href="#id434" title="Link to this heading"></a></h3>
<dl class="simple">
<dt>grain_facesDict<span class="classifier">dict</span></dt><dd><p>Dictionary mapping grain ID to a dictionary of outer faces.
Each face is stored as {face_id: [node1, node2, node3, node4]}.</p>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="kanapy.core.smoothingGB.relaxSystem">
<span class="sig-prename descclassname"><span class="pre">kanapy.core.smoothingGB.</span></span><span class="sig-name descname"><span class="pre">relaxSystem</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">allNodes</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">anchDict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dt</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">N</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">k</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">c</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">RVE_xmin</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">RVE_xmax</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">RVE_ymin</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">RVE_ymax</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">RVE_zmin</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">RVE_zmax</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/kanapy/core/smoothingGB.html#relaxSystem"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kanapy.core.smoothingGB.relaxSystem" title="Link to this definition"></a></dt>
<dd><p>Relax the spring-mass system to reach equilibrium</p>
<p>Integrates the motion of nodes over N time steps with time step dt,
considering spring forces to anchors and damping. Boundary nodes at RVE surfaces
are fixed in the corresponding directions.</p>
<section id="id435">
<h3>Parameters<a class="headerlink" href="#id435" title="Link to this heading"></a></h3>
<dl class="simple">
<dt>allNodes<span class="classifier">list of Node</span></dt><dd><p>List of Node objects with positions, velocities, and anchors</p>
</dd>
<dt>anchDict<span class="classifier">dict</span></dt><dd><p>Dictionary mapping face ID to anchor position (x, y, z)</p>
</dd>
<dt>dt<span class="classifier">float</span></dt><dd><p>Time step for integration</p>
</dd>
<dt>N<span class="classifier">int</span></dt><dd><p>Number of integration steps</p>
</dd>
<dt>k<span class="classifier">float</span></dt><dd><p>Spring stiffness</p>
</dd>
<dt>c<span class="classifier">float</span></dt><dd><p>Damping coefficient</p>
</dd>
<dt>RVE_xmin, RVE_xmax<span class="classifier">float</span></dt><dd><p>Minimum and maximum x-coordinates of RVE boundary</p>
</dd>
<dt>RVE_ymin, RVE_ymax<span class="classifier">float</span></dt><dd><p>Minimum and maximum y-coordinates of RVE boundary</p>
</dd>
<dt>RVE_zmin, RVE_zmax<span class="classifier">float</span></dt><dd><p>Minimum and maximum z-coordinates of RVE boundary</p>
</dd>
</dl>
</section>
<section id="id436">
<h3>Returns<a class="headerlink" href="#id436" title="Link to this heading"></a></h3>
<dl class="simple">
<dt>allNodes<span class="classifier">list of Node</span></dt><dd><p>Updated list of Node objects after relaxation</p>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="kanapy.core.smoothingGB.smoothingRoutine">
<span class="sig-prename descclassname"><span class="pre">kanapy.core.smoothingGB.</span></span><span class="sig-name descname"><span class="pre">smoothingRoutine</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">nodes_v</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">elmtDict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">elmtSetDict</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/kanapy/core/smoothingGB.html#smoothingRoutine"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kanapy.core.smoothingGB.smoothingRoutine" title="Link to this definition"></a></dt>
<dd><p>Smooth a voxel-based microstructure by relaxing a spring-mass-anchor system</p>
<p>Constructs outer faces of grains, initializes nodes with anchors at face centers,
and iteratively relaxes the system to reduce irregularities in node positions.</p>
<section id="id437">
<h3>Parameters<a class="headerlink" href="#id437" title="Link to this heading"></a></h3>
<dl class="simple">
<dt>nodes_v<span class="classifier">ndarray, shape (N_nodes, 3)</span></dt><dd><p>Coordinates of all nodes in the voxel mesh</p>
</dd>
<dt>elmtDict<span class="classifier">dict</span></dt><dd><p>Dictionary mapping element ID to its node indices</p>
</dd>
<dt>elmtSetDict<span class="classifier">dict</span></dt><dd><p>Dictionary mapping grain ID to the set of element IDs it contains</p>
</dd>
</dl>
</section>
<section id="id438">
<h3>Returns<a class="headerlink" href="#id438" title="Link to this heading"></a></h3>
<dl class="simple">
<dt>nodes_s<span class="classifier">ndarray, shape (N_nodes, 3)</span></dt><dd><p>Smoothed coordinates of all nodes</p>
</dd>
<dt>grain_facesDict<span class="classifier">dict</span></dt><dd><p>Dictionary mapping grain ID to its outer faces and corresponding node connectivity</p>
</dd>
</dl>
</section>
</dd></dl>

</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="method.html" class="btn btn-neutral float-left" title="Modeling" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="contributing.html" class="btn btn-neutral float-right" title="Contributing" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright This work is published under a CC BY-SA 4.0 license.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>